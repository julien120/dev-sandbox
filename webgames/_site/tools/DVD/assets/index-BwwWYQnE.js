var R2=Object.defineProperty;var O2=(e,t,s)=>t in e?R2(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s;var p=(e,t,s)=>O2(e,typeof t!="symbol"?t+"":t,s);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function s(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(i){if(i.ep)return;i.ep=!0;const r=s(i);fetch(i.href,r)}})();class B2{constructor(){p(this,"sounds",new Map);p(this,"muted",!1)}load(t,s){if(this.sounds.has(t))return;const n=new Audio(s);n.preload="auto",this.sounds.set(t,n)}play(t,s={}){const n=this.sounds.get(t);if(!n||this.muted)return;const i=n.cloneNode(!0);i.loop=s.loop??!1,i.volume=s.volume??1,i.play()}setMuted(t){this.muted=t}isMuted(){return this.muted}}const N2=(e,t)=>{const s=e.position.x-t.position.x,n=e.position.y-t.position.y,i=s*s+n*n,r=e.radius+t.radius;return i<=r*r},U2=(e,t)=>{const s=Math.max(e.position.x,Math.min(t.position.x,e.position.x+e.size.x)),n=Math.max(e.position.y,Math.min(t.position.y,e.position.y+e.size.y)),i=t.position.x-s,r=t.position.y-n;return i*i+r*r<=t.radius*t.radius},bn=1e3/60,G2=5;class V2{constructor(){p(this,"lastTick",performance.now());p(this,"accumulated",0);p(this,"running",!1);p(this,"subscribers",[]);p(this,"rafId",0);p(this,"loop",()=>{if(!this.running)return;const t=performance.now(),s=t-this.lastTick;this.lastTick=t,this.accumulated+=s;let n=0;for(;this.accumulated>=bn&&n<G2;)this.accumulated-=bn,this.subscribers.forEach(i=>i(bn/1e3)),n+=1;this.rafId=requestAnimationFrame(this.loop)})}start(){this.running||(this.running=!0,this.lastTick=performance.now(),this.loop())}stop(){this.running=!1,cancelAnimationFrame(this.rafId)}subscribe(t){return this.subscribers.push(t),()=>{const s=this.subscribers.indexOf(t);s>=0&&this.subscribers.splice(s,1)}}}class j2{constructor(t=window){p(this,"pressedKeys",new Set);p(this,"pointerPosition",{x:0,y:0});p(this,"listeners",[]);p(this,"keyDownListener",t=>this.handleKeyDown(t));p(this,"keyUpListener",t=>this.handleKeyUp(t));p(this,"pointerListener",t=>this.handlePointer(t));p(this,"handleKeyDown",t=>{this.pressedKeys.add(t.key.toLowerCase()),this.listeners.forEach(s=>s(t))});p(this,"handleKeyUp",t=>{this.pressedKeys.delete(t.key.toLowerCase()),this.listeners.forEach(s=>s(t))});p(this,"handlePointer",t=>{this.pointerPosition={x:t.clientX,y:t.clientY},this.listeners.forEach(s=>s(t))});this.target=t}attach(){this.addTargetListeners(this.target)}detach(){this.removeTargetListeners(this.target),this.pressedKeys.clear(),this.listeners=[]}addTargetListeners(t){if(t instanceof Window){t.addEventListener("keydown",this.keyDownListener,{passive:!0}),t.addEventListener("keyup",this.keyUpListener,{passive:!0}),t.addEventListener("pointerdown",this.pointerListener,{passive:!0}),t.addEventListener("pointerup",this.pointerListener,{passive:!0}),t.addEventListener("pointermove",this.pointerListener,{passive:!0});return}t.addEventListener("keydown",this.keyDownListener,{passive:!0}),t.addEventListener("keyup",this.keyUpListener,{passive:!0}),t.addEventListener("pointerdown",this.pointerListener,{passive:!0}),t.addEventListener("pointerup",this.pointerListener,{passive:!0}),t.addEventListener("pointermove",this.pointerListener,{passive:!0})}removeTargetListeners(t){if(t instanceof Window){t.removeEventListener("keydown",this.keyDownListener),t.removeEventListener("keyup",this.keyUpListener),t.removeEventListener("pointerdown",this.pointerListener),t.removeEventListener("pointerup",this.pointerListener),t.removeEventListener("pointermove",this.pointerListener);return}t.removeEventListener("keydown",this.keyDownListener),t.removeEventListener("keyup",this.keyUpListener),t.removeEventListener("pointerdown",this.pointerListener),t.removeEventListener("pointerup",this.pointerListener),t.removeEventListener("pointermove",this.pointerListener)}isKeyPressed(t){return this.pressedKeys.has(t.toLowerCase())}getPointerPosition(){return{...this.pointerPosition}}onInput(t){return this.listeners.push(t),()=>{this.listeners=this.listeners.filter(s=>s!==t)}}}class H2{constructor(t){p(this,"context");p(this,"canvas");const s=t.getContext("2d");if(!s)throw new Error("Renderer requires 2D canvas context");this.canvas=t,this.context=s,this.context.imageSmoothingEnabled=!0}clear(t="#000000"){const s=this.context;s.save(),s.fillStyle=t,s.fillRect(0,0,this.canvas.width,this.canvas.height),s.restore()}drawSprite(t,s,n){this.context.drawImage(t,s.x,s.y,n.x,n.y)}drawRect(t,s,n){const i=this.context;i.save(),i.fillStyle=n,i.fillRect(t.x,t.y,s.x,s.y),i.restore()}drawText(t,s,n={}){const i=this.context;i.save(),i.fillStyle=n.color??"#ffffff",i.font=n.font??"16px sans-serif",i.textBaseline="top",i.fillText(t,s.x,s.y),i.restore()}resize(t){this.canvas.width=t.x,this.canvas.height=t.y}}class W2{constructor(t,s={}){p(this,"audio",new B2);p(this,"input");p(this,"renderer");p(this,"ticker",new V2);p(this,"currentScene",null);p(this,"elapsedTime",0);p(this,"options");p(this,"update",t=>{var n,i;const s=this.createContext(t);this.options.background?this.renderer.clear(this.options.background):this.renderer.clear(),(n=this.currentScene)==null||n.update(t,s),(i=this.currentScene)==null||i.render(s),this.elapsedTime+=t});this.options=s,this.renderer=new H2(t),this.input=new j2(window),this.input.attach(),this.ticker.subscribe(this.update)}setScene(t){var s,n;(s=this.currentScene)!=null&&s.onExit&&this.currentScene.onExit(this.createContext()),this.currentScene=t,(n=this.currentScene)!=null&&n.onEnter&&this.currentScene.onEnter(this.createContext())}start(){this.elapsedTime=0,this.ticker.start()}stop(){this.ticker.stop()}dispose(){this.stop(),this.input.detach()}createContext(t=0){return{renderer:this.renderer,input:this.input,elapsedTime:this.elapsedTime+t}}}const ue=(e=0,t=0)=>({x:e,y:t}),de=(e,t,s)=>Math.max(t,Math.min(s,e)),le=(e,t,s)=>e+(t-e)*de(s,0,1);class z2{}/**
 * @license
 * Copyright 2010-2024 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const Io="168",K2="",Ze="srgb",ai="srgb-linear",$2="display-p3",Do="display-p3-linear",Un="linear",ur="srgb",dr="rec709",fr="p3",q=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let pr=1234567;const Ro=Math.PI/180,Oo=180/Math.PI;function X2(){const e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,s=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(q[e&255]+q[e>>8&255]+q[e>>16&255]+q[e>>24&255]+"-"+q[t&255]+q[t>>8&255]+"-"+q[t>>16&15|64]+q[t>>24&255]+"-"+q[s&63|128]+q[s>>8&255]+"-"+q[s>>16&255]+q[s>>24&255]+q[n&255]+q[n>>8&255]+q[n>>16&255]+q[n>>24&255]).toLowerCase()}function At(e,t,s){return Math.max(t,Math.min(s,e))}function hi(e,t){return(e%t+t)%t}function Y2(e,t,s,n,i){return n+(e-t)*(i-n)/(s-t)}function q2(e,t,s){return e!==t?(s-e)/(t-e):0}function Qt(e,t,s){return(1-s)*e+s*t}function J2(e,t,s,n){return Qt(e,t,1-Math.exp(-s*n))}function Z2(e,t=1){return t-Math.abs(hi(e,t*2)-t)}function Q2(e,t,s){return e<=t?0:e>=s?1:(e=(e-t)/(s-t),e*e*(3-2*e))}function e1(e,t,s){return e<=t?0:e>=s?1:(e=(e-t)/(s-t),e*e*e*(e*(e*6-15)+10))}function t1(e,t){return e+Math.floor(Math.random()*(t-e+1))}function s1(e,t){return e+Math.random()*(t-e)}function n1(e){return e*(.5-Math.random())}function i1(e){e!==void 0&&(pr=e);let t=pr+=1831565813;return t=Math.imul(t^t>>>15,t|1),t^=t+Math.imul(t^t>>>7,t|61),((t^t>>>14)>>>0)/4294967296}function r1(e){return e*Ro}function o1(e){return e*Oo}function a1(e){return(e&e-1)===0&&e!==0}function h1(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))}function c1(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}function l1(e,t,s,n,i){const r=Math.cos,o=Math.sin,a=r(s/2),h=o(s/2),c=r((t+n)/2),l=o((t+n)/2),u=r((t-n)/2),d=o((t-n)/2),y=r((n-t)/2),_=o((n-t)/2);switch(i){case"XYX":e.set(a*l,h*u,h*d,a*c);break;case"YZY":e.set(h*d,a*l,h*u,a*c);break;case"ZXZ":e.set(h*u,h*d,a*l,a*c);break;case"XZX":e.set(a*l,h*_,h*y,a*c);break;case"YXY":e.set(h*y,a*l,h*_,a*c);break;case"ZYZ":e.set(h*_,h*y,a*l,a*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}}function u1(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return e/4294967295;case Uint16Array:return e/65535;case Uint8Array:return e/255;case Int32Array:return Math.max(e/2147483647,-1);case Int16Array:return Math.max(e/32767,-1);case Int8Array:return Math.max(e/127,-1);default:throw new Error("Invalid component type.")}}function d1(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return Math.round(e*4294967295);case Uint16Array:return Math.round(e*65535);case Uint8Array:return Math.round(e*255);case Int32Array:return Math.round(e*2147483647);case Int16Array:return Math.round(e*32767);case Int8Array:return Math.round(e*127);default:throw new Error("Invalid component type.")}}const fs={DEG2RAD:Ro,RAD2DEG:Oo,generateUUID:X2,clamp:At,euclideanModulo:hi,mapLinear:Y2,inverseLerp:q2,lerp:Qt,damp:J2,pingpong:Z2,smoothstep:Q2,smootherstep:e1,randInt:t1,randFloat:s1,randFloatSpread:n1,seededRandom:i1,degToRad:r1,radToDeg:o1,isPowerOfTwo:a1,ceilPowerOfTwo:h1,floorPowerOfTwo:c1,setQuaternionFromProperEuler:l1,normalize:d1,denormalize:u1};class cs{constructor(t,s,n,i,r,o,a,h,c){cs.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],t!==void 0&&this.set(t,s,n,i,r,o,a,h,c)}set(t,s,n,i,r,o,a,h,c){const l=this.elements;return l[0]=t,l[1]=i,l[2]=a,l[3]=s,l[4]=r,l[5]=h,l[6]=n,l[7]=o,l[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(t){const s=this.elements,n=t.elements;return s[0]=n[0],s[1]=n[1],s[2]=n[2],s[3]=n[3],s[4]=n[4],s[5]=n[5],s[6]=n[6],s[7]=n[7],s[8]=n[8],this}extractBasis(t,s,n){return t.setFromMatrix3Column(this,0),s.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(t){const s=t.elements;return this.set(s[0],s[4],s[8],s[1],s[5],s[9],s[2],s[6],s[10]),this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,s){const n=t.elements,i=s.elements,r=this.elements,o=n[0],a=n[3],h=n[6],c=n[1],l=n[4],u=n[7],d=n[2],y=n[5],_=n[8],G=i[0],Ce=i[3],Pe=i[6],wt=i[1],fn=i[4],pn=i[7],mn=i[2],gn=i[5],yn=i[8];return r[0]=o*G+a*wt+h*mn,r[3]=o*Ce+a*fn+h*gn,r[6]=o*Pe+a*pn+h*yn,r[1]=c*G+l*wt+u*mn,r[4]=c*Ce+l*fn+u*gn,r[7]=c*Pe+l*pn+u*yn,r[2]=d*G+y*wt+_*mn,r[5]=d*Ce+y*fn+_*gn,r[8]=d*Pe+y*pn+_*yn,this}multiplyScalar(t){const s=this.elements;return s[0]*=t,s[3]*=t,s[6]*=t,s[1]*=t,s[4]*=t,s[7]*=t,s[2]*=t,s[5]*=t,s[8]*=t,this}determinant(){const t=this.elements,s=t[0],n=t[1],i=t[2],r=t[3],o=t[4],a=t[5],h=t[6],c=t[7],l=t[8];return s*o*l-s*a*c-n*r*l+n*a*h+i*r*c-i*o*h}invert(){const t=this.elements,s=t[0],n=t[1],i=t[2],r=t[3],o=t[4],a=t[5],h=t[6],c=t[7],l=t[8],u=l*o-a*c,d=a*h-l*r,y=c*r-o*h,_=s*u+n*d+i*y;if(_===0)return this.set(0,0,0,0,0,0,0,0,0);const G=1/_;return t[0]=u*G,t[1]=(i*c-l*n)*G,t[2]=(a*n-i*o)*G,t[3]=d*G,t[4]=(l*s-i*h)*G,t[5]=(i*r-a*s)*G,t[6]=y*G,t[7]=(n*h-c*s)*G,t[8]=(o*s-n*r)*G,this}transpose(){let t;const s=this.elements;return t=s[1],s[1]=s[3],s[3]=t,t=s[2],s[2]=s[6],s[6]=t,t=s[5],s[5]=s[7],s[7]=t,this}getNormalMatrix(t){return this.setFromMatrix4(t).invert().transpose()}transposeIntoArray(t){const s=this.elements;return t[0]=s[0],t[1]=s[3],t[2]=s[6],t[3]=s[1],t[4]=s[4],t[5]=s[7],t[6]=s[2],t[7]=s[5],t[8]=s[8],this}setUvTransform(t,s,n,i,r,o,a){const h=Math.cos(r),c=Math.sin(r);return this.set(n*h,n*c,-n*(h*o+c*a)+o+t,-i*c,i*h,-i*(-c*o+h*a)+a+s,0,0,1),this}scale(t,s){return this.premultiply(wn.makeScale(t,s)),this}rotate(t){return this.premultiply(wn.makeRotation(-t)),this}translate(t,s){return this.premultiply(wn.makeTranslation(t,s)),this}makeTranslation(t,s){return t.isVector2?this.set(1,0,t.x,0,1,t.y,0,0,1):this.set(1,0,t,0,1,s,0,0,1),this}makeRotation(t){const s=Math.cos(t),n=Math.sin(t);return this.set(s,-n,0,n,s,0,0,0,1),this}makeScale(t,s){return this.set(t,0,0,0,s,0,0,0,1),this}equals(t){const s=this.elements,n=t.elements;for(let i=0;i<9;i++)if(s[i]!==n[i])return!1;return!0}fromArray(t,s=0){for(let n=0;n<9;n++)this.elements[n]=t[n+s];return this}toArray(t=[],s=0){const n=this.elements;return t[s]=n[0],t[s+1]=n[1],t[s+2]=n[2],t[s+3]=n[3],t[s+4]=n[4],t[s+5]=n[5],t[s+6]=n[6],t[s+7]=n[7],t[s+8]=n[8],t}clone(){return new this.constructor().fromArray(this.elements)}}const wn=new cs,mr=new cs().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),gr=new cs().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),Xt={[ai]:{transfer:Un,primaries:dr,luminanceCoefficients:[.2126,.7152,.0722],toReference:e=>e,fromReference:e=>e},[Ze]:{transfer:ur,primaries:dr,luminanceCoefficients:[.2126,.7152,.0722],toReference:e=>e.convertSRGBToLinear(),fromReference:e=>e.convertLinearToSRGB()},[Do]:{transfer:Un,primaries:fr,luminanceCoefficients:[.2289,.6917,.0793],toReference:e=>e.applyMatrix3(gr),fromReference:e=>e.applyMatrix3(mr)},[$2]:{transfer:ur,primaries:fr,luminanceCoefficients:[.2289,.6917,.0793],toReference:e=>e.convertSRGBToLinear().applyMatrix3(gr),fromReference:e=>e.applyMatrix3(mr).convertLinearToSRGB()}},f1=new Set([ai,Do]),Te={enabled:!0,_workingColorSpace:ai,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(e){if(!f1.has(e))throw new Error(`Unsupported working color space, "${e}".`);this._workingColorSpace=e},convert:function(e,t,s){if(this.enabled===!1||t===s||!t||!s)return e;const n=Xt[t].toReference,i=Xt[s].fromReference;return i(n(e))},fromWorkingColorSpace:function(e,t){return this.convert(e,this._workingColorSpace,t)},toWorkingColorSpace:function(e,t){return this.convert(e,t,this._workingColorSpace)},getPrimaries:function(e){return Xt[e].primaries},getTransfer:function(e){return e===K2?Un:Xt[e].transfer},getLuminanceCoefficients:function(e,t=this._workingColorSpace){return e.fromArray(Xt[t].luminanceCoefficients)}};function vn(e){return e<.04045?e*.0773993808:Math.pow(e*.9478672986+.0521327014,2.4)}function _n(e){return e<.0031308?e*12.92:1.055*Math.pow(e,.41666)-.055}const Bo={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Ye={h:0,s:0,l:0},ps={h:0,s:0,l:0};function En(e,t,s){return s<0&&(s+=1),s>1&&(s-=1),s<1/6?e+(t-e)*6*s:s<1/2?t:s<2/3?e+(t-e)*6*(2/3-s):e}class xs{constructor(t,s,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(t,s,n)}set(t,s,n){if(s===void 0&&n===void 0){const i=t;i&&i.isColor?this.copy(i):typeof i=="number"?this.setHex(i):typeof i=="string"&&this.setStyle(i)}else this.setRGB(t,s,n);return this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t,s=Ze){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(t&255)/255,Te.toWorkingColorSpace(this,s),this}setRGB(t,s,n,i=Te.workingColorSpace){return this.r=t,this.g=s,this.b=n,Te.toWorkingColorSpace(this,i),this}setHSL(t,s,n,i=Te.workingColorSpace){if(t=hi(t,1),s=At(s,0,1),n=At(n,0,1),s===0)this.r=this.g=this.b=n;else{const r=n<=.5?n*(1+s):n+s-n*s,o=2*n-r;this.r=En(o,r,t+1/3),this.g=En(o,r,t),this.b=En(o,r,t-1/3)}return Te.toWorkingColorSpace(this,i),this}setStyle(t,s=Ze){function n(r){r!==void 0&&parseFloat(r)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let i;if(i=/^(\w+)\(([^\)]*)\)/.exec(t)){let r;const o=i[1],a=i[2];switch(o){case"rgb":case"rgba":if(r=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return n(r[4]),this.setRGB(Math.min(255,parseInt(r[1],10))/255,Math.min(255,parseInt(r[2],10))/255,Math.min(255,parseInt(r[3],10))/255,s);if(r=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return n(r[4]),this.setRGB(Math.min(100,parseInt(r[1],10))/100,Math.min(100,parseInt(r[2],10))/100,Math.min(100,parseInt(r[3],10))/100,s);break;case"hsl":case"hsla":if(r=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return n(r[4]),this.setHSL(parseFloat(r[1])/360,parseFloat(r[2])/100,parseFloat(r[3])/100,s);break;default:console.warn("THREE.Color: Unknown color model "+t)}}else if(i=/^\#([A-Fa-f\d]+)$/.exec(t)){const r=i[1],o=r.length;if(o===3)return this.setRGB(parseInt(r.charAt(0),16)/15,parseInt(r.charAt(1),16)/15,parseInt(r.charAt(2),16)/15,s);if(o===6)return this.setHex(parseInt(r,16),s);console.warn("THREE.Color: Invalid hex color "+t)}else if(t&&t.length>0)return this.setColorName(t,s);return this}setColorName(t,s=Ze){const n=Bo[t.toLowerCase()];return n!==void 0?this.setHex(n,s):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=vn(t.r),this.g=vn(t.g),this.b=vn(t.b),this}copyLinearToSRGB(t){return this.r=_n(t.r),this.g=_n(t.g),this.b=_n(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(t=Ze){return Te.fromWorkingColorSpace(J.copy(this),t),Math.round(At(J.r*255,0,255))*65536+Math.round(At(J.g*255,0,255))*256+Math.round(At(J.b*255,0,255))}getHexString(t=Ze){return("000000"+this.getHex(t).toString(16)).slice(-6)}getHSL(t,s=Te.workingColorSpace){Te.fromWorkingColorSpace(J.copy(this),s);const n=J.r,i=J.g,r=J.b,o=Math.max(n,i,r),a=Math.min(n,i,r);let h,c;const l=(a+o)/2;if(a===o)h=0,c=0;else{const u=o-a;switch(c=l<=.5?u/(o+a):u/(2-o-a),o){case n:h=(i-r)/u+(i<r?6:0);break;case i:h=(r-n)/u+2;break;case r:h=(n-i)/u+4;break}h/=6}return t.h=h,t.s=c,t.l=l,t}getRGB(t,s=Te.workingColorSpace){return Te.fromWorkingColorSpace(J.copy(this),s),t.r=J.r,t.g=J.g,t.b=J.b,t}getStyle(t=Ze){Te.fromWorkingColorSpace(J.copy(this),t);const s=J.r,n=J.g,i=J.b;return t!==Ze?`color(${t} ${s.toFixed(3)} ${n.toFixed(3)} ${i.toFixed(3)})`:`rgb(${Math.round(s*255)},${Math.round(n*255)},${Math.round(i*255)})`}offsetHSL(t,s,n){return this.getHSL(Ye),this.setHSL(Ye.h+t,Ye.s+s,Ye.l+n)}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,s){return this.r=t.r+s.r,this.g=t.g+s.g,this.b=t.b+s.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,s){return this.r+=(t.r-this.r)*s,this.g+=(t.g-this.g)*s,this.b+=(t.b-this.b)*s,this}lerpColors(t,s,n){return this.r=t.r+(s.r-t.r)*n,this.g=t.g+(s.g-t.g)*n,this.b=t.b+(s.b-t.b)*n,this}lerpHSL(t,s){this.getHSL(Ye),t.getHSL(ps);const n=Qt(Ye.h,ps.h,s),i=Qt(Ye.s,ps.s,s),r=Qt(Ye.l,ps.l,s);return this.setHSL(n,i,r),this}setFromVector3(t){return this.r=t.x,this.g=t.y,this.b=t.z,this}applyMatrix3(t){const s=this.r,n=this.g,i=this.b,r=t.elements;return this.r=r[0]*s+r[3]*n+r[6]*i,this.g=r[1]*s+r[4]*n+r[7]*i,this.b=r[2]*s+r[5]*n+r[8]*i,this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,s=0){return this.r=t[s],this.g=t[s+1],this.b=t[s+2],this}toArray(t=[],s=0){return t[s]=this.r,t[s+1]=this.g,t[s+2]=this.b,t}fromBufferAttribute(t,s){return this.r=t.getX(s),this.g=t.getY(s),this.b=t.getZ(s),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const J=new xs;xs.NAMES=Bo;typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:Io}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=Io);var xt=typeof self<"u"?self:{};function lt(){throw Error("Invalid UTF8")}function yr(e,t){return t=String.fromCharCode.apply(null,t),e==null?t:e+t}let ms,An;const p1=typeof TextDecoder<"u";let m1;const g1=typeof TextEncoder<"u";function No(e){if(g1)e=(m1||(m1=new TextEncoder)).encode(e);else{let s=0;const n=new Uint8Array(3*e.length);for(let i=0;i<e.length;i++){var t=e.charCodeAt(i);if(t<128)n[s++]=t;else{if(t<2048)n[s++]=t>>6|192;else{if(t>=55296&&t<=57343){if(t<=56319&&i<e.length){const r=e.charCodeAt(++i);if(r>=56320&&r<=57343){t=1024*(t-55296)+r-56320+65536,n[s++]=t>>18|240,n[s++]=t>>12&63|128,n[s++]=t>>6&63|128,n[s++]=63&t|128;continue}i--}t=65533}n[s++]=t>>12|224,n[s++]=t>>6&63|128}n[s++]=63&t|128}}e=s===n.length?n:n.subarray(0,s)}return e}var ci,Ls;e:{for(var br=["CLOSURE_FLAGS"],Sn=xt,kn=0;kn<br.length;kn++)if((Sn=Sn[br[kn]])==null){Ls=null;break e}Ls=Sn}var ns,wr=Ls&&Ls[610401301];ci=wr!=null&&wr;const vr=xt.navigator;function Gn(e){return!!ci&&!!ns&&ns.brands.some(({brand:t})=>t&&t.indexOf(e)!=-1)}function _e(e){var t;return(t=xt.navigator)&&(t=t.userAgent)||(t=""),t.indexOf(e)!=-1}function Qe(){return!!ci&&!!ns&&ns.brands.length>0}function Tn(){return Qe()?Gn("Chromium"):(_e("Chrome")||_e("CriOS"))&&!(!Qe()&&_e("Edge"))||_e("Silk")}function Os(e){return Os[" "](e),e}ns=vr&&vr.userAgentData||null,Os[" "]=function(){};var y1=!Qe()&&(_e("Trident")||_e("MSIE"));!_e("Android")||Tn(),Tn(),_e("Safari")&&(Tn()||!Qe()&&_e("Coast")||!Qe()&&_e("Opera")||!Qe()&&_e("Edge")||(Qe()?Gn("Microsoft Edge"):_e("Edg/"))||Qe()&&Gn("Opera"));var Uo={},Jt=null;function b1(e){const t=e.length;let s=3*t/4;s%3?s=Math.floor(s):"=.".indexOf(e[t-1])!=-1&&(s="=.".indexOf(e[t-2])!=-1?s-2:s-1);const n=new Uint8Array(s);let i=0;return function(r,o){function a(c){for(;h<r.length;){const l=r.charAt(h++),u=Jt[l];if(u!=null)return u;if(!/^[\s\xa0]*$/.test(l))throw Error("Unknown base64 encoding at char: "+l)}return c}Go();let h=0;for(;;){const c=a(-1),l=a(0),u=a(64),d=a(64);if(d===64&&c===-1)break;o(c<<2|l>>4),u!=64&&(o(l<<4&240|u>>2),d!=64&&o(u<<6&192|d))}}(e,function(r){n[i++]=r}),i!==s?n.subarray(0,i):n}function Go(){if(!Jt){Jt={};var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),t=["+/=","+/","-_=","-_.","-_"];for(let s=0;s<5;s++){const n=e.concat(t[s].split(""));Uo[s]=n;for(let i=0;i<n.length;i++){const r=n[i];Jt[r]===void 0&&(Jt[r]=i)}}}}var Vo=typeof Uint8Array<"u",jo=!y1&&typeof btoa=="function";function _r(e){if(!jo){var t;t===void 0&&(t=0),Go(),t=Uo[t];var s=Array(Math.floor(e.length/3)),n=t[64]||"";let h=0,c=0;for(;h<e.length-2;h+=3){var i=e[h],r=e[h+1],o=e[h+2],a=t[i>>2];i=t[(3&i)<<4|r>>4],r=t[(15&r)<<2|o>>6],o=t[63&o],s[c++]=a+i+r+o}switch(a=0,o=n,e.length-h){case 2:o=t[(15&(a=e[h+1]))<<2]||n;case 1:e=e[h],s[c]=t[e>>2]+t[(3&e)<<4|a>>4]+o+n}return s.join("")}for(t="",s=0,n=e.length-10240;s<n;)t+=String.fromCharCode.apply(null,e.subarray(s,s+=10240));return t+=String.fromCharCode.apply(null,s?e.subarray(s):e),btoa(t)}const Er=/[-_.]/g,w1={"-":"+",_:"/",".":"="};function v1(e){return w1[e]||""}function Ho(e){if(!jo)return b1(e);Er.test(e)&&(e=e.replace(Er,v1)),e=atob(e);const t=new Uint8Array(e.length);for(let s=0;s<e.length;s++)t[s]=e.charCodeAt(s);return t}function mt(e){return Vo&&e!=null&&e instanceof Uint8Array}var Lt={};function gt(){return _1||(_1=new He(null,Lt))}function li(e){Wo(Lt);var t=e.g;return(t=t==null||mt(t)?t:typeof t=="string"?Ho(t):null)==null?t:e.g=t}var He=class{h(){return new Uint8Array(li(this)||0)}constructor(e,t){if(Wo(t),this.g=e,e!=null&&e.length===0)throw Error("ByteString should be constructed with non-empty values")}};let _1,E1;function Wo(e){if(e!==Lt)throw Error("illegal external caller")}function zo(e,t){e.__closure__error__context__984382||(e.__closure__error__context__984382={}),e.__closure__error__context__984382.severity=t}function Vn(e){return zo(e=Error(e),"warning"),e}function ui(e){if(e!=null){var t=E1??(E1={}),s=t[e]||0;s>=5||(t[e]=s+1,zo(e=Error(),"incident"),function(n){xt.setTimeout(()=>{throw n},0)}(e))}}var Bs=typeof Symbol=="function"&&typeof Symbol()=="symbol";function Ut(e,t,s=!1){return typeof Symbol=="function"&&typeof Symbol()=="symbol"?s&&Symbol.for&&e?Symbol.for(e):e!=null?Symbol(e):Symbol():t}var A1=Ut("jas",void 0,!0),Ar=Ut(void 0,"0di"),Yt=Ut(void 0,"1oa"),Mt=Ut(void 0,Symbol()),S1=Ut(void 0,"0actk"),Ko=Ut(void 0,"8utk");const w=Bs?A1:"Ea",$o={Ea:{value:0,configurable:!0,writable:!0,enumerable:!1}},Xo=Object.defineProperties;function Ns(e,t){Bs||w in e||Xo(e,$o),e[w]|=t}function H(e,t){Bs||w in e||Xo(e,$o),e[w]=t}function Gt(e){return Ns(e,34),e}function k1(e,t){H(t,-15615&(0|e))}function jn(e,t){H(t,-15581&(34|e))}function Us(){return typeof BigInt=="function"}function ie(e){return Array.prototype.slice.call(e)}var di,ls={};function Gs(e){return e!==null&&typeof e=="object"&&!Array.isArray(e)&&e.constructor===Object}function fi(e,t){if(e!=null){if(typeof e=="string")e=e?new He(e,Lt):gt();else if(e.constructor!==He)if(mt(e))e=e.length?new He(new Uint8Array(e),Lt):gt();else{if(!t)throw Error();e=void 0}}return e}const Sr=[];function at(e){if(2&e)throw Error()}H(Sr,55),di=Object.freeze(Sr);class kr{constructor(t,s,n){this.g=t,this.h=s,this.l=n}next(){const t=this.g.next();return t.done||(t.value=this.h.call(this.l,t.value)),t}[Symbol.iterator](){return this}}function pi(e){return Mt?e[Mt]:void 0}var T1=Object.freeze({});function Vs(e){return e.Na=!0,e}var F1=Vs(e=>typeof e=="number"),Tr=Vs(e=>typeof e=="string"),x1=Vs(e=>typeof e=="boolean"),js=typeof xt.BigInt=="function"&&typeof xt.BigInt(0)=="bigint";function tt(e){var t=e;if(Tr(t)){if(!/^\s*(?:-?[1-9]\d*|0)?\s*$/.test(t))throw Error(String(t))}else if(F1(t)&&!Number.isSafeInteger(t))throw Error(String(t));return js?BigInt(e):e=x1(e)?e?"1":"0":Tr(e)?e.trim()||"0":String(e)}var Hn=Vs(e=>js?e>=M1&&e<=P1:e[0]==="-"?Fr(e,L1):Fr(e,C1));const L1=Number.MIN_SAFE_INTEGER.toString(),M1=js?BigInt(Number.MIN_SAFE_INTEGER):void 0,C1=Number.MAX_SAFE_INTEGER.toString(),P1=js?BigInt(Number.MAX_SAFE_INTEGER):void 0;function Fr(e,t){if(e.length>t.length)return!1;if(e.length<t.length||e===t)return!0;for(let s=0;s<e.length;s++){const n=e[s],i=t[s];if(n>i)return!1;if(n<i)return!0}}const I1=typeof Uint8Array.prototype.slice=="function";let Yo,x=0,N=0;function xr(e){const t=e>>>0;x=t,N=(e-t)/4294967296>>>0}function yt(e){if(e<0){xr(-e);const[t,s]=bi(x,N);x=t>>>0,N=s>>>0}else xr(e)}function mi(e){const t=Yo||(Yo=new DataView(new ArrayBuffer(8)));t.setFloat32(0,+e,!0),N=0,x=t.getUint32(0,!0)}function gi(e,t){const s=4294967296*t+(e>>>0);return Number.isSafeInteger(s)?s:is(e,t)}function yi(e,t){const s=2147483648&t;return s&&(t=~t>>>0,(e=1+~e>>>0)==0&&(t=t+1>>>0)),typeof(e=gi(e,t))=="number"?s?-e:e:s?"-"+e:e}function is(e,t){if(e>>>=0,(t>>>=0)<=2097151)var s=""+(4294967296*t+e);else Us()?s=""+(BigInt(t)<<BigInt(32)|BigInt(e)):(e=(16777215&e)+6777216*(s=16777215&(e>>>24|t<<8))+6710656*(t=t>>16&65535),s+=8147497*t,t*=2,e>=1e7&&(s+=e/1e7>>>0,e%=1e7),s>=1e7&&(t+=s/1e7>>>0,s%=1e7),s=t+Lr(s)+Lr(e));return s}function Lr(e){return e=String(e),"0000000".slice(e.length)+e}function qo(){var e=x,t=N;if(2147483648&t)if(Us())e=""+(BigInt(0|t)<<BigInt(32)|BigInt(e>>>0));else{const[s,n]=bi(e,t);e="-"+is(s,n)}else e=is(e,t);return e}function Hs(e){if(e.length<16)yt(Number(e));else if(Us())e=BigInt(e),x=Number(e&BigInt(4294967295))>>>0,N=Number(e>>BigInt(32)&BigInt(4294967295));else{const t=+(e[0]==="-");N=x=0;const s=e.length;for(let n=t,i=(s-t)%6+t;i<=s;n=i,i+=6){const r=Number(e.slice(n,i));N*=1e6,x=1e6*x+r,x>=4294967296&&(N+=Math.trunc(x/4294967296),N>>>=0,x>>>=0)}if(t){const[n,i]=bi(x,N);x=n,N=i}}}function bi(e,t){return t=~t,e?e=1+~e:t+=1,[e,t]}const rs=typeof BigInt=="function"?BigInt.asIntN:void 0,D1=typeof BigInt=="function"?BigInt.asUintN:void 0,st=Number.isSafeInteger,Ws=Number.isFinite,Ct=Math.trunc,R1=tt(0);function ht(e){return e==null||typeof e=="number"?e:e==="NaN"||e==="Infinity"||e==="-Infinity"?Number(e):void 0}function Jo(e){return e==null||typeof e=="boolean"?e:typeof e=="number"?!!e:void 0}const O1=/^-?([1-9][0-9]*|0)(\.[0-9]+)?$/;function os(e){switch(typeof e){case"bigint":return!0;case"number":return Ws(e);case"string":return O1.test(e);default:return!1}}function Vt(e){if(e==null)return e;if(typeof e=="string"&&e)e=+e;else if(typeof e!="number")return;return Ws(e)?0|e:void 0}function Zo(e){if(e==null)return e;if(typeof e=="string"&&e)e=+e;else if(typeof e!="number")return;return Ws(e)?e>>>0:void 0}function Mr(e){if(e[0]==="-")return!1;const t=e.length;return t<20||t===20&&Number(e.substring(0,6))<184467}function Qo(e){const t=e.length;return e[0]==="-"?t<20||t===20&&Number(e.substring(0,7))>-922337:t<19||t===19&&Number(e.substring(0,6))<922337}function ea(e){return Qo(e)?e:(Hs(e),qo())}function wi(e){return e=Ct(e),st(e)||(yt(e),e=yi(x,N)),e}function ta(e){var t=Ct(Number(e));return st(t)?String(t):((t=e.indexOf("."))!==-1&&(e=e.substring(0,t)),ea(e))}function Cr(e){var t=Ct(Number(e));return st(t)?tt(t):((t=e.indexOf("."))!==-1&&(e=e.substring(0,t)),Us()?tt(rs(64,BigInt(e))):tt(ea(e)))}function Pr(e){if(st(e))e=tt(wi(e));else{if(e=Ct(e),st(e))e=String(e);else{const t=String(e);Qo(t)?e=t:(yt(e),e=qo())}e=tt(e)}return e}function Wn(e){return e==null?e:typeof e=="bigint"?(Hn(e)?e=Number(e):(e=rs(64,e),e=Hn(e)?Number(e):String(e)),e):os(e)?typeof e=="number"?wi(e):ta(e):void 0}function B1(e){if(e==null)return e;var t=typeof e;if(t==="bigint")return String(D1(64,e));if(os(e)){if(t==="string")return t=Ct(Number(e)),st(t)&&t>=0?e=String(t):((t=e.indexOf("."))!==-1&&(e=e.substring(0,t)),Mr(e)||(Hs(e),e=is(x,N))),e;if(t==="number")return(e=Ct(e))>=0&&st(e)?e:function(s){if(s<0){yt(s);var n=is(x,N);return s=Number(n),st(s)?s:n}return Mr(n=String(s))?n:(yt(s),gi(x,N))}(e)}}function sa(e){if(typeof e!="string")throw Error();return e}function jt(e){if(e!=null&&typeof e!="string")throw Error();return e}function Pt(e){return e==null||typeof e=="string"?e:void 0}function vi(e,t,s,n){if(e!=null&&typeof e=="object"&&e.W===ls)return e;if(!Array.isArray(e))return s?2&n?((e=t[Ar])||(Gt((e=new t).u),e=t[Ar]=e),t=e):t=new t:t=void 0,t;let i=s=0|e[w];return i===0&&(i|=32&n),i|=2&n,i!==s&&H(e,i),new t(e)}function N1(e,t,s){if(t)e:{if(!os(t=e))throw Vn("int64");switch(typeof t){case"string":t=Cr(t);break e;case"bigint":t=tt(rs(64,t));break e;default:t=Pr(t)}}else e=typeof(t=e),t=t==null?t:e==="bigint"?tt(rs(64,t)):os(t)?e==="string"?Cr(t):Pr(t):void 0;return(e=t)==null?s?R1:void 0:e}function U1(e){return e}const G1={};let V1=function(){try{return Os(new class extends Map{constructor(){super()}}),!1}catch{return!0}}();class Fn{constructor(){this.g=new Map}get(t){return this.g.get(t)}set(t,s){return this.g.set(t,s),this.size=this.g.size,this}delete(t){return t=this.g.delete(t),this.size=this.g.size,t}clear(){this.g.clear(),this.size=this.g.size}has(t){return this.g.has(t)}entries(){return this.g.entries()}keys(){return this.g.keys()}values(){return this.g.values()}forEach(t,s){return this.g.forEach(t,s)}[Symbol.iterator](){return this.entries()}}const j1=V1?(Object.setPrototypeOf(Fn.prototype,Map.prototype),Object.defineProperties(Fn.prototype,{size:{value:0,configurable:!0,enumerable:!0,writable:!0}}),Fn):class extends Map{constructor(){super()}};function Ir(e){return e}function xn(e){if(2&e.M)throw Error("Cannot mutate an immutable Map")}var Be=class extends j1{constructor(e,t,s=Ir,n=Ir){super();let i=0|e[w];i|=64,H(e,i),this.M=i,this.I=t,this.S=s,this.X=this.I?H1:n;for(let r=0;r<e.length;r++){const o=e[r],a=s(o[0],!1,!0);let h=o[1];t?h===void 0&&(h=null):h=n(o[1],!1,!0,void 0,void 0,i),super.set(a,h)}}La(){var e=X1;if(this.size!==0)return Array.from(super.entries(),t=>(t[0]=e(t[0]),t[1]=e(t[1]),t))}da(e=W1){const t=[],s=super.entries();for(var n;!(n=s.next()).done;)(n=n.value)[0]=e(n[0]),n[1]=e(n[1]),t.push(n);return t}clear(){xn(this),super.clear()}delete(e){return xn(this),super.delete(this.S(e,!0,!1))}entries(){if(this.I){var e=super.keys();e=new kr(e,z1,this)}else e=super.entries();return e}values(){if(this.I){var e=super.keys();e=new kr(e,Be.prototype.get,this)}else e=super.values();return e}forEach(e,t){this.I?super.forEach((s,n,i)=>{e.call(t,i.get(n),n,i)}):super.forEach(e,t)}set(e,t){return xn(this),(e=this.S(e,!0,!1))==null?this:t==null?(super.delete(e),this):super.set(e,this.X(t,!0,!0,this.I,!1,this.M))}Ja(e){const t=this.S(e[0],!1,!0);e=e[1],e=this.I?e===void 0?null:e:this.X(e,!1,!0,void 0,!1,this.M),super.set(t,e)}has(e){return super.has(this.S(e,!1,!1))}get(e){e=this.S(e,!1,!1);const t=super.get(e);if(t!==void 0){var s=this.I;return s?((s=this.X(t,!1,!0,s,this.pa,this.M))!==t&&super.set(e,s),s):t}}[Symbol.iterator](){return this.entries()}};function H1(e,t,s,n,i,r){return e=vi(e,n,s,r),i&&(e=$s(e)),e}function W1(e){return e}function z1(e){return[e,this.get(e)]}let K1,na,ia,$1;function Dr(){return K1||(K1=new Be(Gt([]),void 0,void 0,void 0,G1))}function zn(e,t,s,n,i){if(e!=null){if(Array.isArray(e)){const r=0|e[w];return e.length===0&&1&r?void 0:i&&2&r?e:zs(e,t,s,n!==void 0,i)}return t(e,n)}}function zs(e,t,s,n,i){const r=n||s?0|e[w]:0,o=n?!!(32&r):void 0;let a=0;const h=(n=ie(e)).length;for(let _=0;_<h;_++){var c=n[_];if(_===h-1&&Gs(c)){var l=t,u=s,d=o,y=i;let G;for(let Ce in c){const Pe=zn(c[Ce],l,u,d,y);Pe!=null&&((G??(G={}))[Ce]=Pe)}c=G}else c=zn(n[_],t,s,o,i);n[_]=c,c!=null&&(a=_+1)}return a<h&&(n.length=a),s&&((e=pi(e))&&(n[Mt]=ie(e)),s(r,n)),n}function X1(e){return zn(e,_i,void 0,void 0,!1)}function _i(e){switch(typeof e){case"number":return Number.isFinite(e)?e:""+e;case"bigint":return Hn(e)?Number(e):""+e;case"boolean":return e?1:0;case"object":if(mt(e))return mt(e)&&ui(Ko),_r(e);if(e.W===ls)return ra(e);if(e instanceof He){const t=e.g;return t==null?"":typeof t=="string"?t:e.g=_r(t)}return e instanceof Be?e.La():void 0}return e}function ra(e){var t=e.u;e=zs(t,_i,void 0,void 0,!1);var s=0|t[w];if((t=e.length)&&!(512&s)){var n=e[t-1],i=!1;Gs(n)?(t--,i=!0):n=void 0;var r=t-(s=512&s?0:-1),o=(na??U1)(r,s,e,n);if(n&&(e[t]=void 0),r<o&&n){for(var a in r=!0,n){const h=+a;h<=o?(e[i=h+s]=n[a],t=Math.max(i+1,t),i=!1,delete n[a]):r=!1}r&&(n=void 0)}for(r=t-1;t>0;r=t-1)if((a=e[r])==null)t--,i=!0;else{if(!((r-=s)>=o))break;(n??(n={}))[r]=a,t--,i=!0}i&&(e.length=t),n&&e.push(n)}return e}function nt(e,t,s){return e=oa(e,t[0],t[1],s?1:2),t!==ia&&s&&Ns(e,8192),e}function oa(e,t,s,n){if(e==null){var i=96;s?(e=[s],i|=512):e=[],t&&(i=-16760833&i|(1023&t)<<14)}else{if(!Array.isArray(e))throw Error("narr");if(8192&(i=0|e[w])||!(64&i)||2&i||ui(S1),1024&i)throw Error("farr");if(64&i)return e;if(n===1||n===2||(i|=64),s&&(i|=512,s!==e[0]))throw Error("mid");e:{var r=(s=e).length;if(r){var o=r-1;if(Gs(n=s[o])){if((o-=t=512&(i|=256)?0:-1)>=1024)throw Error("pvtlmt");for(var a in n)(r=+a)<o&&(s[r+t]=n[a],delete n[a]);i=-16760833&i|(1023&o)<<14;break e}}if(t){if((a=Math.max(t,r-(512&i?0:-1)))>1024)throw Error("spvt");i=-16760833&i|(1023&a)<<14}}}return H(e,i),e}function Kn(e,t,s=jn){if(e!=null){if(Vo&&e instanceof Uint8Array)return t?e:new Uint8Array(e);if(Array.isArray(e)){var n=0|e[w];return 2&n?e:(t&&(t=n===0||!!(32&n)&&!(64&n||!(16&n))),t?(H(e,34|n),4&n&&Object.freeze(e),e):zs(e,Kn,4&n?jn:s,!0,!0))}return e.W===ls?e=2&(n=0|(s=e.u)[w])?e:new e.constructor(Ks(s,n,!0)):e instanceof Be&&!(2&e.M)&&(s=Gt(e.da(Kn)),e=new Be(s,e.I,e.S,e.X)),e}}function Ks(e,t,s){const n=s||2&t?jn:k1,i=!!(32&t);return e=function(r,o,a){const h=ie(r);var c=h.length;const l=256&o?h[c-1]:void 0;for(c+=l?-1:0,o=512&o?1:0;o<c;o++)h[o]=a(h[o]);if(l){o=h[o]={};for(const u in l)o[u]=a(l[u])}return(r=pi(r))&&(h[Mt]=ie(r)),h}(e,t,r=>Kn(r,i,n)),Ns(e,32|(s?2:0)),e}function $s(e){const t=e.u,s=0|t[w];return 2&s?new e.constructor(Ks(t,s,!1)):e}function It(e,t){return Xe(e=e.u,0|e[w],t)}function Xe(e,t,s){if(s===-1)return null;const n=s+(512&t?0:-1),i=e.length-1;return n>=i&&256&t?e[i][s]:n<=i?e[n]:void 0}function M(e,t,s){const n=e.u;let i=0|n[w];return at(i),O(n,i,t,s),e}function O(e,t,s,n){const i=512&t?0:-1,r=s+i;var o=e.length-1;return r>=o&&256&t?(e[o][s]=n,t):r<=o?(e[r]=n,t):(n!==void 0&&(s>=(o=t>>14&1023||536870912)?n!=null&&(e[o+i]={[s]:n},H(e,t|=256)):e[r]=n),t)}function As(e,t){let s=0|(e=e.u)[w];const n=Xe(e,s,t),i=ht(n);return i!=null&&i!==n&&O(e,s,t,i),i}function aa(e){let t=0|(e=e.u)[w];const s=Xe(e,t,1),n=fi(s,!0);return n!=null&&n!==s&&O(e,t,1,n),n}function dt(){return T1===void 0?2:4}function ft(e,t,s,n,i){const r=e.u,o=2&(e=0|r[w])?1:n;i=!!i;let a=0|(n=Ei(r,e,t))[w];if(!(4&a)){4&a&&(n=ie(n),a=We(a,e),e=O(r,e,t,n));let h=0,c=0;for(;h<n.length;h++){const l=s(n[h]);l!=null&&(n[c++]=l)}c<h&&(n.length=c),a=Ai(a,e),s=-2049&(20|a),a=s&=-4097,H(n,a),2&a&&Object.freeze(n)}return o===1||o===4&&32&a?je(a)||(i=a,a|=2,a!==i&&H(n,a),Object.freeze(n)):(o===2&&je(a)&&(n=ie(n),a=We(a,e),a=it(a,e,i),H(n,a),e=O(r,e,t,n)),je(a)||(t=a,a=it(a,e,i),a!==t&&H(n,a))),n}function Ei(e,t,s){return e=Xe(e,t,s),Array.isArray(e)?e:di}function Ai(e,t){return e===0&&(e=We(e,t)),1|e}function je(e){return!!(2&e)&&!!(4&e)||!!(1024&e)}function ha(e){e=ie(e);for(let t=0;t<e.length;t++){const s=e[t]=ie(e[t]);Array.isArray(s[1])&&(s[1]=Gt(s[1]))}return e}function $n(e,t,s,n){let i=0|(e=e.u)[w];at(i),O(e,i,t,(n==="0"?Number(s)===0:s===n)?void 0:s)}function Ht(e,t,s,n){at(t);let i=Ei(e,t,s);const r=i!==di;if(64&t||!(8192&t)||!r){const o=r?0|i[w]:0;let a=o;(!r||2&a||je(a)||4&a&&!(32&a))&&(i=ie(i),a=We(a,t),t=O(e,t,s,i)),a=-13&Ai(a,t),a=it(n?-17&a:16|a,t,!0),a!==o&&H(i,a)}return i}function Ln(e,t){var s=qa;return ki(Si(e=e.u),e,0|e[w],s)===t?t:-1}function Si(e){if(Bs)return e[Yt]??(e[Yt]=new Map);if(Yt in e)return e[Yt];const t=new Map;return Object.defineProperty(e,Yt,{value:t}),t}function ca(e,t,s,n){const i=Si(e),r=ki(i,e,t,s);return r!==n&&(r&&(t=O(e,t,r)),i.set(s,n)),t}function ki(e,t,s,n){let i=e.get(n);if(i!=null)return i;i=0;for(let r=0;r<n.length;r++){const o=n[r];Xe(t,s,o)!=null&&(i!==0&&(s=O(t,s,i)),i=o)}return e.set(n,i),i}function Ti(e,t,s){let n=0|e[w];const i=Xe(e,n,s);let r;if(i!=null&&i.W===ls)return(t=$s(i))!==i&&O(e,n,s,t),t.u;if(Array.isArray(i)){const o=0|i[w];r=2&o?nt(Ks(i,o,!1),t,!0):64&o?i:nt(r,t,!0)}else r=nt(void 0,t,!0);return r!==i&&O(e,n,s,r),r}function la(e,t,s){let n=0|(e=e.u)[w];const i=Xe(e,n,s);return(t=vi(i,t,!1,n))!==i&&t!=null&&O(e,n,s,t),t}function S(e,t,s){if((t=la(e,t,s))==null)return t;let n=0|(e=e.u)[w];if(!(2&n)){const i=$s(t);i!==t&&O(e,n,s,t=i)}return t}function ua(e,t,s,n,i,r,o){e=e.u;var a=!!(2&t);const h=a?1:i;r=!!r,o&&(o=!a);var c=0|(i=Ei(e,t,n))[w];if(!(a=!!(4&c))){var l=i,u=t;const d=!!(2&(c=Ai(c,t)));d&&(u|=2);let y=!d,_=!0,G=0,Ce=0;for(;G<l.length;G++){const Pe=vi(l[G],s,!1,u);if(Pe instanceof s){if(!d){const wt=!!(2&(0|Pe.u[w]));y&&(y=!wt),_&&(_=wt)}l[Ce++]=Pe}}Ce<G&&(l.length=Ce),c|=4,c=_?16|c:-17&c,H(l,c=y?8|c:-9&c),d&&Object.freeze(l)}if(o&&!(8&c||!i.length&&(h===1||h===4&&32&c))){for(je(c)&&(i=ie(i),c=We(c,t),t=O(e,t,n,i)),s=i,o=c,l=0;l<s.length;l++)(c=s[l])!==(u=$s(c))&&(s[l]=u);o|=8,H(s,o=s.length?-17&o:16|o),c=o}return h===1||h===4&&32&c?je(c)||(t=c,(c|=!i.length||16&c&&(!a||32&c)?2:1024)!==t&&H(i,c),Object.freeze(i)):(h===2&&je(c)&&(H(i=ie(i),c=it(c=We(c,t),t,r)),t=O(e,t,n,i)),je(c)||(n=c,(c=it(c,t,r))!==n&&H(i,c))),i}function Ke(e,t,s){const n=0|e.u[w];return ua(e,n,t,s,dt(),!1,!(2&n))}function v(e,t,s,n){return n==null&&(n=void 0),M(e,s,n)}function es(e,t,s,n){n==null&&(n=void 0);e:{let i=0|(e=e.u)[w];if(at(i),n==null){const r=Si(e);if(ki(r,e,i,s)!==t)break e;r.set(s,0)}else i=ca(e,i,s,t);O(e,i,t,n)}}function We(e,t){return-1025&(e=32|(2&t?2|e:-3&e))}function it(e,t,s){return 32&t&&s||(e&=-33),e}function Xs(e,t,s){at(0|e.u[w]),ft(e,t,Pt,2,!0).push(sa(s))}function Ms(e,t,s,n){const i=0|e.u[w];at(i),e=ua(e,i,s,t,2,!0),n=n??new s,e.push(n),e[w]=2&(0|n.u[w])?-9&e[w]:-17&e[w]}function Ee(e,t){return Vt(It(e,t))}function Ae(e,t){return Pt(It(e,t))}function V(e,t){return As(e,t)??0}function as(e,t,s){if(s!=null&&typeof s!="boolean")throw e=typeof s,Error(`Expected boolean but got ${e!="object"?e:s?Array.isArray(s)?"array":e:"null"}: ${s}`);M(e,t,s)}function Ne(e,t,s){if(s!=null){if(typeof s!="number"||!Ws(s))throw Vn("int32");s|=0}M(e,t,s)}function g(e,t,s){if(s!=null&&typeof s!="number")throw Error(`Value of float/double field must be a number, found ${typeof s}: ${s}`);M(e,t,s)}function Cs(e,t,s){{const o=e.u;let a=0|o[w];if(at(a),s==null)O(o,a,t);else{var n=e=0|s[w],i=je(e),r=i||Object.isFrozen(s);for(i||(e=0),r||(s=ie(s),n=0,e=it(e=We(e,a),a,!0),r=!1),e|=21,i=0;i<s.length;i++){const h=s[i],c=sa(h);Object.is(h,c)||(r&&(s=ie(s),n=0,e=it(e=We(e,a),a,!0),r=!1),s[i]=c)}e!==n&&(r&&(s=ie(s),e=it(e=We(e,a),a,!0)),H(s,e)),O(o,a,t,s)}}}function da(e,t){return Error(`Invalid wire type: ${e} (at position ${t})`)}function Fi(){return Error("Failed to read varint, encoding is invalid.")}function fa(e,t){return Error(`Tried to read past the end of the data ${t} > ${e}`)}function xi(e){if(typeof e=="string")return{buffer:Ho(e),O:!1};if(Array.isArray(e))return{buffer:new Uint8Array(e),O:!1};if(e.constructor===Uint8Array)return{buffer:e,O:!1};if(e.constructor===ArrayBuffer)return{buffer:new Uint8Array(e),O:!1};if(e.constructor===He)return{buffer:li(e)||new Uint8Array(0),O:!0};if(e instanceof Uint8Array)return{buffer:new Uint8Array(e.buffer,e.byteOffset,e.byteLength),O:!1};throw Error("Type not convertible to a Uint8Array, expected a Uint8Array, an ArrayBuffer, a base64 encoded string, a ByteString or an Array of numbers")}function Li(e,t){let s,n=0,i=0,r=0;const o=e.h;let a=e.g;do s=o[a++],n|=(127&s)<<r,r+=7;while(r<32&&128&s);for(r>32&&(i|=(127&s)>>4),r=3;r<32&&128&s;r+=7)s=o[a++],i|=(127&s)<<r;if(pt(e,a),s<128)return t(n>>>0,i>>>0);throw Fi()}function Mi(e){let t=0,s=e.g;const n=s+10,i=e.h;for(;s<n;){const r=i[s++];if(t|=r,(128&r)==0)return pt(e,s),!!(127&t)}throw Fi()}function rt(e){const t=e.h;let s=e.g,n=t[s++],i=127&n;if(128&n&&(n=t[s++],i|=(127&n)<<7,128&n&&(n=t[s++],i|=(127&n)<<14,128&n&&(n=t[s++],i|=(127&n)<<21,128&n&&(n=t[s++],i|=n<<28,128&n&&128&t[s++]&&128&t[s++]&&128&t[s++]&&128&t[s++]&&128&t[s++])))))throw Fi();return pt(e,s),i}function $e(e){return rt(e)>>>0}function Xn(e){var t=e.h;const s=e.g,n=t[s],i=t[s+1],r=t[s+2];return t=t[s+3],pt(e,e.g+4),(n<<0|i<<8|r<<16|t<<24)>>>0}function Yn(e){var t=Xn(e);e=2*(t>>31)+1;const s=t>>>23&255;return t&=8388607,s==255?t?NaN:e*(1/0):s==0?1401298464324817e-60*e*t:e*Math.pow(2,s-150)*(t+8388608)}function Y1(e){return rt(e)}function Mn(e,t,{aa:s=!1}={}){e.aa=s,t&&(t=xi(t),e.h=t.buffer,e.m=t.O,e.j=0,e.l=e.h.length,e.g=e.j)}function pt(e,t){if(e.g=t,t>e.l)throw fa(e.l,t)}function pa(e,t){if(t<0)throw Error(`Tried to read a negative byte length: ${t}`);const s=e.g,n=s+t;if(n>e.l)throw fa(t,e.l-s);return e.g=n,s}function ma(e,t){if(t==0)return gt();var s=pa(e,t);return e.aa&&e.m?s=e.h.subarray(s,s+t):(e=e.h,s=s===(t=s+t)?new Uint8Array(0):I1?e.slice(s,t):new Uint8Array(e.subarray(s,t))),s.length==0?gt():new He(s,Lt)}Be.prototype.toJSON=void 0;var Rr=[];function ga(e){var t=e.g;if(t.g==t.l)return!1;e.l=e.g.g;var s=$e(e.g);if(t=s>>>3,!((s&=7)>=0&&s<=5))throw da(s,e.l);if(t<1)throw Error(`Invalid field number: ${t} (at position ${e.l})`);return e.m=t,e.h=s,!0}function Ss(e){switch(e.h){case 0:e.h!=0?Ss(e):Mi(e.g);break;case 1:pt(e=e.g,e.g+8);break;case 2:if(e.h!=2)Ss(e);else{var t=$e(e.g);pt(e=e.g,e.g+t)}break;case 5:pt(e=e.g,e.g+4);break;case 3:for(t=e.m;;){if(!ga(e))throw Error("Unmatched start-group tag: stream EOF");if(e.h==4){if(e.m!=t)throw Error("Unmatched end-group tag");break}Ss(e)}break;default:throw da(e.h,e.l)}}function us(e,t,s){const n=e.g.l,i=$e(e.g),r=e.g.g+i;let o=r-n;if(o<=0&&(e.g.l=r,s(t,e,void 0,void 0,void 0),o=r-e.g.g),o)throw Error(`Message parsing ended unexpectedly. Expected to read ${i} bytes, instead read ${i-o} bytes, either the data ended unexpectedly or the message misreported its own length`);return e.g.g=r,e.g.l=n,t}function Ci(e){var t=$e(e.g),s=pa(e=e.g,t);if(e=e.h,p1){var n,i=e;(n=An)||(n=An=new TextDecoder("utf-8",{fatal:!0})),t=s+t,i=s===0&&t===i.length?i:i.subarray(s,t);try{var r=n.decode(i)}catch(a){if(ms===void 0){try{n.decode(new Uint8Array([128]))}catch{}try{n.decode(new Uint8Array([97])),ms=!0}catch{ms=!1}}throw!ms&&(An=void 0),a}}else{t=(r=s)+t,s=[];let a,h=null;for(;r<t;){var o=e[r++];o<128?s.push(o):o<224?r>=t?lt():(a=e[r++],o<194||(192&a)!=128?(r--,lt()):s.push((31&o)<<6|63&a)):o<240?r>=t-1?lt():(a=e[r++],(192&a)!=128||o===224&&a<160||o===237&&a>=160||(192&(n=e[r++]))!=128?(r--,lt()):s.push((15&o)<<12|(63&a)<<6|63&n)):o<=244?r>=t-2?lt():(a=e[r++],(192&a)!=128||a-144+(o<<28)>>30||(192&(n=e[r++]))!=128||(192&(i=e[r++]))!=128?(r--,lt()):(o=(7&o)<<18|(63&a)<<12|(63&n)<<6|63&i,o-=65536,s.push(55296+(o>>10&1023),56320+(1023&o)))):lt(),s.length>=8192&&(h=yr(h,s),s.length=0)}r=yr(h,s)}return r}function ya(e){const t=$e(e.g);return ma(e.g,t)}function Ys(e,t,s){var n=$e(e.g);for(n=e.g.g+n;e.g.g<n;)s.push(t(e.g))}var gs=[];function Fe(e,t,s){t.g?t.m(e,t.g,t.h,s):t.m(e,t.h,s)}var m=class{constructor(e,t){this.u=oa(e,t)}toJSON(){try{var e=ra(this)}finally{na=void 0}return e}l(){var e=Ch;return e.g?e.l(this,e.g,e.h):e.l(this,e.h,e.defaultValue)}clone(){const e=this.u;return new this.constructor(Ks(e,0|e[w],!1))}O(){return!!(2&(0|this.u[w]))}};function Or(e){return e?/^\d+$/.test(e)?(Hs(e),new qn(x,N)):null:q1||(q1=new qn(0,0))}m.prototype.W=ls,m.prototype.toString=function(){return this.u.toString()};var qn=class{constructor(e,t){this.h=e>>>0,this.g=t>>>0}};let q1;function Br(e){return e?/^-?\d+$/.test(e)?(Hs(e),new Jn(x,N)):null:J1||(J1=new Jn(0,0))}var Jn=class{constructor(e,t){this.h=e>>>0,this.g=t>>>0}};let J1;function kt(e,t,s){for(;s>0||t>127;)e.g.push(127&t|128),t=(t>>>7|s<<25)>>>0,s>>>=7;e.g.push(t)}function Wt(e,t){for(;t>127;)e.g.push(127&t|128),t>>>=7;e.g.push(t)}function qs(e,t){if(t>=0)Wt(e,t);else{for(let s=0;s<9;s++)e.g.push(127&t|128),t>>=7;e.g.push(1)}}function hs(e,t){e.g.push(t>>>0&255),e.g.push(t>>>8&255),e.g.push(t>>>16&255),e.g.push(t>>>24&255)}function Dt(e,t){t.length!==0&&(e.l.push(t),e.h+=t.length)}function me(e,t,s){Wt(e.g,8*t+s)}function Pi(e,t){return me(e,t,2),t=e.g.end(),Dt(e,t),t.push(e.h),t}function Ii(e,t){var s=t.pop();for(s=e.h+e.g.length()-s;s>127;)t.push(127&s|128),s>>>=7,e.h++;t.push(s),e.h++}function Js(e,t,s){me(e,t,2),Wt(e.g,s.length),Dt(e,e.g.end()),Dt(e,s)}function Ps(e,t,s,n){s!=null&&(t=Pi(e,t),n(s,e),Ii(e,t))}function xe(){const e=class{constructor(){throw Error()}};return Object.setPrototypeOf(e,e.prototype),e}var Di=xe(),ba=xe(),Ri=xe(),Oi=xe(),wa=xe(),va=xe(),Bi=xe(),_a=xe(),Ea=xe(),zt=class{constructor(e,t,s){this.g=e,this.h=t,e=Di,this.l=!!e&&s===e||!1}};function Zs(e,t){return new zt(e,t,Di)}function Aa(e,t,s,n,i){Ps(e,s,Fa(t,n),i)}const Z1=Zs(function(e,t,s,n,i){return e.h===2&&(us(e,Ti(t,n,s),i),!0)},Aa),Q1=Zs(function(e,t,s,n,i){return e.h===2&&(us(e,Ti(t,n,s),i),!0)},Aa);var Qs=Symbol(),Ni=Symbol(),Nr=Symbol(),Ur=Symbol();let Sa,ka;function bt(e,t,s,n){var i=n[e];if(i)return i;(i={}).Ma=n,i.T=function(u){switch(typeof u){case"boolean":return ia||(ia=[0,void 0,!0]);case"number":return u>0?void 0:u===0?$1||($1=[0,void 0]):[-u,void 0];case"string":return[0,u];case"object":return u}}(n[0]);var r=n[1];let o=1;r&&r.constructor===Object&&(i.ga=r,typeof(r=n[++o])=="function"&&(i.la=!0,Sa??(Sa=r),ka??(ka=n[o+1]),r=n[o+=2]));const a={};for(;r&&Array.isArray(r)&&r.length&&typeof r[0]=="number"&&r[0]>0;){for(var h=0;h<r.length;h++)a[r[h]]=r;r=n[++o]}for(h=1;r!==void 0;){let u;typeof r=="number"&&(h+=r,r=n[++o]);var c=void 0;if(r instanceof zt?u=r:(u=Z1,o--),u==null?void 0:u.l){r=n[++o],c=n;var l=o;typeof r=="function"&&(r=r(),c[l]=r),c=r}for(l=h+1,typeof(r=n[++o])=="number"&&r<0&&(l-=r,r=n[++o]);h<l;h++){const d=a[h];c?s(i,h,u,c,d):t(i,h,u,d)}}return n[e]=i}function Ta(e){return Array.isArray(e)?e[0]instanceof zt?e:[Q1,e]:[e,void 0]}function Fa(e,t){return e instanceof m?e.u:Array.isArray(e)?nt(e,t,!1):void 0}function Ui(e,t,s,n){const i=s.g;e[t]=n?(r,o,a)=>i(r,o,a,n):i}function Gi(e,t,s,n,i){const r=s.g;let o,a;e[t]=(h,c,l)=>r(h,c,l,a||(a=bt(Ni,Ui,Gi,n).T),o||(o=Vi(n)),i)}function Vi(e){let t=e[Nr];if(t!=null)return t;const s=bt(Ni,Ui,Gi,e);return t=s.la?(n,i)=>Sa(n,i,s):(n,i)=>{const r=0|n[w];for(;ga(i)&&i.h!=4;){var o=i.m,a=s[o];if(a==null){var h=s.ga;h&&(h=h[o])&&(h=eh(h))!=null&&(a=s[o]=h)}a!=null&&a(i,n,o)||(o=(a=i).l,Ss(a),a.fa?a=void 0:(h=a.g.g-o,a.g.g=o,a=ma(a.g,h)),o=n,a&&((h=o[Mt])?h.push(a):o[Mt]=[a]))}return 8192&r&&Gt(n),!0},e[Nr]=t}function eh(e){const t=(e=Ta(e))[0].g;if(e=e[1]){const s=Vi(e),n=bt(Ni,Ui,Gi,e).T;return(i,r,o)=>t(i,r,o,n,s)}return t}function en(e,t,s){e[t]=s.h}function tn(e,t,s,n){let i,r;const o=s.h;e[t]=(a,h,c)=>o(a,h,c,r||(r=bt(Qs,en,tn,n).T),i||(i=xa(n)))}function xa(e){let t=e[Ur];if(!t){const s=bt(Qs,en,tn,e);t=(n,i)=>La(n,i,s),e[Ur]=t}return t}function La(e,t,s){(function(n,i,r){const o=512&i?0:-1,a=n.length,h=a+((i=64&i?256&i:!!a&&Gs(n[a-1]))?-1:0);for(let c=0;c<h;c++)r(c-o,n[c]);if(i){n=n[a-1];for(const c in n)!isNaN(c)&&r(+c,n[c])}})(e,0|e[w]|(s.T[1]?512:0),(n,i)=>{if(i!=null){var r=function(o,a){var h=o[a];if(h)return h;if((h=o.ga)&&(h=h[a])){var c=(h=Ta(h))[0].h;if(h=h[1]){const l=xa(h),u=bt(Qs,en,tn,h).T;h=o.la?ka(u,l):(d,y,_)=>c(d,y,_,u,l)}else h=c;return o[a]=h}}(s,n);r&&r(t,i,n)}}),(e=pi(e))&&function(n,i){Dt(n,n.g.end());for(let r=0;r<i.length;r++)Dt(n,li(i[r])||new Uint8Array(0))}(t,e)}function Kt(e,t){if(Array.isArray(t)){var s=0|t[w];if(4&s)return t;for(var n=0,i=0;n<t.length;n++){const r=e(t[n]);r!=null&&(t[i++]=r)}return i<n&&(t.length=i),H(t,-6145&(5|s)),2&s&&Object.freeze(t),t}}function ee(e,t,s){return new zt(e,t,s)}function $t(e,t,s){return new zt(e,t,s)}function te(e,t,s){O(e,0|e[w],t,s)}var th=Zs(function(e,t,s,n,i){return e.h===2&&(e=us(e,nt([void 0,void 0],n,!0),i),at(n=0|t[w]),(i=Xe(t,n,s))instanceof Be?2&i.M?((i=i.da()).push(e),O(t,n,s,i)):i.Ja(e):Array.isArray(i)?(2&(0|i[w])&&O(t,n,s,i=ha(i)),i.push(e)):O(t,n,s,[e]),!0)},function(e,t,s,n,i){if(t instanceof Be)t.forEach((r,o)=>{Ps(e,s,nt([o,r],n,!1),i)});else if(Array.isArray(t))for(let r=0;r<t.length;r++){const o=t[r];Array.isArray(o)&&Ps(e,s,nt(o,n,!1),i)}});function Ma(e,t,s){if(t=function(n){if(n==null)return n;const i=typeof n;if(i==="bigint")return String(rs(64,n));if(os(n)){if(i==="string")return ta(n);if(i==="number")return wi(n)}}(t),t!=null&&(typeof t=="string"&&Br(t),t!=null))switch(me(e,s,0),typeof t){case"number":e=e.g,yt(t),kt(e,x,N);break;case"bigint":s=BigInt.asUintN(64,t),s=new Jn(Number(s&BigInt(4294967295)),Number(s>>BigInt(32))),kt(e.g,s.h,s.g);break;default:s=Br(t),kt(e.g,s.h,s.g)}}function Ca(e,t,s){(t=Vt(t))!=null&&t!=null&&(me(e,s,0),qs(e.g,t))}function Pa(e,t,s){(t=Jo(t))!=null&&(me(e,s,0),e.g.g.push(t?1:0))}function Ia(e,t,s){(t=Pt(t))!=null&&Js(e,s,No(t))}function Da(e,t,s,n,i){Ps(e,s,Fa(t,n),i)}function Ra(e,t,s){t==null||typeof t=="string"||t instanceof He||(mt(t)?mt(t)&&ui(Ko):t=void 0),t!=null&&Js(e,s,xi(t).buffer)}function Oa(e,t,s){return(e.h===5||e.h===2)&&(t=Ht(t,0|t[w],s,!1),e.h==2?Ys(e,Yn,t):t.push(Yn(e.g)),!0)}var Ge=ee(function(e,t,s){if(e.h!==1)return!1;var n=e.g;e=Xn(n);const i=Xn(n);n=2*(i>>31)+1;const r=i>>>20&2047;return e=4294967296*(1048575&i)+e,te(t,s,r==2047?e?NaN:n*(1/0):r==0?5e-324*n*e:n*Math.pow(2,r-1075)*(e+4503599627370496)),!0},function(e,t,s){(t=ht(t))!=null&&(me(e,s,1),e=e.g,(s=Yo||(Yo=new DataView(new ArrayBuffer(8)))).setFloat64(0,+t,!0),x=s.getUint32(0,!0),N=s.getUint32(4,!0),hs(e,x),hs(e,N))},xe()),W=ee(function(e,t,s){return e.h===5&&(te(t,s,Yn(e.g)),!0)},function(e,t,s){(t=ht(t))!=null&&(me(e,s,5),e=e.g,mi(t),hs(e,x))},Bi),sh=$t(Oa,function(e,t,s){if((t=Kt(ht,t))!=null)for(let o=0;o<t.length;o++){var n=e,i=s,r=t[o];r!=null&&(me(n,i,5),n=n.g,mi(r),hs(n,x))}},Bi),ji=$t(Oa,function(e,t,s){if((t=Kt(ht,t))!=null&&t.length){me(e,s,2),Wt(e.g,4*t.length);for(let n=0;n<t.length;n++)s=e.g,mi(t[n]),hs(s,x)}},Bi),ot=ee(function(e,t,s){return e.h===0&&(te(t,s,Li(e.g,yi)),!0)},Ma,va),Cn=ee(function(e,t,s){return e.h===0&&(te(t,s,(e=Li(e.g,yi))===0?void 0:e),!0)},Ma,va),nh=ee(function(e,t,s){return e.h===0&&(te(t,s,Li(e.g,gi)),!0)},function(e,t,s){if((t=B1(t))!=null&&(typeof t=="string"&&Or(t),t!=null))switch(me(e,s,0),typeof t){case"number":e=e.g,yt(t),kt(e,x,N);break;case"bigint":s=BigInt.asUintN(64,t),s=new qn(Number(s&BigInt(4294967295)),Number(s>>BigInt(32))),kt(e.g,s.h,s.g);break;default:s=Or(t),kt(e.g,s.h,s.g)}},xe()),U=ee(function(e,t,s){return e.h===0&&(te(t,s,rt(e.g)),!0)},Ca,Oi),sn=$t(function(e,t,s){return(e.h===0||e.h===2)&&(t=Ht(t,0|t[w],s,!1),e.h==2?Ys(e,rt,t):t.push(rt(e.g)),!0)},function(e,t,s){if((t=Kt(Vt,t))!=null&&t.length){s=Pi(e,s);for(let n=0;n<t.length;n++)qs(e.g,t[n]);Ii(e,s)}},Oi),St=ee(function(e,t,s){return e.h===0&&(te(t,s,(e=rt(e.g))===0?void 0:e),!0)},Ca,Oi),D=ee(function(e,t,s){return e.h===0&&(te(t,s,Mi(e.g)),!0)},Pa,ba),Tt=ee(function(e,t,s){return e.h===0&&(te(t,s,(e=Mi(e.g))===!1?void 0:e),!0)},Pa,ba),Z=$t(function(e,t,s){return e.h===2&&(e=Ci(e),Ht(t,0|t[w],s,!1).push(e),!0)},function(e,t,s){if((t=Kt(Pt,t))!=null)for(let o=0;o<t.length;o++){var n=e,i=s,r=t[o];r!=null&&Js(n,i,No(r))}},Ri),et=ee(function(e,t,s){return e.h===2&&(te(t,s,(e=Ci(e))===""?void 0:e),!0)},Ia,Ri),F=ee(function(e,t,s){return e.h===2&&(te(t,s,Ci(e)),!0)},Ia,Ri),K=function(e,t,s=Di){return new zt(e,t,s)}(function(e,t,s,n,i){return e.h===2&&(n=nt(void 0,n,!0),Ht(t,0|t[w],s,!0).push(n),us(e,n,i),!0)},function(e,t,s,n,i){if(Array.isArray(t))for(let r=0;r<t.length;r++)Da(e,t[r],s,n,i)}),T=Zs(function(e,t,s,n,i,r){return e.h===2&&(ca(t,0|t[w],r,s),us(e,t=Ti(t,n,s),i),!0)},Da),Ba=ee(function(e,t,s){return e.h===2&&(te(t,s,ya(e)),!0)},Ra,_a),ih=$t(function(e,t,s){return(e.h===0||e.h===2)&&(t=Ht(t,0|t[w],s,!1),e.h==2?Ys(e,$e,t):t.push($e(e.g)),!0)},function(e,t,s){if((t=Kt(Zo,t))!=null)for(let o=0;o<t.length;o++){var n=e,i=s,r=t[o];r!=null&&(me(n,i,0),Wt(n.g,r))}},wa),rh=ee(function(e,t,s){return e.h===0&&(te(t,s,(e=$e(e.g))===0?void 0:e),!0)},function(e,t,s){(t=Zo(t))!=null&&t!=null&&(me(e,s,0),Wt(e.g,t))},wa),fe=ee(function(e,t,s){return e.h===0&&(te(t,s,rt(e.g)),!0)},function(e,t,s){(t=Vt(t))!=null&&(t=parseInt(t,10),me(e,s,0),qs(e.g,t))},Ea);class oh{constructor(t,s){this.h=t,this.g=s,this.l=S,this.m=v,this.defaultValue=void 0}register(){Os(this)}}function Le(e,t){return new oh(e,t)}function ct(e,t){return(s,n)=>{if(gs.length){const r=gs.pop();r.o(n),Mn(r.g,s,n),s=r}else s=new class{constructor(r,o){if(Rr.length){const a=Rr.pop();Mn(a,r,o),r=a}else r=new class{constructor(a,h){this.h=null,this.m=!1,this.g=this.l=this.j=0,Mn(this,a,h)}clear(){this.h=null,this.m=!1,this.g=this.l=this.j=0,this.aa=!1}}(r,o);this.g=r,this.l=this.g.g,this.h=this.m=-1,this.o(o)}o({fa:r=!1}={}){this.fa=r}}(s,n);try{const r=new e,o=r.u;Vi(t)(o,s);var i=r}finally{s.g.clear(),s.m=-1,s.h=-1,gs.length<100&&gs.push(s)}return i}}function nn(e){return function(){const t=new class{constructor(){this.l=[],this.h=0,this.g=new class{constructor(){this.g=[]}length(){return this.g.length}end(){const o=this.g;return this.g=[],o}}}};La(this.u,t,bt(Qs,en,tn,e)),Dt(t,t.g.end());const s=new Uint8Array(t.h),n=t.l,i=n.length;let r=0;for(let o=0;o<i;o++){const a=n[o];s.set(a,r),r+=a.length}return t.l=[s],s}}var Gr=class extends m{constructor(e){super(e)}},Vr=[0,et,ee(function(e,t,s){return e.h===2&&(te(t,s,(e=ya(e))===gt()?void 0:e),!0)},function(e,t,s){if(t!=null){if(t instanceof m){const n=t.Oa;return void(n&&(t=n(t),t!=null&&Js(e,s,xi(t).buffer)))}if(Array.isArray(t))return}Ra(e,t,s)},_a)];let Pn,jr=globalThis.trustedTypes;function Hr(e){Pn===void 0&&(Pn=function(){let s=null;if(!jr)return s;try{const n=i=>i;s=jr.createPolicy("goog#html",{createHTML:n,createScript:n,createScriptURL:n})}catch{}return s}());var t=Pn;return new class{constructor(s){this.g=s}toString(){return this.g+""}}(t?t.createScriptURL(e):e)}function ah(e,...t){if(t.length===0)return Hr(e[0]);let s=e[0];for(let n=0;n<t.length;n++)s+=encodeURIComponent(t[n])+e[n+1];return Hr(s)}var Na=[0,U,fe,D,-1,sn,fe,-1],hh=class extends m{constructor(e){super(e)}},Ua=[0,D,F,D,fe,-1,$t(function(e,t,s){return(e.h===0||e.h===2)&&(t=Ht(t,0|t[w],s,!1),e.h==2?Ys(e,Y1,t):t.push(rt(e.g)),!0)},function(e,t,s){if((t=Kt(Vt,t))!=null&&t.length){s=Pi(e,s);for(let n=0;n<t.length;n++)qs(e.g,t[n]);Ii(e,s)}},Ea),F,-1,[0,D,-1],fe,D,-1],Ga=[0,F,-2],Wr=class extends m{constructor(e){super(e)}},Va=[0],ja=[0,U,D,1,D,-3],pe=class extends m{constructor(e){super(e,2)}},z={};z[336783863]=[0,F,D,-1,U,[0,[1,2,3,4,5,6,7,8,9],T,Va,T,Ua,T,Ga,T,ja,T,Na,T,[0,F,-2],T,[0,F,fe],T,[0,fe,F,-1],T,[0,fe,-1]],[0,F],D,[0,[1,3],[2,4],T,[0,sn],-1,T,[0,Z],-1,K,[0,F,-1]],F];var zr=[0,Cn,-1,Tt,-3,Cn,sn,et,St,Cn,-1,Tt,St,Tt,-2,et];function ge(e,t){$n(e,2,jt(t),"")}function C(e,t){Xs(e,3,t)}function A(e,t){Xs(e,4,t)}var Q=class extends m{constructor(e){super(e,500)}o(e){return v(this,0,7,e)}},ts=[-1,{}],Kr=[0,F,1,ts],$r=[0,F,Z,ts];function ye(e,t){Ms(e,1,Q,t)}function P(e,t){Xs(e,10,t)}function k(e,t){Xs(e,15,t)}var oe=class extends m{constructor(e){super(e,500)}o(e){return v(this,0,1001,e)}},Ha=[-500,K,[-500,et,-1,Z,-3,[-2,z,D],K,Vr,St,-1,Kr,$r,K,[0,et,Tt],et,zr,St,Z,987,Z],4,K,[-500,F,-1,[-1,{}],998,F],K,[-500,F,Z,-1,[-2,{},D],997,Z,-1],St,K,[-500,F,Z,ts,998,Z],Z,St,Kr,$r,K,[0,et,-1,ts],Z,-2,zr,et,-1,Tt,[0,Tt,rh],978,ts,K,Vr];oe.prototype.g=nn(Ha);var ch=ct(oe,Ha),lh=class extends m{constructor(e){super(e)}},Wa=class extends m{constructor(e){super(e)}g(){return Ke(this,lh,1)}},za=[0,K,[0,U,W,F,-1]],rn=ct(Wa,za),uh=class extends m{constructor(e){super(e)}},dh=class extends m{constructor(e){super(e)}},In=class extends m{constructor(e){super(e)}h(){return S(this,uh,2)}g(){return Ke(this,dh,5)}},Ka=ct(class extends m{constructor(e){super(e)}},[0,Z,sn,ji,[0,fe,[0,U,-3],[0,W,-3],[0,U,-1,[0,K,[0,U,-2]]],K,[0,W,-1,F,W]],F,-1,ot,K,[0,U,W],Z,ot]),$a=class extends m{constructor(e){super(e)}},Ft=ct(class extends m{constructor(e){super(e)}},[0,K,[0,W,-4]]),Xa=class extends m{constructor(e){super(e)}},ds=ct(class extends m{constructor(e){super(e)}},[0,K,[0,W,-4]]),fh=class extends m{constructor(e){super(e)}},ph=[0,U,-1,ji,fe],Ya=class extends m{constructor(e){super(e)}};Ya.prototype.g=nn([0,W,-4,ot]);var mh=class extends m{constructor(e){super(e)}},gh=ct(class extends m{constructor(e){super(e)}},[0,K,[0,1,U,F,za],ot]),Xr=class extends m{constructor(e){super(e)}},yh=class extends m{constructor(e){super(e)}ma(){const e=aa(this);return e??gt()}},bh=class extends m{constructor(e){super(e)}},qa=[1,2],wh=ct(class extends m{constructor(e){super(e)}},[0,K,[0,qa,T,[0,ji],T,[0,Ba],U,F],ot]),Hi=class extends m{constructor(e){super(e)}},Ja=[0,F,U,W,Z,-1],Yr=class extends m{constructor(e){super(e)}},vh=[0,D,-1],qr=class extends m{constructor(e){super(e)}},ks=[1,2,3,4,5],Is=class extends m{constructor(e){super(e)}g(){return aa(this)!=null}h(){return Ae(this,2)!=null}},R=class extends m{constructor(e){super(e)}g(){return Jo(It(this,2))??!1}},Za=[0,Ba,F,[0,U,ot,-1],[0,nh,ot]],j=[0,Za,D,[0,ks,T,ja,T,Ua,T,Na,T,Va,T,Ga],fe],on=class extends m{constructor(e){super(e)}},Wi=[0,j,W,-1,U],_h=Le(502141897,on);z[502141897]=Wi;var Eh=ct(class extends m{constructor(e){super(e)}},[0,[0,fe,-1,sh,ih],ph]),Qa=class extends m{constructor(e){super(e)}},e2=class extends m{constructor(e){super(e)}},zi=[0,j,W,[0,j],D],t2=[0,j,Wi,zi,W,[0,[0,Za]]],Ah=Le(508968150,e2);z[508968150]=t2,z[508968149]=zi;var s2=class extends m{constructor(e){super(e)}},Sh=Le(513916220,s2);z[513916220]=[0,j,t2,U];var vt=class extends m{constructor(e){super(e)}h(){return S(this,Hi,2)}g(){M(this,2)}},n2=[0,j,Ja];z[478825465]=n2;var kh=class extends m{constructor(e){super(e)}},i2=class extends m{constructor(e){super(e)}},Ki=class extends m{constructor(e){super(e)}},$i=class extends m{constructor(e){super(e)}},r2=class extends m{constructor(e){super(e)}},Jr=[0,j,[0,j],n2,-1],o2=[0,j,W,U],Xi=[0,j,W],a2=[0,j,o2,Xi,W],Th=Le(479097054,r2);z[479097054]=[0,j,a2,Jr],z[463370452]=Jr,z[464864288]=o2;var Fh=Le(462713202,$i);z[462713202]=a2,z[474472470]=Xi;var xh=class extends m{constructor(e){super(e)}},h2=class extends m{constructor(e){super(e)}},c2=class extends m{constructor(e){super(e)}},l2=class extends m{constructor(e){super(e)}},Yi=[0,j,W,-1,U],Zn=[0,j,W,D];l2.prototype.g=nn([0,j,Xi,[0,j],Wi,zi,Yi,Zn]);var u2=class extends m{constructor(e){super(e)}},Lh=Le(456383383,u2);z[456383383]=[0,j,Ja];var d2=class extends m{constructor(e){super(e)}},Mh=Le(476348187,d2);z[476348187]=[0,j,vh];var f2=class extends m{constructor(e){super(e)}},Zr=class extends m{constructor(e){super(e)}},p2=[0,fe,-1],Ch=Le(458105876,class extends m{constructor(e){super(e)}g(){var e=this.u;const t=0|e[w],s=2&t;return e=function(n,i,r){var o=Zr;const a=2&i;let h=!1;if(r==null){if(a)return Dr();r=[]}else if(r.constructor===Be){if(!(2&r.M)||a)return r;r=r.da()}else Array.isArray(r)?h=!!(2&(0|r[w])):r=[];if(a){if(!r.length)return Dr();h||(h=!0,Gt(r))}else h&&(h=!1,r=ha(r));return h||(64&(0|r[w])?r[w]&=-33:32&i&&Ns(r,32)),O(n,i,2,o=new Be(r,o,N1,void 0)),o}(e,t,Xe(e,t,2)),!s&&Zr&&(e.pa=!0),e}});z[458105876]=[0,p2,th,[!0,ot,[0,F,-1,Z]]];var qi=class extends m{constructor(e){super(e)}},m2=Le(458105758,qi);z[458105758]=[0,j,F,p2];var g2=class extends m{constructor(e){super(e)}},Ph=Le(443442058,g2);z[443442058]=[0,j,F,U,W,Z,-1,D,W],z[514774813]=Yi;var y2=class extends m{constructor(e){super(e)}},Ih=Le(516587230,y2);function Qn(e,t){return t=t?t.clone():new Hi,e.displayNamesLocale!==void 0?M(t,1,jt(e.displayNamesLocale)):e.displayNamesLocale===void 0&&M(t,1),e.maxResults!==void 0?Ne(t,2,e.maxResults):"maxResults"in e&&M(t,2),e.scoreThreshold!==void 0?g(t,3,e.scoreThreshold):"scoreThreshold"in e&&M(t,3),e.categoryAllowlist!==void 0?Cs(t,4,e.categoryAllowlist):"categoryAllowlist"in e&&M(t,4),e.categoryDenylist!==void 0?Cs(t,5,e.categoryDenylist):"categoryDenylist"in e&&M(t,5),t}function Ji(e,t=-1,s=""){return{categories:e.map(n=>({index:Ee(n,1)??0??-1,score:V(n,2)??0,categoryName:Ae(n,3)??""??"",displayName:Ae(n,4)??""??""})),headIndex:t,headName:s}}function b2(e){var o,a;var t=ft(e,3,ht,dt()),s=ft(e,2,Vt,dt()),n=ft(e,1,Pt,dt()),i=ft(e,9,Pt,dt());const r={categories:[],keypoints:[]};for(let h=0;h<t.length;h++)r.categories.push({score:t[h],index:s[h]??-1,categoryName:n[h]??"",displayName:i[h]??""});if((t=(o=S(e,In,4))==null?void 0:o.h())&&(r.boundingBox={originX:Ee(t,1)??0,originY:Ee(t,2)??0,width:Ee(t,3)??0,height:Ee(t,4)??0,angle:0}),(a=S(e,In,4))==null?void 0:a.g().length)for(const h of S(e,In,4).g())r.keypoints.push({x:As(h,1)??0,y:As(h,2)??0,score:As(h,4)??0,label:Ae(h,3)??""});return r}function an(e){const t=[];for(const s of Ke(e,Xa,1))t.push({x:V(s,1)??0,y:V(s,2)??0,z:V(s,3)??0,visibility:V(s,4)??0});return t}function ss(e){const t=[];for(const s of Ke(e,$a,1))t.push({x:V(s,1)??0,y:V(s,2)??0,z:V(s,3)??0,visibility:V(s,4)??0});return t}function Qr(e){return Array.from(e,t=>t>127?t-256:t)}function eo(e,t){if(e.length!==t.length)throw Error(`Cannot compute cosine similarity between embeddings of different sizes (${e.length} vs. ${t.length}).`);let s=0,n=0,i=0;for(let r=0;r<e.length;r++)s+=e[r]*t[r],n+=e[r]*e[r],i+=t[r]*t[r];if(n<=0||i<=0)throw Error("Cannot compute cosine similarity on embedding with 0 norm.");return s/Math.sqrt(n*i)}let ys;z[516587230]=[0,j,Yi,Zn,W],z[518928384]=Zn;const Dh=new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11]);async function w2(){if(ys===void 0)try{await WebAssembly.instantiate(Dh),ys=!0}catch{ys=!1}return ys}async function qt(e,t=ah``){const s=await w2()?"wasm_internal":"wasm_nosimd_internal";return{wasmLoaderPath:`${t}/${e}_${s}.js`,wasmBinaryPath:`${t}/${e}_${s}.wasm`}}var ut=class{};function v2(){var e=navigator;return typeof OffscreenCanvas<"u"&&(!function(t=navigator){return(t=t.userAgent).includes("Safari")&&!t.includes("Chrome")}(e)||!!((e=e.userAgent.match(/Version\/([\d]+).*Safari/))&&e.length>=1&&Number(e[1])>=17))}async function to(e){if(typeof importScripts!="function"){const t=document.createElement("script");return t.src=e.toString(),t.crossOrigin="anonymous",new Promise((s,n)=>{t.addEventListener("load",()=>{s()},!1),t.addEventListener("error",i=>{n(i)},!1),document.body.appendChild(t)})}importScripts(e.toString())}function _2(e){return e.videoWidth!==void 0?[e.videoWidth,e.videoHeight]:e.naturalWidth!==void 0?[e.naturalWidth,e.naturalHeight]:e.displayWidth!==void 0?[e.displayWidth,e.displayHeight]:[e.width,e.height]}function b(e,t,s){e.m||console.error("No wasm multistream support detected: ensure dependency inclusion of :gl_graph_runner_internal_multi_input target"),s(t=e.i.stringToNewUTF8(t)),e.i._free(t)}function so(e,t,s){if(!e.i.canvas)throw Error("No OpenGL canvas configured.");if(s?e.i._bindTextureToStream(s):e.i._bindTextureToCanvas(),!(s=e.i.canvas.getContext("webgl2")||e.i.canvas.getContext("webgl")))throw Error("Failed to obtain WebGL context from the provided canvas. `getContext()` should only be invoked with `webgl` or `webgl2`.");e.i.gpuOriginForWebTexturesIsBottomLeft&&s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,!0),s.texImage2D(s.TEXTURE_2D,0,s.RGBA,s.RGBA,s.UNSIGNED_BYTE,t),e.i.gpuOriginForWebTexturesIsBottomLeft&&s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,!1);const[n,i]=_2(t);return!e.l||n===e.i.canvas.width&&i===e.i.canvas.height||(e.i.canvas.width=n,e.i.canvas.height=i),[n,i]}function no(e,t,s){e.m||console.error("No wasm multistream support detected: ensure dependency inclusion of :gl_graph_runner_internal_multi_input target");const n=new Uint32Array(t.length);for(let i=0;i<t.length;i++)n[i]=e.i.stringToNewUTF8(t[i]);t=e.i._malloc(4*n.length),e.i.HEAPU32.set(n,t>>2),s(t);for(const i of n)e.i._free(i);e.i._free(t)}function Ie(e,t,s){e.i.simpleListeners=e.i.simpleListeners||{},e.i.simpleListeners[t]=s}function qe(e,t,s){let n=[];e.i.simpleListeners=e.i.simpleListeners||{},e.i.simpleListeners[t]=(i,r,o)=>{r?(s(n,o),n=[]):n.push(i)}}ut.forVisionTasks=function(e){return qt("vision",e)},ut.forTextTasks=function(e){return qt("text",e)},ut.forGenAiExperimentalTasks=function(e){return qt("genai_experimental",e)},ut.forGenAiTasks=function(e){return qt("genai",e)},ut.forAudioTasks=function(e){return qt("audio",e)},ut.isSimdSupported=function(){return w2()};async function Rh(e,t,s,n){return e=await(async(i,r,o,a,h)=>{if(r&&await to(r),!self.ModuleFactory||o&&(await to(o),!self.ModuleFactory))throw Error("ModuleFactory not set.");return self.Module&&h&&((r=self.Module).locateFile=h.locateFile,h.mainScriptUrlOrBlob&&(r.mainScriptUrlOrBlob=h.mainScriptUrlOrBlob)),h=await self.ModuleFactory(self.Module||h),self.ModuleFactory=self.Module=void 0,new i(h,a)})(e,s.wasmLoaderPath,s.assetLoaderPath,t,{locateFile:i=>i.endsWith(".wasm")?s.wasmBinaryPath.toString():s.assetBinaryPath&&i.endsWith(".data")?s.assetBinaryPath.toString():i}),await e.o(n),e}function Dn(e,t){const s=S(e.baseOptions,Is,1)||new Is;typeof t=="string"?(M(s,2,jt(t)),M(s,1)):t instanceof Uint8Array&&(M(s,1,fi(t,!1)),M(s,2)),v(e.baseOptions,0,1,s)}function io(e){try{const t=e.G.length;if(t===1)throw Error(e.G[0].message);if(t>1)throw Error("Encountered multiple errors: "+e.G.map(s=>s.message).join(", "))}finally{e.G=[]}}function f(e,t){e.B=Math.max(e.B,t)}function hn(e,t){e.A=new Q,ge(e.A,"PassThroughCalculator"),C(e.A,"free_memory"),A(e.A,"free_memory_unused_out"),P(t,"free_memory"),ye(t,e.A)}function Rt(e,t){C(e.A,t),A(e.A,t+"_unused_out")}function cn(e){e.g.addBoolToStream(!0,"free_memory",e.B)}var ei=class{constructor(e){this.g=e,this.G=[],this.B=0,this.g.setAutoRenderToScreen(!1)}l(e,t=!0){var s,n,i,r,o,a;if(t){const h=e.baseOptions||{};if((s=e.baseOptions)!=null&&s.modelAssetBuffer&&((n=e.baseOptions)!=null&&n.modelAssetPath))throw Error("Cannot set both baseOptions.modelAssetPath and baseOptions.modelAssetBuffer");if(!((i=S(this.baseOptions,Is,1))!=null&&i.g()||(r=S(this.baseOptions,Is,1))!=null&&r.h()||(o=e.baseOptions)!=null&&o.modelAssetBuffer||(a=e.baseOptions)!=null&&a.modelAssetPath))throw Error("Either baseOptions.modelAssetPath or baseOptions.modelAssetBuffer must be set");if(function(c,l){let u=S(c.baseOptions,qr,3);if(!u){var d=u=new qr,y=new Wr;es(d,4,ks,y)}"delegate"in l&&(l.delegate==="GPU"?(l=u,d=new hh,es(l,2,ks,d)):(l=u,d=new Wr,es(l,4,ks,d))),v(c.baseOptions,0,3,u)}(this,h),h.modelAssetPath)return fetch(h.modelAssetPath.toString()).then(c=>{if(c.ok)return c.arrayBuffer();throw Error(`Failed to fetch model: ${h.modelAssetPath} (${c.status})`)}).then(c=>{try{this.g.i.FS_unlink("/model.dat")}catch{}this.g.i.FS_createDataFile("/","model.dat",new Uint8Array(c),!0,!1,!1),Dn(this,"/model.dat"),this.m(),this.J()});if(h.modelAssetBuffer instanceof Uint8Array)Dn(this,h.modelAssetBuffer);else if(h.modelAssetBuffer)return async function(c){const l=[];for(var u=0;;){const{done:d,value:y}=await c.read();if(d)break;l.push(y),u+=y.length}if(l.length===0)return new Uint8Array(0);if(l.length===1)return l[0];c=new Uint8Array(u),u=0;for(const d of l)c.set(d,u),u+=d.length;return c}(h.modelAssetBuffer).then(c=>{Dn(this,c),this.m(),this.J()})}return this.m(),this.J(),Promise.resolve()}J(){}ca(){let e;if(this.g.ca(t=>{e=ch(t)}),!e)throw Error("Failed to retrieve CalculatorGraphConfig");return e}setGraph(e,t){this.g.attachErrorListener((s,n)=>{this.G.push(Error(n))}),this.g.Ha(),this.g.setGraph(e,t),this.A=void 0,io(this)}finishProcessing(){this.g.finishProcessing(),io(this)}close(){this.A=void 0,this.g.closeGraph()}};function ze(e,t){if(!e)throw Error(`Unable to obtain required WebGL resource: ${t}`);return e}ei.prototype.close=ei.prototype.close;class Oh{constructor(t,s,n,i){this.g=t,this.h=s,this.m=n,this.l=i}bind(){this.g.bindVertexArray(this.h)}close(){this.g.deleteVertexArray(this.h),this.g.deleteBuffer(this.m),this.g.deleteBuffer(this.l)}}function ro(e,t,s){const n=e.g;if(s=ze(n.createShader(s),"Failed to create WebGL shader"),n.shaderSource(s,t),n.compileShader(s),!n.getShaderParameter(s,n.COMPILE_STATUS))throw Error(`Could not compile WebGL shader: ${n.getShaderInfoLog(s)}`);return n.attachShader(e.h,s),s}function oo(e,t){const s=e.g,n=ze(s.createVertexArray(),"Failed to create vertex array");s.bindVertexArray(n);const i=ze(s.createBuffer(),"Failed to create buffer");s.bindBuffer(s.ARRAY_BUFFER,i),s.enableVertexAttribArray(e.P),s.vertexAttribPointer(e.P,2,s.FLOAT,!1,0,0),s.bufferData(s.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),s.STATIC_DRAW);const r=ze(s.createBuffer(),"Failed to create buffer");return s.bindBuffer(s.ARRAY_BUFFER,r),s.enableVertexAttribArray(e.J),s.vertexAttribPointer(e.J,2,s.FLOAT,!1,0,0),s.bufferData(s.ARRAY_BUFFER,new Float32Array(t?[0,1,0,0,1,0,1,1]:[0,0,0,1,1,1,1,0]),s.STATIC_DRAW),s.bindBuffer(s.ARRAY_BUFFER,null),s.bindVertexArray(null),new Oh(s,n,i,r)}function Zi(e,t){if(e.g){if(t!==e.g)throw Error("Cannot change GL context once initialized")}else e.g=t}function Qi(e,t,s,n){return Zi(e,t),e.h||(e.m(),e.C()),s?(e.s||(e.s=oo(e,!0)),s=e.s):(e.v||(e.v=oo(e,!1)),s=e.v),t.useProgram(e.h),s.bind(),e.l(),e=n(),s.g.bindVertexArray(null),e}function ln(e,t,s){return Zi(e,t),e=ze(t.createTexture(),"Failed to create texture"),t.bindTexture(t.TEXTURE_2D,e),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,s??t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,s??t.LINEAR),t.bindTexture(t.TEXTURE_2D,null),e}function un(e,t,s){Zi(e,t),e.A||(e.A=ze(t.createFramebuffer(),"Failed to create framebuffe.")),t.bindFramebuffer(t.FRAMEBUFFER,e.A),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,s,0)}function er(e){var t;(t=e.g)==null||t.bindFramebuffer(e.g.FRAMEBUFFER,null)}var tr=class{G(){return`
  precision mediump float;
  varying vec2 vTex;
  uniform sampler2D inputTexture;
  void main() {
    gl_FragColor = texture2D(inputTexture, vTex);
  }
 `}m(){const e=this.g;if(this.h=ze(e.createProgram(),"Failed to create WebGL program"),this.Z=ro(this,`
  attribute vec2 aVertex;
  attribute vec2 aTex;
  varying vec2 vTex;
  void main(void) {
    gl_Position = vec4(aVertex, 0.0, 1.0);
    vTex = aTex;
  }`,e.VERTEX_SHADER),this.Y=ro(this,this.G(),e.FRAGMENT_SHADER),e.linkProgram(this.h),!e.getProgramParameter(this.h,e.LINK_STATUS))throw Error(`Error during program linking: ${e.getProgramInfoLog(this.h)}`);this.P=e.getAttribLocation(this.h,"aVertex"),this.J=e.getAttribLocation(this.h,"aTex")}C(){}l(){}close(){if(this.h){const e=this.g;e.deleteProgram(this.h),e.deleteShader(this.Z),e.deleteShader(this.Y)}this.A&&this.g.deleteFramebuffer(this.A),this.v&&this.v.close(),this.s&&this.s.close()}};function Ve(e,t){switch(t){case 0:return e.g.find(s=>s instanceof Uint8Array);case 1:return e.g.find(s=>s instanceof Float32Array);case 2:return e.g.find(s=>typeof WebGLTexture<"u"&&s instanceof WebGLTexture);default:throw Error(`Type is not supported: ${t}`)}}function ti(e){var t=Ve(e,1);if(!t){if(t=Ve(e,0))t=new Float32Array(t).map(n=>n/255);else{t=new Float32Array(e.width*e.height);const n=Ot(e);var s=sr(e);if(un(s,n,E2(e)),"iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"document"in self&&"ontouchend"in self.document){s=new Float32Array(e.width*e.height*4),n.readPixels(0,0,e.width,e.height,n.RGBA,n.FLOAT,s);for(let i=0,r=0;i<t.length;++i,r+=4)t[i]=s[r]}else n.readPixels(0,0,e.width,e.height,n.RED,n.FLOAT,t)}e.g.push(t)}return t}function E2(e){let t=Ve(e,2);if(!t){const s=Ot(e);t=S2(e);const n=ti(e),i=A2(e);s.texImage2D(s.TEXTURE_2D,0,i,e.width,e.height,0,s.RED,s.FLOAT,n),si(e)}return t}function Ot(e){if(!e.canvas)throw Error("Conversion to different image formats require that a canvas is passed when initializing the image.");return e.h||(e.h=ze(e.canvas.getContext("webgl2"),"You cannot use a canvas that is already bound to a different type of rendering context.")),e.h}function A2(e){if(e=Ot(e),!bs)if(e.getExtension("EXT_color_buffer_float")&&e.getExtension("OES_texture_float_linear")&&e.getExtension("EXT_float_blend"))bs=e.R32F;else{if(!e.getExtension("EXT_color_buffer_half_float"))throw Error("GPU does not fully support 4-channel float32 or float16 formats");bs=e.R16F}return bs}function sr(e){return e.l||(e.l=new tr),e.l}function S2(e){const t=Ot(e);t.viewport(0,0,e.width,e.height),t.activeTexture(t.TEXTURE0);let s=Ve(e,2);return s||(s=ln(sr(e),t,e.m?t.LINEAR:t.NEAREST),e.g.push(s),e.j=!0),t.bindTexture(t.TEXTURE_2D,s),s}function si(e){e.h.bindTexture(e.h.TEXTURE_2D,null)}var bs,$=class{constructor(e,t,s,n,i,r,o){this.g=e,this.m=t,this.j=s,this.canvas=n,this.l=i,this.width=r,this.height=o,this.j&&--ao===0&&console.error("You seem to be creating MPMask instances without invoking .close(). This leaks resources.")}Da(){return!!Ve(this,0)}ja(){return!!Ve(this,1)}R(){return!!Ve(this,2)}ia(){return(t=Ve(e=this,0))||(t=ti(e),t=new Uint8Array(t.map(s=>255*s)),e.g.push(t)),t;var e,t}ha(){return ti(this)}N(){return E2(this)}clone(){const e=[];for(const t of this.g){let s;if(t instanceof Uint8Array)s=new Uint8Array(t);else if(t instanceof Float32Array)s=new Float32Array(t);else{if(!(t instanceof WebGLTexture))throw Error(`Type is not supported: ${t}`);{const n=Ot(this),i=sr(this);n.activeTexture(n.TEXTURE1),s=ln(i,n,this.m?n.LINEAR:n.NEAREST),n.bindTexture(n.TEXTURE_2D,s);const r=A2(this);n.texImage2D(n.TEXTURE_2D,0,r,this.width,this.height,0,n.RED,n.FLOAT,null),n.bindTexture(n.TEXTURE_2D,null),un(i,n,s),Qi(i,n,!1,()=>{S2(this),n.clearColor(0,0,0,0),n.clear(n.COLOR_BUFFER_BIT),n.drawArrays(n.TRIANGLE_FAN,0,4),si(this)}),er(i),si(this)}}e.push(s)}return new $(e,this.m,this.R(),this.canvas,this.l,this.width,this.height)}close(){this.j&&Ot(this).deleteTexture(Ve(this,2)),ao=-1}};$.prototype.close=$.prototype.close,$.prototype.clone=$.prototype.clone,$.prototype.getAsWebGLTexture=$.prototype.N,$.prototype.getAsFloat32Array=$.prototype.ha,$.prototype.getAsUint8Array=$.prototype.ia,$.prototype.hasWebGLTexture=$.prototype.R,$.prototype.hasFloat32Array=$.prototype.ja,$.prototype.hasUint8Array=$.prototype.Da;var ao=250;function Oe(e,t){switch(t){case 0:return e.g.find(s=>s instanceof ImageData);case 1:return e.g.find(s=>typeof ImageBitmap<"u"&&s instanceof ImageBitmap);case 2:return e.g.find(s=>typeof WebGLTexture<"u"&&s instanceof WebGLTexture);default:throw Error(`Type is not supported: ${t}`)}}function k2(e){var t=Oe(e,0);if(!t){t=Bt(e);const s=dn(e),n=new Uint8Array(e.width*e.height*4);un(s,t,Ts(e)),t.readPixels(0,0,e.width,e.height,t.RGBA,t.UNSIGNED_BYTE,n),er(s),t=new ImageData(new Uint8ClampedArray(n.buffer),e.width,e.height),e.g.push(t)}return t}function Ts(e){let t=Oe(e,2);if(!t){const s=Bt(e);t=Fs(e);const n=Oe(e,1)||k2(e);s.texImage2D(s.TEXTURE_2D,0,s.RGBA,s.RGBA,s.UNSIGNED_BYTE,n),Zt(e)}return t}function Bt(e){if(!e.canvas)throw Error("Conversion to different image formats require that a canvas is passed when initializing the image.");return e.h||(e.h=ze(e.canvas.getContext("webgl2"),"You cannot use a canvas that is already bound to a different type of rendering context.")),e.h}function dn(e){return e.l||(e.l=new tr),e.l}function Fs(e){const t=Bt(e);t.viewport(0,0,e.width,e.height),t.activeTexture(t.TEXTURE0);let s=Oe(e,2);return s||(s=ln(dn(e),t),e.g.push(s),e.m=!0),t.bindTexture(t.TEXTURE_2D,s),s}function Zt(e){e.h.bindTexture(e.h.TEXTURE_2D,null)}function ho(e){const t=Bt(e);return Qi(dn(e),t,!0,()=>function(s,n){const i=s.canvas;if(i.width===s.width&&i.height===s.height)return n();const r=i.width,o=i.height;return i.width=s.width,i.height=s.height,s=n(),i.width=r,i.height=o,s}(e,()=>{if(t.bindFramebuffer(t.FRAMEBUFFER,null),t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT),t.drawArrays(t.TRIANGLE_FAN,0,4),!(e.canvas instanceof OffscreenCanvas))throw Error("Conversion to ImageBitmap requires that the MediaPipe Tasks is initialized with an OffscreenCanvas");return e.canvas.transferToImageBitmap()}))}var X=class{constructor(e,t,s,n,i,r,o){this.g=e,this.j=t,this.m=s,this.canvas=n,this.l=i,this.width=r,this.height=o,(this.j||this.m)&&--co===0&&console.error("You seem to be creating MPImage instances without invoking .close(). This leaks resources.")}Ca(){return!!Oe(this,0)}ka(){return!!Oe(this,1)}R(){return!!Oe(this,2)}Aa(){return k2(this)}za(){var e=Oe(this,1);return e||(Ts(this),Fs(this),e=ho(this),Zt(this),this.g.push(e),this.j=!0),e}N(){return Ts(this)}clone(){const e=[];for(const t of this.g){let s;if(t instanceof ImageData)s=new ImageData(t.data,this.width,this.height);else if(t instanceof WebGLTexture){const n=Bt(this),i=dn(this);n.activeTexture(n.TEXTURE1),s=ln(i,n),n.bindTexture(n.TEXTURE_2D,s),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,this.width,this.height,0,n.RGBA,n.UNSIGNED_BYTE,null),n.bindTexture(n.TEXTURE_2D,null),un(i,n,s),Qi(i,n,!1,()=>{Fs(this),n.clearColor(0,0,0,0),n.clear(n.COLOR_BUFFER_BIT),n.drawArrays(n.TRIANGLE_FAN,0,4),Zt(this)}),er(i),Zt(this)}else{if(!(t instanceof ImageBitmap))throw Error(`Type is not supported: ${t}`);Ts(this),Fs(this),s=ho(this),Zt(this)}e.push(s)}return new X(e,this.ka(),this.R(),this.canvas,this.l,this.width,this.height)}close(){this.j&&Oe(this,1).close(),this.m&&Bt(this).deleteTexture(Oe(this,2)),co=-1}};X.prototype.close=X.prototype.close,X.prototype.clone=X.prototype.clone,X.prototype.getAsWebGLTexture=X.prototype.N,X.prototype.getAsImageBitmap=X.prototype.za,X.prototype.getAsImageData=X.prototype.Aa,X.prototype.hasWebGLTexture=X.prototype.R,X.prototype.hasImageBitmap=X.prototype.ka,X.prototype.hasImageData=X.prototype.Ca;var co=250;function Me(...e){return e.map(([t,s])=>({start:t,end:s}))}const Bh=function(e){return class extends e{Ha(){this.i._registerModelResourcesGraphService()}}}((lo=class{constructor(e,t){this.l=!0,this.i=e,this.g=null,this.h=0,this.m=typeof this.i._addIntToInputStream=="function",t!==void 0?this.i.canvas=t:v2()?this.i.canvas=new OffscreenCanvas(1,1):(console.warn("OffscreenCanvas not supported and GraphRunner constructor glCanvas parameter is undefined. Creating backup canvas."),this.i.canvas=document.createElement("canvas"))}async initializeGraph(e){const t=await(await fetch(e)).arrayBuffer();e=!(e.endsWith(".pbtxt")||e.endsWith(".textproto")),this.setGraph(new Uint8Array(t),e)}setGraphFromString(e){this.setGraph(new TextEncoder().encode(e),!1)}setGraph(e,t){const s=e.length,n=this.i._malloc(s);this.i.HEAPU8.set(e,n),t?this.i._changeBinaryGraph(s,n):this.i._changeTextGraph(s,n),this.i._free(n)}configureAudio(e,t,s,n,i){this.i._configureAudio||console.warn('Attempting to use configureAudio without support for input audio. Is build dep ":gl_graph_runner_audio" missing?'),b(this,n||"input_audio",r=>{b(this,i=i||"audio_header",o=>{this.i._configureAudio(r,o,e,t??0,s)})})}setAutoResizeCanvas(e){this.l=e}setAutoRenderToScreen(e){this.i._setAutoRenderToScreen(e)}setGpuBufferVerticalFlip(e){this.i.gpuOriginForWebTexturesIsBottomLeft=e}ca(e){Ie(this,"__graph_config__",t=>{e(t)}),b(this,"__graph_config__",t=>{this.i._getGraphConfig(t,void 0)}),delete this.i.simpleListeners.__graph_config__}attachErrorListener(e){this.i.errorListener=e}attachEmptyPacketListener(e,t){this.i.emptyPacketListeners=this.i.emptyPacketListeners||{},this.i.emptyPacketListeners[e]=t}addAudioToStream(e,t,s){this.addAudioToStreamWithShape(e,0,0,t,s)}addAudioToStreamWithShape(e,t,s,n,i){const r=4*e.length;this.h!==r&&(this.g&&this.i._free(this.g),this.g=this.i._malloc(r),this.h=r),this.i.HEAPF32.set(e,this.g/4),b(this,n,o=>{this.i._addAudioToInputStream(this.g,t,s,o,i)})}addGpuBufferToStream(e,t,s){b(this,t,n=>{const[i,r]=so(this,e,n);this.i._addBoundTextureToStream(n,i,r,s)})}addBoolToStream(e,t,s){b(this,t,n=>{this.i._addBoolToInputStream(e,n,s)})}addDoubleToStream(e,t,s){b(this,t,n=>{this.i._addDoubleToInputStream(e,n,s)})}addFloatToStream(e,t,s){b(this,t,n=>{this.i._addFloatToInputStream(e,n,s)})}addIntToStream(e,t,s){b(this,t,n=>{this.i._addIntToInputStream(e,n,s)})}addUintToStream(e,t,s){b(this,t,n=>{this.i._addUintToInputStream(e,n,s)})}addStringToStream(e,t,s){b(this,t,n=>{b(this,e,i=>{this.i._addStringToInputStream(i,n,s)})})}addStringRecordToStream(e,t,s){b(this,t,n=>{no(this,Object.keys(e),i=>{no(this,Object.values(e),r=>{this.i._addFlatHashMapToInputStream(i,r,Object.keys(e).length,n,s)})})})}addProtoToStream(e,t,s,n){b(this,s,i=>{b(this,t,r=>{const o=this.i._malloc(e.length);this.i.HEAPU8.set(e,o),this.i._addProtoToInputStream(o,e.length,r,i,n),this.i._free(o)})})}addEmptyPacketToStream(e,t){b(this,e,s=>{this.i._addEmptyPacketToInputStream(s,t)})}addBoolVectorToStream(e,t,s){b(this,t,n=>{const i=this.i._allocateBoolVector(e.length);if(!i)throw Error("Unable to allocate new bool vector on heap.");for(const r of e)this.i._addBoolVectorEntry(i,r);this.i._addBoolVectorToInputStream(i,n,s)})}addDoubleVectorToStream(e,t,s){b(this,t,n=>{const i=this.i._allocateDoubleVector(e.length);if(!i)throw Error("Unable to allocate new double vector on heap.");for(const r of e)this.i._addDoubleVectorEntry(i,r);this.i._addDoubleVectorToInputStream(i,n,s)})}addFloatVectorToStream(e,t,s){b(this,t,n=>{const i=this.i._allocateFloatVector(e.length);if(!i)throw Error("Unable to allocate new float vector on heap.");for(const r of e)this.i._addFloatVectorEntry(i,r);this.i._addFloatVectorToInputStream(i,n,s)})}addIntVectorToStream(e,t,s){b(this,t,n=>{const i=this.i._allocateIntVector(e.length);if(!i)throw Error("Unable to allocate new int vector on heap.");for(const r of e)this.i._addIntVectorEntry(i,r);this.i._addIntVectorToInputStream(i,n,s)})}addUintVectorToStream(e,t,s){b(this,t,n=>{const i=this.i._allocateUintVector(e.length);if(!i)throw Error("Unable to allocate new unsigned int vector on heap.");for(const r of e)this.i._addUintVectorEntry(i,r);this.i._addUintVectorToInputStream(i,n,s)})}addStringVectorToStream(e,t,s){b(this,t,n=>{const i=this.i._allocateStringVector(e.length);if(!i)throw Error("Unable to allocate new string vector on heap.");for(const r of e)b(this,r,o=>{this.i._addStringVectorEntry(i,o)});this.i._addStringVectorToInputStream(i,n,s)})}addBoolToInputSidePacket(e,t){b(this,t,s=>{this.i._addBoolToInputSidePacket(e,s)})}addDoubleToInputSidePacket(e,t){b(this,t,s=>{this.i._addDoubleToInputSidePacket(e,s)})}addFloatToInputSidePacket(e,t){b(this,t,s=>{this.i._addFloatToInputSidePacket(e,s)})}addIntToInputSidePacket(e,t){b(this,t,s=>{this.i._addIntToInputSidePacket(e,s)})}addUintToInputSidePacket(e,t){b(this,t,s=>{this.i._addUintToInputSidePacket(e,s)})}addStringToInputSidePacket(e,t){b(this,t,s=>{b(this,e,n=>{this.i._addStringToInputSidePacket(n,s)})})}addProtoToInputSidePacket(e,t,s){b(this,s,n=>{b(this,t,i=>{const r=this.i._malloc(e.length);this.i.HEAPU8.set(e,r),this.i._addProtoToInputSidePacket(r,e.length,i,n),this.i._free(r)})})}addBoolVectorToInputSidePacket(e,t){b(this,t,s=>{const n=this.i._allocateBoolVector(e.length);if(!n)throw Error("Unable to allocate new bool vector on heap.");for(const i of e)this.i._addBoolVectorEntry(n,i);this.i._addBoolVectorToInputSidePacket(n,s)})}addDoubleVectorToInputSidePacket(e,t){b(this,t,s=>{const n=this.i._allocateDoubleVector(e.length);if(!n)throw Error("Unable to allocate new double vector on heap.");for(const i of e)this.i._addDoubleVectorEntry(n,i);this.i._addDoubleVectorToInputSidePacket(n,s)})}addFloatVectorToInputSidePacket(e,t){b(this,t,s=>{const n=this.i._allocateFloatVector(e.length);if(!n)throw Error("Unable to allocate new float vector on heap.");for(const i of e)this.i._addFloatVectorEntry(n,i);this.i._addFloatVectorToInputSidePacket(n,s)})}addIntVectorToInputSidePacket(e,t){b(this,t,s=>{const n=this.i._allocateIntVector(e.length);if(!n)throw Error("Unable to allocate new int vector on heap.");for(const i of e)this.i._addIntVectorEntry(n,i);this.i._addIntVectorToInputSidePacket(n,s)})}addUintVectorToInputSidePacket(e,t){b(this,t,s=>{const n=this.i._allocateUintVector(e.length);if(!n)throw Error("Unable to allocate new unsigned int vector on heap.");for(const i of e)this.i._addUintVectorEntry(n,i);this.i._addUintVectorToInputSidePacket(n,s)})}addStringVectorToInputSidePacket(e,t){b(this,t,s=>{const n=this.i._allocateStringVector(e.length);if(!n)throw Error("Unable to allocate new string vector on heap.");for(const i of e)b(this,i,r=>{this.i._addStringVectorEntry(n,r)});this.i._addStringVectorToInputSidePacket(n,s)})}attachBoolListener(e,t){Ie(this,e,t),b(this,e,s=>{this.i._attachBoolListener(s)})}attachBoolVectorListener(e,t){qe(this,e,t),b(this,e,s=>{this.i._attachBoolVectorListener(s)})}attachIntListener(e,t){Ie(this,e,t),b(this,e,s=>{this.i._attachIntListener(s)})}attachIntVectorListener(e,t){qe(this,e,t),b(this,e,s=>{this.i._attachIntVectorListener(s)})}attachUintListener(e,t){Ie(this,e,t),b(this,e,s=>{this.i._attachUintListener(s)})}attachUintVectorListener(e,t){qe(this,e,t),b(this,e,s=>{this.i._attachUintVectorListener(s)})}attachDoubleListener(e,t){Ie(this,e,t),b(this,e,s=>{this.i._attachDoubleListener(s)})}attachDoubleVectorListener(e,t){qe(this,e,t),b(this,e,s=>{this.i._attachDoubleVectorListener(s)})}attachFloatListener(e,t){Ie(this,e,t),b(this,e,s=>{this.i._attachFloatListener(s)})}attachFloatVectorListener(e,t){qe(this,e,t),b(this,e,s=>{this.i._attachFloatVectorListener(s)})}attachStringListener(e,t){Ie(this,e,t),b(this,e,s=>{this.i._attachStringListener(s)})}attachStringVectorListener(e,t){qe(this,e,t),b(this,e,s=>{this.i._attachStringVectorListener(s)})}attachProtoListener(e,t,s){Ie(this,e,t),b(this,e,n=>{this.i._attachProtoListener(n,s||!1)})}attachProtoVectorListener(e,t,s){qe(this,e,t),b(this,e,n=>{this.i._attachProtoVectorListener(n,s||!1)})}attachAudioListener(e,t,s){this.i._attachAudioListener||console.warn('Attempting to use attachAudioListener without support for output audio. Is build dep ":gl_graph_runner_audio_out" missing?'),Ie(this,e,(n,i)=>{n=new Float32Array(n.buffer,n.byteOffset,n.length/4),t(n,i)}),b(this,e,n=>{this.i._attachAudioListener(n,s||!1)})}finishProcessing(){this.i._waitUntilIdle()}closeGraph(){this.i._closeGraph(),this.i.simpleListeners=void 0,this.i.emptyPacketListeners=void 0}},class extends lo{get ea(){return this.i}oa(e,t,s){b(this,t,n=>{const[i,r]=so(this,e,n);this.ea._addBoundTextureAsImageToStream(n,i,r,s)})}V(e,t){Ie(this,e,t),b(this,e,s=>{this.ea._attachImageListener(s)})}ba(e,t){qe(this,e,t),b(this,e,s=>{this.ea._attachImageVectorListener(s)})}}));var lo,Se=class extends Bh{};async function E(e,t,s){return async function(n,i,r,o){return Rh(n,i,r,o)}(e,s.canvas??(v2()?void 0:document.createElement("canvas")),t,s)}function T2(e,t,s,n){if(e.U){const r=new Ya;if(s!=null&&s.regionOfInterest){if(!e.na)throw Error("This task doesn't support region-of-interest.");var i=s.regionOfInterest;if(i.left>=i.right||i.top>=i.bottom)throw Error("Expected RectF with left < right and top < bottom.");if(i.left<0||i.top<0||i.right>1||i.bottom>1)throw Error("Expected RectF values to be in [0,1].");g(r,1,(i.left+i.right)/2),g(r,2,(i.top+i.bottom)/2),g(r,4,i.right-i.left),g(r,3,i.bottom-i.top)}else g(r,1,.5),g(r,2,.5),g(r,4,1),g(r,3,1);if(s!=null&&s.rotationDegrees){if((s==null?void 0:s.rotationDegrees)%90!=0)throw Error("Expected rotation to be a multiple of 90.");if(g(r,5,-Math.PI*s.rotationDegrees/180),(s==null?void 0:s.rotationDegrees)%180!=0){const[o,a]=_2(t);s=V(r,3)*a/o,i=V(r,4)*o/a,g(r,4,s),g(r,3,i)}}e.g.addProtoToStream(r.g(),"mediapipe.NormalizedRect",e.U,n)}e.g.oa(t,e.Z,n??performance.now()),e.finishProcessing()}function ke(e,t,s){var n;if((n=e.baseOptions)!=null&&n.g())throw Error("Task is not initialized with image mode. 'runningMode' must be set to 'IMAGE'.");T2(e,t,s,e.B+1)}function Ue(e,t,s,n){var i;if(!((i=e.baseOptions)!=null&&i.g()))throw Error("Task is not initialized with video mode. 'runningMode' must be set to 'VIDEO'.");T2(e,t,s,n)}function Nt(e,t,s,n){var i=t.data;const r=t.width,o=r*(t=t.height);if((i instanceof Uint8Array||i instanceof Float32Array)&&i.length!==o)throw Error("Unsupported channel count: "+i.length/o);return e=new $([i],s,!1,e.g.i.canvas,e.P,r,t),n?e.clone():e}var re=class extends ei{constructor(e,t,s,n){super(e),this.g=e,this.Z=t,this.U=s,this.na=n,this.P=new tr}l(e,t=!0){if("runningMode"in e&&as(this.baseOptions,2,!!e.runningMode&&e.runningMode!=="IMAGE"),e.canvas!==void 0&&this.g.i.canvas!==e.canvas)throw Error("You must create a new task to reset the canvas.");return super.l(e,t)}close(){this.P.close(),super.close()}};re.prototype.close=re.prototype.close;var be=class extends re{constructor(e,t){super(new Se(e,t),"image_in","norm_rect_in",!1),this.j={detections:[]},v(e=this.h=new on,0,1,t=new R),g(this.h,2,.5),g(this.h,3,.3)}get baseOptions(){return S(this.h,R,1)}set baseOptions(e){v(this.h,0,1,e)}o(e){return"minDetectionConfidence"in e&&g(this.h,2,e.minDetectionConfidence??.5),"minSuppressionThreshold"in e&&g(this.h,3,e.minSuppressionThreshold??.3),this.l(e)}D(e,t){return this.j={detections:[]},ke(this,e,t),this.j}F(e,t,s){return this.j={detections:[]},Ue(this,e,s,t),this.j}m(){var e=new oe;P(e,"image_in"),P(e,"norm_rect_in"),k(e,"detections");const t=new pe;Fe(t,_h,this.h);const s=new Q;ge(s,"mediapipe.tasks.vision.face_detector.FaceDetectorGraph"),C(s,"IMAGE:image_in"),C(s,"NORM_RECT:norm_rect_in"),A(s,"DETECTIONS:detections"),s.o(t),ye(e,s),this.g.attachProtoVectorListener("detections",(n,i)=>{for(const r of n)n=Ka(r),this.j.detections.push(b2(n));f(this,i)}),this.g.attachEmptyPacketListener("detections",n=>{f(this,n)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};be.prototype.detectForVideo=be.prototype.F,be.prototype.detect=be.prototype.D,be.prototype.setOptions=be.prototype.o,be.createFromModelPath=async function(e,t){return E(be,e,{baseOptions:{modelAssetPath:t}})},be.createFromModelBuffer=function(e,t){return E(be,e,{baseOptions:{modelAssetBuffer:t}})},be.createFromOptions=function(e,t){return E(be,e,t)};var nr=Me([61,146],[146,91],[91,181],[181,84],[84,17],[17,314],[314,405],[405,321],[321,375],[375,291],[61,185],[185,40],[40,39],[39,37],[37,0],[0,267],[267,269],[269,270],[270,409],[409,291],[78,95],[95,88],[88,178],[178,87],[87,14],[14,317],[317,402],[402,318],[318,324],[324,308],[78,191],[191,80],[80,81],[81,82],[82,13],[13,312],[312,311],[311,310],[310,415],[415,308]),ir=Me([263,249],[249,390],[390,373],[373,374],[374,380],[380,381],[381,382],[382,362],[263,466],[466,388],[388,387],[387,386],[386,385],[385,384],[384,398],[398,362]),rr=Me([276,283],[283,282],[282,295],[295,285],[300,293],[293,334],[334,296],[296,336]),F2=Me([474,475],[475,476],[476,477],[477,474]),or=Me([33,7],[7,163],[163,144],[144,145],[145,153],[153,154],[154,155],[155,133],[33,246],[246,161],[161,160],[160,159],[159,158],[158,157],[157,173],[173,133]),ar=Me([46,53],[53,52],[52,65],[65,55],[70,63],[63,105],[105,66],[66,107]),x2=Me([469,470],[470,471],[471,472],[472,469]),hr=Me([10,338],[338,297],[297,332],[332,284],[284,251],[251,389],[389,356],[356,454],[454,323],[323,361],[361,288],[288,397],[397,365],[365,379],[379,378],[378,400],[400,377],[377,152],[152,148],[148,176],[176,149],[149,150],[150,136],[136,172],[172,58],[58,132],[132,93],[93,234],[234,127],[127,162],[162,21],[21,54],[54,103],[103,67],[67,109],[109,10]),L2=[...nr,...ir,...rr,...or,...ar,...hr],M2=Me([127,34],[34,139],[139,127],[11,0],[0,37],[37,11],[232,231],[231,120],[120,232],[72,37],[37,39],[39,72],[128,121],[121,47],[47,128],[232,121],[121,128],[128,232],[104,69],[69,67],[67,104],[175,171],[171,148],[148,175],[118,50],[50,101],[101,118],[73,39],[39,40],[40,73],[9,151],[151,108],[108,9],[48,115],[115,131],[131,48],[194,204],[204,211],[211,194],[74,40],[40,185],[185,74],[80,42],[42,183],[183,80],[40,92],[92,186],[186,40],[230,229],[229,118],[118,230],[202,212],[212,214],[214,202],[83,18],[18,17],[17,83],[76,61],[61,146],[146,76],[160,29],[29,30],[30,160],[56,157],[157,173],[173,56],[106,204],[204,194],[194,106],[135,214],[214,192],[192,135],[203,165],[165,98],[98,203],[21,71],[71,68],[68,21],[51,45],[45,4],[4,51],[144,24],[24,23],[23,144],[77,146],[146,91],[91,77],[205,50],[50,187],[187,205],[201,200],[200,18],[18,201],[91,106],[106,182],[182,91],[90,91],[91,181],[181,90],[85,84],[84,17],[17,85],[206,203],[203,36],[36,206],[148,171],[171,140],[140,148],[92,40],[40,39],[39,92],[193,189],[189,244],[244,193],[159,158],[158,28],[28,159],[247,246],[246,161],[161,247],[236,3],[3,196],[196,236],[54,68],[68,104],[104,54],[193,168],[168,8],[8,193],[117,228],[228,31],[31,117],[189,193],[193,55],[55,189],[98,97],[97,99],[99,98],[126,47],[47,100],[100,126],[166,79],[79,218],[218,166],[155,154],[154,26],[26,155],[209,49],[49,131],[131,209],[135,136],[136,150],[150,135],[47,126],[126,217],[217,47],[223,52],[52,53],[53,223],[45,51],[51,134],[134,45],[211,170],[170,140],[140,211],[67,69],[69,108],[108,67],[43,106],[106,91],[91,43],[230,119],[119,120],[120,230],[226,130],[130,247],[247,226],[63,53],[53,52],[52,63],[238,20],[20,242],[242,238],[46,70],[70,156],[156,46],[78,62],[62,96],[96,78],[46,53],[53,63],[63,46],[143,34],[34,227],[227,143],[123,117],[117,111],[111,123],[44,125],[125,19],[19,44],[236,134],[134,51],[51,236],[216,206],[206,205],[205,216],[154,153],[153,22],[22,154],[39,37],[37,167],[167,39],[200,201],[201,208],[208,200],[36,142],[142,100],[100,36],[57,212],[212,202],[202,57],[20,60],[60,99],[99,20],[28,158],[158,157],[157,28],[35,226],[226,113],[113,35],[160,159],[159,27],[27,160],[204,202],[202,210],[210,204],[113,225],[225,46],[46,113],[43,202],[202,204],[204,43],[62,76],[76,77],[77,62],[137,123],[123,116],[116,137],[41,38],[38,72],[72,41],[203,129],[129,142],[142,203],[64,98],[98,240],[240,64],[49,102],[102,64],[64,49],[41,73],[73,74],[74,41],[212,216],[216,207],[207,212],[42,74],[74,184],[184,42],[169,170],[170,211],[211,169],[170,149],[149,176],[176,170],[105,66],[66,69],[69,105],[122,6],[6,168],[168,122],[123,147],[147,187],[187,123],[96,77],[77,90],[90,96],[65,55],[55,107],[107,65],[89,90],[90,180],[180,89],[101,100],[100,120],[120,101],[63,105],[105,104],[104,63],[93,137],[137,227],[227,93],[15,86],[86,85],[85,15],[129,102],[102,49],[49,129],[14,87],[87,86],[86,14],[55,8],[8,9],[9,55],[100,47],[47,121],[121,100],[145,23],[23,22],[22,145],[88,89],[89,179],[179,88],[6,122],[122,196],[196,6],[88,95],[95,96],[96,88],[138,172],[172,136],[136,138],[215,58],[58,172],[172,215],[115,48],[48,219],[219,115],[42,80],[80,81],[81,42],[195,3],[3,51],[51,195],[43,146],[146,61],[61,43],[171,175],[175,199],[199,171],[81,82],[82,38],[38,81],[53,46],[46,225],[225,53],[144,163],[163,110],[110,144],[52,65],[65,66],[66,52],[229,228],[228,117],[117,229],[34,127],[127,234],[234,34],[107,108],[108,69],[69,107],[109,108],[108,151],[151,109],[48,64],[64,235],[235,48],[62,78],[78,191],[191,62],[129,209],[209,126],[126,129],[111,35],[35,143],[143,111],[117,123],[123,50],[50,117],[222,65],[65,52],[52,222],[19,125],[125,141],[141,19],[221,55],[55,65],[65,221],[3,195],[195,197],[197,3],[25,7],[7,33],[33,25],[220,237],[237,44],[44,220],[70,71],[71,139],[139,70],[122,193],[193,245],[245,122],[247,130],[130,33],[33,247],[71,21],[21,162],[162,71],[170,169],[169,150],[150,170],[188,174],[174,196],[196,188],[216,186],[186,92],[92,216],[2,97],[97,167],[167,2],[141,125],[125,241],[241,141],[164,167],[167,37],[37,164],[72,38],[38,12],[12,72],[38,82],[82,13],[13,38],[63,68],[68,71],[71,63],[226,35],[35,111],[111,226],[101,50],[50,205],[205,101],[206,92],[92,165],[165,206],[209,198],[198,217],[217,209],[165,167],[167,97],[97,165],[220,115],[115,218],[218,220],[133,112],[112,243],[243,133],[239,238],[238,241],[241,239],[214,135],[135,169],[169,214],[190,173],[173,133],[133,190],[171,208],[208,32],[32,171],[125,44],[44,237],[237,125],[86,87],[87,178],[178,86],[85,86],[86,179],[179,85],[84,85],[85,180],[180,84],[83,84],[84,181],[181,83],[201,83],[83,182],[182,201],[137,93],[93,132],[132,137],[76,62],[62,183],[183,76],[61,76],[76,184],[184,61],[57,61],[61,185],[185,57],[212,57],[57,186],[186,212],[214,207],[207,187],[187,214],[34,143],[143,156],[156,34],[79,239],[239,237],[237,79],[123,137],[137,177],[177,123],[44,1],[1,4],[4,44],[201,194],[194,32],[32,201],[64,102],[102,129],[129,64],[213,215],[215,138],[138,213],[59,166],[166,219],[219,59],[242,99],[99,97],[97,242],[2,94],[94,141],[141,2],[75,59],[59,235],[235,75],[24,110],[110,228],[228,24],[25,130],[130,226],[226,25],[23,24],[24,229],[229,23],[22,23],[23,230],[230,22],[26,22],[22,231],[231,26],[112,26],[26,232],[232,112],[189,190],[190,243],[243,189],[221,56],[56,190],[190,221],[28,56],[56,221],[221,28],[27,28],[28,222],[222,27],[29,27],[27,223],[223,29],[30,29],[29,224],[224,30],[247,30],[30,225],[225,247],[238,79],[79,20],[20,238],[166,59],[59,75],[75,166],[60,75],[75,240],[240,60],[147,177],[177,215],[215,147],[20,79],[79,166],[166,20],[187,147],[147,213],[213,187],[112,233],[233,244],[244,112],[233,128],[128,245],[245,233],[128,114],[114,188],[188,128],[114,217],[217,174],[174,114],[131,115],[115,220],[220,131],[217,198],[198,236],[236,217],[198,131],[131,134],[134,198],[177,132],[132,58],[58,177],[143,35],[35,124],[124,143],[110,163],[163,7],[7,110],[228,110],[110,25],[25,228],[356,389],[389,368],[368,356],[11,302],[302,267],[267,11],[452,350],[350,349],[349,452],[302,303],[303,269],[269,302],[357,343],[343,277],[277,357],[452,453],[453,357],[357,452],[333,332],[332,297],[297,333],[175,152],[152,377],[377,175],[347,348],[348,330],[330,347],[303,304],[304,270],[270,303],[9,336],[336,337],[337,9],[278,279],[279,360],[360,278],[418,262],[262,431],[431,418],[304,408],[408,409],[409,304],[310,415],[415,407],[407,310],[270,409],[409,410],[410,270],[450,348],[348,347],[347,450],[422,430],[430,434],[434,422],[313,314],[314,17],[17,313],[306,307],[307,375],[375,306],[387,388],[388,260],[260,387],[286,414],[414,398],[398,286],[335,406],[406,418],[418,335],[364,367],[367,416],[416,364],[423,358],[358,327],[327,423],[251,284],[284,298],[298,251],[281,5],[5,4],[4,281],[373,374],[374,253],[253,373],[307,320],[320,321],[321,307],[425,427],[427,411],[411,425],[421,313],[313,18],[18,421],[321,405],[405,406],[406,321],[320,404],[404,405],[405,320],[315,16],[16,17],[17,315],[426,425],[425,266],[266,426],[377,400],[400,369],[369,377],[322,391],[391,269],[269,322],[417,465],[465,464],[464,417],[386,257],[257,258],[258,386],[466,260],[260,388],[388,466],[456,399],[399,419],[419,456],[284,332],[332,333],[333,284],[417,285],[285,8],[8,417],[346,340],[340,261],[261,346],[413,441],[441,285],[285,413],[327,460],[460,328],[328,327],[355,371],[371,329],[329,355],[392,439],[439,438],[438,392],[382,341],[341,256],[256,382],[429,420],[420,360],[360,429],[364,394],[394,379],[379,364],[277,343],[343,437],[437,277],[443,444],[444,283],[283,443],[275,440],[440,363],[363,275],[431,262],[262,369],[369,431],[297,338],[338,337],[337,297],[273,375],[375,321],[321,273],[450,451],[451,349],[349,450],[446,342],[342,467],[467,446],[293,334],[334,282],[282,293],[458,461],[461,462],[462,458],[276,353],[353,383],[383,276],[308,324],[324,325],[325,308],[276,300],[300,293],[293,276],[372,345],[345,447],[447,372],[352,345],[345,340],[340,352],[274,1],[1,19],[19,274],[456,248],[248,281],[281,456],[436,427],[427,425],[425,436],[381,256],[256,252],[252,381],[269,391],[391,393],[393,269],[200,199],[199,428],[428,200],[266,330],[330,329],[329,266],[287,273],[273,422],[422,287],[250,462],[462,328],[328,250],[258,286],[286,384],[384,258],[265,353],[353,342],[342,265],[387,259],[259,257],[257,387],[424,431],[431,430],[430,424],[342,353],[353,276],[276,342],[273,335],[335,424],[424,273],[292,325],[325,307],[307,292],[366,447],[447,345],[345,366],[271,303],[303,302],[302,271],[423,266],[266,371],[371,423],[294,455],[455,460],[460,294],[279,278],[278,294],[294,279],[271,272],[272,304],[304,271],[432,434],[434,427],[427,432],[272,407],[407,408],[408,272],[394,430],[430,431],[431,394],[395,369],[369,400],[400,395],[334,333],[333,299],[299,334],[351,417],[417,168],[168,351],[352,280],[280,411],[411,352],[325,319],[319,320],[320,325],[295,296],[296,336],[336,295],[319,403],[403,404],[404,319],[330,348],[348,349],[349,330],[293,298],[298,333],[333,293],[323,454],[454,447],[447,323],[15,16],[16,315],[315,15],[358,429],[429,279],[279,358],[14,15],[15,316],[316,14],[285,336],[336,9],[9,285],[329,349],[349,350],[350,329],[374,380],[380,252],[252,374],[318,402],[402,403],[403,318],[6,197],[197,419],[419,6],[318,319],[319,325],[325,318],[367,364],[364,365],[365,367],[435,367],[367,397],[397,435],[344,438],[438,439],[439,344],[272,271],[271,311],[311,272],[195,5],[5,281],[281,195],[273,287],[287,291],[291,273],[396,428],[428,199],[199,396],[311,271],[271,268],[268,311],[283,444],[444,445],[445,283],[373,254],[254,339],[339,373],[282,334],[334,296],[296,282],[449,347],[347,346],[346,449],[264,447],[447,454],[454,264],[336,296],[296,299],[299,336],[338,10],[10,151],[151,338],[278,439],[439,455],[455,278],[292,407],[407,415],[415,292],[358,371],[371,355],[355,358],[340,345],[345,372],[372,340],[346,347],[347,280],[280,346],[442,443],[443,282],[282,442],[19,94],[94,370],[370,19],[441,442],[442,295],[295,441],[248,419],[419,197],[197,248],[263,255],[255,359],[359,263],[440,275],[275,274],[274,440],[300,383],[383,368],[368,300],[351,412],[412,465],[465,351],[263,467],[467,466],[466,263],[301,368],[368,389],[389,301],[395,378],[378,379],[379,395],[412,351],[351,419],[419,412],[436,426],[426,322],[322,436],[2,164],[164,393],[393,2],[370,462],[462,461],[461,370],[164,0],[0,267],[267,164],[302,11],[11,12],[12,302],[268,12],[12,13],[13,268],[293,300],[300,301],[301,293],[446,261],[261,340],[340,446],[330,266],[266,425],[425,330],[426,423],[423,391],[391,426],[429,355],[355,437],[437,429],[391,327],[327,326],[326,391],[440,457],[457,438],[438,440],[341,382],[382,362],[362,341],[459,457],[457,461],[461,459],[434,430],[430,394],[394,434],[414,463],[463,362],[362,414],[396,369],[369,262],[262,396],[354,461],[461,457],[457,354],[316,403],[403,402],[402,316],[315,404],[404,403],[403,315],[314,405],[405,404],[404,314],[313,406],[406,405],[405,313],[421,418],[418,406],[406,421],[366,401],[401,361],[361,366],[306,408],[408,407],[407,306],[291,409],[409,408],[408,291],[287,410],[410,409],[409,287],[432,436],[436,410],[410,432],[434,416],[416,411],[411,434],[264,368],[368,383],[383,264],[309,438],[438,457],[457,309],[352,376],[376,401],[401,352],[274,275],[275,4],[4,274],[421,428],[428,262],[262,421],[294,327],[327,358],[358,294],[433,416],[416,367],[367,433],[289,455],[455,439],[439,289],[462,370],[370,326],[326,462],[2,326],[326,370],[370,2],[305,460],[460,455],[455,305],[254,449],[449,448],[448,254],[255,261],[261,446],[446,255],[253,450],[450,449],[449,253],[252,451],[451,450],[450,252],[256,452],[452,451],[451,256],[341,453],[453,452],[452,341],[413,464],[464,463],[463,413],[441,413],[413,414],[414,441],[258,442],[442,441],[441,258],[257,443],[443,442],[442,257],[259,444],[444,443],[443,259],[260,445],[445,444],[444,260],[467,342],[342,445],[445,467],[459,458],[458,250],[250,459],[289,392],[392,290],[290,289],[290,328],[328,460],[460,290],[376,433],[433,435],[435,376],[250,290],[290,392],[392,250],[411,416],[416,433],[433,411],[341,463],[463,464],[464,341],[453,464],[464,465],[465,453],[357,465],[465,412],[412,357],[343,412],[412,399],[399,343],[360,363],[363,440],[440,360],[437,399],[399,456],[456,437],[420,456],[456,363],[363,420],[401,435],[435,288],[288,401],[372,383],[383,353],[353,372],[339,255],[255,249],[249,339],[448,261],[261,255],[255,448],[133,243],[243,190],[190,133],[133,155],[155,112],[112,133],[33,246],[246,247],[247,33],[33,130],[130,25],[25,33],[398,384],[384,286],[286,398],[362,398],[398,414],[414,362],[362,463],[463,341],[341,362],[263,359],[359,467],[467,263],[263,249],[249,255],[255,263],[466,467],[467,260],[260,466],[75,60],[60,166],[166,75],[238,239],[239,79],[79,238],[162,127],[127,139],[139,162],[72,11],[11,37],[37,72],[121,232],[232,120],[120,121],[73,72],[72,39],[39,73],[114,128],[128,47],[47,114],[233,232],[232,128],[128,233],[103,104],[104,67],[67,103],[152,175],[175,148],[148,152],[119,118],[118,101],[101,119],[74,73],[73,40],[40,74],[107,9],[9,108],[108,107],[49,48],[48,131],[131,49],[32,194],[194,211],[211,32],[184,74],[74,185],[185,184],[191,80],[80,183],[183,191],[185,40],[40,186],[186,185],[119,230],[230,118],[118,119],[210,202],[202,214],[214,210],[84,83],[83,17],[17,84],[77,76],[76,146],[146,77],[161,160],[160,30],[30,161],[190,56],[56,173],[173,190],[182,106],[106,194],[194,182],[138,135],[135,192],[192,138],[129,203],[203,98],[98,129],[54,21],[21,68],[68,54],[5,51],[51,4],[4,5],[145,144],[144,23],[23,145],[90,77],[77,91],[91,90],[207,205],[205,187],[187,207],[83,201],[201,18],[18,83],[181,91],[91,182],[182,181],[180,90],[90,181],[181,180],[16,85],[85,17],[17,16],[205,206],[206,36],[36,205],[176,148],[148,140],[140,176],[165,92],[92,39],[39,165],[245,193],[193,244],[244,245],[27,159],[159,28],[28,27],[30,247],[247,161],[161,30],[174,236],[236,196],[196,174],[103,54],[54,104],[104,103],[55,193],[193,8],[8,55],[111,117],[117,31],[31,111],[221,189],[189,55],[55,221],[240,98],[98,99],[99,240],[142,126],[126,100],[100,142],[219,166],[166,218],[218,219],[112,155],[155,26],[26,112],[198,209],[209,131],[131,198],[169,135],[135,150],[150,169],[114,47],[47,217],[217,114],[224,223],[223,53],[53,224],[220,45],[45,134],[134,220],[32,211],[211,140],[140,32],[109,67],[67,108],[108,109],[146,43],[43,91],[91,146],[231,230],[230,120],[120,231],[113,226],[226,247],[247,113],[105,63],[63,52],[52,105],[241,238],[238,242],[242,241],[124,46],[46,156],[156,124],[95,78],[78,96],[96,95],[70,46],[46,63],[63,70],[116,143],[143,227],[227,116],[116,123],[123,111],[111,116],[1,44],[44,19],[19,1],[3,236],[236,51],[51,3],[207,216],[216,205],[205,207],[26,154],[154,22],[22,26],[165,39],[39,167],[167,165],[199,200],[200,208],[208,199],[101,36],[36,100],[100,101],[43,57],[57,202],[202,43],[242,20],[20,99],[99,242],[56,28],[28,157],[157,56],[124,35],[35,113],[113,124],[29,160],[160,27],[27,29],[211,204],[204,210],[210,211],[124,113],[113,46],[46,124],[106,43],[43,204],[204,106],[96,62],[62,77],[77,96],[227,137],[137,116],[116,227],[73,41],[41,72],[72,73],[36,203],[203,142],[142,36],[235,64],[64,240],[240,235],[48,49],[49,64],[64,48],[42,41],[41,74],[74,42],[214,212],[212,207],[207,214],[183,42],[42,184],[184,183],[210,169],[169,211],[211,210],[140,170],[170,176],[176,140],[104,105],[105,69],[69,104],[193,122],[122,168],[168,193],[50,123],[123,187],[187,50],[89,96],[96,90],[90,89],[66,65],[65,107],[107,66],[179,89],[89,180],[180,179],[119,101],[101,120],[120,119],[68,63],[63,104],[104,68],[234,93],[93,227],[227,234],[16,15],[15,85],[85,16],[209,129],[129,49],[49,209],[15,14],[14,86],[86,15],[107,55],[55,9],[9,107],[120,100],[100,121],[121,120],[153,145],[145,22],[22,153],[178,88],[88,179],[179,178],[197,6],[6,196],[196,197],[89,88],[88,96],[96,89],[135,138],[138,136],[136,135],[138,215],[215,172],[172,138],[218,115],[115,219],[219,218],[41,42],[42,81],[81,41],[5,195],[195,51],[51,5],[57,43],[43,61],[61,57],[208,171],[171,199],[199,208],[41,81],[81,38],[38,41],[224,53],[53,225],[225,224],[24,144],[144,110],[110,24],[105,52],[52,66],[66,105],[118,229],[229,117],[117,118],[227,34],[34,234],[234,227],[66,107],[107,69],[69,66],[10,109],[109,151],[151,10],[219,48],[48,235],[235,219],[183,62],[62,191],[191,183],[142,129],[129,126],[126,142],[116,111],[111,143],[143,116],[118,117],[117,50],[50,118],[223,222],[222,52],[52,223],[94,19],[19,141],[141,94],[222,221],[221,65],[65,222],[196,3],[3,197],[197,196],[45,220],[220,44],[44,45],[156,70],[70,139],[139,156],[188,122],[122,245],[245,188],[139,71],[71,162],[162,139],[149,170],[170,150],[150,149],[122,188],[188,196],[196,122],[206,216],[216,92],[92,206],[164,2],[2,167],[167,164],[242,141],[141,241],[241,242],[0,164],[164,37],[37,0],[11,72],[72,12],[12,11],[12,38],[38,13],[13,12],[70,63],[63,71],[71,70],[31,226],[226,111],[111,31],[36,101],[101,205],[205,36],[203,206],[206,165],[165,203],[126,209],[209,217],[217,126],[98,165],[165,97],[97,98],[237,220],[220,218],[218,237],[237,239],[239,241],[241,237],[210,214],[214,169],[169,210],[140,171],[171,32],[32,140],[241,125],[125,237],[237,241],[179,86],[86,178],[178,179],[180,85],[85,179],[179,180],[181,84],[84,180],[180,181],[182,83],[83,181],[181,182],[194,201],[201,182],[182,194],[177,137],[137,132],[132,177],[184,76],[76,183],[183,184],[185,61],[61,184],[184,185],[186,57],[57,185],[185,186],[216,212],[212,186],[186,216],[192,214],[214,187],[187,192],[139,34],[34,156],[156,139],[218,79],[79,237],[237,218],[147,123],[123,177],[177,147],[45,44],[44,4],[4,45],[208,201],[201,32],[32,208],[98,64],[64,129],[129,98],[192,213],[213,138],[138,192],[235,59],[59,219],[219,235],[141,242],[242,97],[97,141],[97,2],[2,141],[141,97],[240,75],[75,235],[235,240],[229,24],[24,228],[228,229],[31,25],[25,226],[226,31],[230,23],[23,229],[229,230],[231,22],[22,230],[230,231],[232,26],[26,231],[231,232],[233,112],[112,232],[232,233],[244,189],[189,243],[243,244],[189,221],[221,190],[190,189],[222,28],[28,221],[221,222],[223,27],[27,222],[222,223],[224,29],[29,223],[223,224],[225,30],[30,224],[224,225],[113,247],[247,225],[225,113],[99,60],[60,240],[240,99],[213,147],[147,215],[215,213],[60,20],[20,166],[166,60],[192,187],[187,213],[213,192],[243,112],[112,244],[244,243],[244,233],[233,245],[245,244],[245,128],[128,188],[188,245],[188,114],[114,174],[174,188],[134,131],[131,220],[220,134],[174,217],[217,236],[236,174],[236,198],[198,134],[134,236],[215,177],[177,58],[58,215],[156,143],[143,124],[124,156],[25,110],[110,7],[7,25],[31,228],[228,25],[25,31],[264,356],[356,368],[368,264],[0,11],[11,267],[267,0],[451,452],[452,349],[349,451],[267,302],[302,269],[269,267],[350,357],[357,277],[277,350],[350,452],[452,357],[357,350],[299,333],[333,297],[297,299],[396,175],[175,377],[377,396],[280,347],[347,330],[330,280],[269,303],[303,270],[270,269],[151,9],[9,337],[337,151],[344,278],[278,360],[360,344],[424,418],[418,431],[431,424],[270,304],[304,409],[409,270],[272,310],[310,407],[407,272],[322,270],[270,410],[410,322],[449,450],[450,347],[347,449],[432,422],[422,434],[434,432],[18,313],[313,17],[17,18],[291,306],[306,375],[375,291],[259,387],[387,260],[260,259],[424,335],[335,418],[418,424],[434,364],[364,416],[416,434],[391,423],[423,327],[327,391],[301,251],[251,298],[298,301],[275,281],[281,4],[4,275],[254,373],[373,253],[253,254],[375,307],[307,321],[321,375],[280,425],[425,411],[411,280],[200,421],[421,18],[18,200],[335,321],[321,406],[406,335],[321,320],[320,405],[405,321],[314,315],[315,17],[17,314],[423,426],[426,266],[266,423],[396,377],[377,369],[369,396],[270,322],[322,269],[269,270],[413,417],[417,464],[464,413],[385,386],[386,258],[258,385],[248,456],[456,419],[419,248],[298,284],[284,333],[333,298],[168,417],[417,8],[8,168],[448,346],[346,261],[261,448],[417,413],[413,285],[285,417],[326,327],[327,328],[328,326],[277,355],[355,329],[329,277],[309,392],[392,438],[438,309],[381,382],[382,256],[256,381],[279,429],[429,360],[360,279],[365,364],[364,379],[379,365],[355,277],[277,437],[437,355],[282,443],[443,283],[283,282],[281,275],[275,363],[363,281],[395,431],[431,369],[369,395],[299,297],[297,337],[337,299],[335,273],[273,321],[321,335],[348,450],[450,349],[349,348],[359,446],[446,467],[467,359],[283,293],[293,282],[282,283],[250,458],[458,462],[462,250],[300,276],[276,383],[383,300],[292,308],[308,325],[325,292],[283,276],[276,293],[293,283],[264,372],[372,447],[447,264],[346,352],[352,340],[340,346],[354,274],[274,19],[19,354],[363,456],[456,281],[281,363],[426,436],[436,425],[425,426],[380,381],[381,252],[252,380],[267,269],[269,393],[393,267],[421,200],[200,428],[428,421],[371,266],[266,329],[329,371],[432,287],[287,422],[422,432],[290,250],[250,328],[328,290],[385,258],[258,384],[384,385],[446,265],[265,342],[342,446],[386,387],[387,257],[257,386],[422,424],[424,430],[430,422],[445,342],[342,276],[276,445],[422,273],[273,424],[424,422],[306,292],[292,307],[307,306],[352,366],[366,345],[345,352],[268,271],[271,302],[302,268],[358,423],[423,371],[371,358],[327,294],[294,460],[460,327],[331,279],[279,294],[294,331],[303,271],[271,304],[304,303],[436,432],[432,427],[427,436],[304,272],[272,408],[408,304],[395,394],[394,431],[431,395],[378,395],[395,400],[400,378],[296,334],[334,299],[299,296],[6,351],[351,168],[168,6],[376,352],[352,411],[411,376],[307,325],[325,320],[320,307],[285,295],[295,336],[336,285],[320,319],[319,404],[404,320],[329,330],[330,349],[349,329],[334,293],[293,333],[333,334],[366,323],[323,447],[447,366],[316,15],[15,315],[315,316],[331,358],[358,279],[279,331],[317,14],[14,316],[316,317],[8,285],[285,9],[9,8],[277,329],[329,350],[350,277],[253,374],[374,252],[252,253],[319,318],[318,403],[403,319],[351,6],[6,419],[419,351],[324,318],[318,325],[325,324],[397,367],[367,365],[365,397],[288,435],[435,397],[397,288],[278,344],[344,439],[439,278],[310,272],[272,311],[311,310],[248,195],[195,281],[281,248],[375,273],[273,291],[291,375],[175,396],[396,199],[199,175],[312,311],[311,268],[268,312],[276,283],[283,445],[445,276],[390,373],[373,339],[339,390],[295,282],[282,296],[296,295],[448,449],[449,346],[346,448],[356,264],[264,454],[454,356],[337,336],[336,299],[299,337],[337,338],[338,151],[151,337],[294,278],[278,455],[455,294],[308,292],[292,415],[415,308],[429,358],[358,355],[355,429],[265,340],[340,372],[372,265],[352,346],[346,280],[280,352],[295,442],[442,282],[282,295],[354,19],[19,370],[370,354],[285,441],[441,295],[295,285],[195,248],[248,197],[197,195],[457,440],[440,274],[274,457],[301,300],[300,368],[368,301],[417,351],[351,465],[465,417],[251,301],[301,389],[389,251],[394,395],[395,379],[379,394],[399,412],[412,419],[419,399],[410,436],[436,322],[322,410],[326,2],[2,393],[393,326],[354,370],[370,461],[461,354],[393,164],[164,267],[267,393],[268,302],[302,12],[12,268],[312,268],[268,13],[13,312],[298,293],[293,301],[301,298],[265,446],[446,340],[340,265],[280,330],[330,425],[425,280],[322,426],[426,391],[391,322],[420,429],[429,437],[437,420],[393,391],[391,326],[326,393],[344,440],[440,438],[438,344],[458,459],[459,461],[461,458],[364,434],[434,394],[394,364],[428,396],[396,262],[262,428],[274,354],[354,457],[457,274],[317,316],[316,402],[402,317],[316,315],[315,403],[403,316],[315,314],[314,404],[404,315],[314,313],[313,405],[405,314],[313,421],[421,406],[406,313],[323,366],[366,361],[361,323],[292,306],[306,407],[407,292],[306,291],[291,408],[408,306],[291,287],[287,409],[409,291],[287,432],[432,410],[410,287],[427,434],[434,411],[411,427],[372,264],[264,383],[383,372],[459,309],[309,457],[457,459],[366,352],[352,401],[401,366],[1,274],[274,4],[4,1],[418,421],[421,262],[262,418],[331,294],[294,358],[358,331],[435,433],[433,367],[367,435],[392,289],[289,439],[439,392],[328,462],[462,326],[326,328],[94,2],[2,370],[370,94],[289,305],[305,455],[455,289],[339,254],[254,448],[448,339],[359,255],[255,446],[446,359],[254,253],[253,449],[449,254],[253,252],[252,450],[450,253],[252,256],[256,451],[451,252],[256,341],[341,452],[452,256],[414,413],[413,463],[463,414],[286,441],[441,414],[414,286],[286,258],[258,441],[441,286],[258,257],[257,442],[442,258],[257,259],[259,443],[443,257],[259,260],[260,444],[444,259],[260,467],[467,445],[445,260],[309,459],[459,250],[250,309],[305,289],[289,290],[290,305],[305,290],[290,460],[460,305],[401,376],[376,435],[435,401],[309,250],[250,392],[392,309],[376,411],[411,433],[433,376],[453,341],[341,464],[464,453],[357,453],[453,465],[465,357],[343,357],[357,412],[412,343],[437,343],[343,399],[399,437],[344,360],[360,440],[440,344],[420,437],[437,456],[456,420],[360,420],[420,363],[363,360],[361,401],[401,288],[288,361],[265,372],[372,353],[353,265],[390,339],[339,249],[249,390],[339,448],[448,255],[255,339]);function uo(e){e.j={faceLandmarks:[],faceBlendshapes:[],facialTransformationMatrixes:[]}}var B=class extends re{constructor(e,t){super(new Se(e,t),"image_in","norm_rect",!1),this.j={faceLandmarks:[],faceBlendshapes:[],facialTransformationMatrixes:[]},this.outputFacialTransformationMatrixes=this.outputFaceBlendshapes=!1,v(e=this.h=new e2,0,1,t=new R),this.v=new Qa,v(this.h,0,3,this.v),this.s=new on,v(this.h,0,2,this.s),Ne(this.s,4,1),g(this.s,2,.5),g(this.v,2,.5),g(this.h,4,.5)}get baseOptions(){return S(this.h,R,1)}set baseOptions(e){v(this.h,0,1,e)}o(e){return"numFaces"in e&&Ne(this.s,4,e.numFaces??1),"minFaceDetectionConfidence"in e&&g(this.s,2,e.minFaceDetectionConfidence??.5),"minTrackingConfidence"in e&&g(this.h,4,e.minTrackingConfidence??.5),"minFacePresenceConfidence"in e&&g(this.v,2,e.minFacePresenceConfidence??.5),"outputFaceBlendshapes"in e&&(this.outputFaceBlendshapes=!!e.outputFaceBlendshapes),"outputFacialTransformationMatrixes"in e&&(this.outputFacialTransformationMatrixes=!!e.outputFacialTransformationMatrixes),this.l(e)}D(e,t){return uo(this),ke(this,e,t),this.j}F(e,t,s){return uo(this),Ue(this,e,s,t),this.j}m(){var e=new oe;P(e,"image_in"),P(e,"norm_rect"),k(e,"face_landmarks");const t=new pe;Fe(t,Ah,this.h);const s=new Q;ge(s,"mediapipe.tasks.vision.face_landmarker.FaceLandmarkerGraph"),C(s,"IMAGE:image_in"),C(s,"NORM_RECT:norm_rect"),A(s,"NORM_LANDMARKS:face_landmarks"),s.o(t),ye(e,s),this.g.attachProtoVectorListener("face_landmarks",(n,i)=>{for(const r of n)n=ds(r),this.j.faceLandmarks.push(an(n));f(this,i)}),this.g.attachEmptyPacketListener("face_landmarks",n=>{f(this,n)}),this.outputFaceBlendshapes&&(k(e,"blendshapes"),A(s,"BLENDSHAPES:blendshapes"),this.g.attachProtoVectorListener("blendshapes",(n,i)=>{if(this.outputFaceBlendshapes)for(const r of n)n=rn(r),this.j.faceBlendshapes.push(Ji(n.g()??[]));f(this,i)}),this.g.attachEmptyPacketListener("blendshapes",n=>{f(this,n)})),this.outputFacialTransformationMatrixes&&(k(e,"face_geometry"),A(s,"FACE_GEOMETRY:face_geometry"),this.g.attachProtoVectorListener("face_geometry",(n,i)=>{if(this.outputFacialTransformationMatrixes)for(const r of n)(n=S(Eh(r),fh,2))&&this.j.facialTransformationMatrixes.push({rows:Ee(n,1)??0??0,columns:Ee(n,2)??0??0,data:ft(n,3,ht,dt()).slice()??[]});f(this,i)}),this.g.attachEmptyPacketListener("face_geometry",n=>{f(this,n)})),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};B.prototype.detectForVideo=B.prototype.F,B.prototype.detect=B.prototype.D,B.prototype.setOptions=B.prototype.o,B.createFromModelPath=function(e,t){return E(B,e,{baseOptions:{modelAssetPath:t}})},B.createFromModelBuffer=function(e,t){return E(B,e,{baseOptions:{modelAssetBuffer:t}})},B.createFromOptions=function(e,t){return E(B,e,t)},B.FACE_LANDMARKS_LIPS=nr,B.FACE_LANDMARKS_LEFT_EYE=ir,B.FACE_LANDMARKS_LEFT_EYEBROW=rr,B.FACE_LANDMARKS_LEFT_IRIS=F2,B.FACE_LANDMARKS_RIGHT_EYE=or,B.FACE_LANDMARKS_RIGHT_EYEBROW=ar,B.FACE_LANDMARKS_RIGHT_IRIS=x2,B.FACE_LANDMARKS_FACE_OVAL=hr,B.FACE_LANDMARKS_CONTOURS=L2,B.FACE_LANDMARKS_TESSELATION=M2;var De=class extends re{constructor(e,t){super(new Se(e,t),"image_in","norm_rect",!0),v(e=this.j=new s2,0,1,t=new R)}get baseOptions(){return S(this.j,R,1)}set baseOptions(e){v(this.j,0,1,e)}o(e){return super.l(e)}Ka(e,t,s){const n=typeof t!="function"?t:{};if(this.h=typeof t=="function"?t:s,ke(this,e,n??{}),!this.h)return this.s}m(){var e=new oe;P(e,"image_in"),P(e,"norm_rect"),k(e,"stylized_image");const t=new pe;Fe(t,Sh,this.j);const s=new Q;ge(s,"mediapipe.tasks.vision.face_stylizer.FaceStylizerGraph"),C(s,"IMAGE:image_in"),C(s,"NORM_RECT:norm_rect"),A(s,"STYLIZED_IMAGE:stylized_image"),s.o(t),ye(e,s),this.g.V("stylized_image",(n,i)=>{var r=!this.h,o=n.data,a=n.width;const h=a*(n=n.height);if(o instanceof Uint8Array)if(o.length===3*h){const c=new Uint8ClampedArray(4*h);for(let l=0;l<h;++l)c[4*l]=o[3*l],c[4*l+1]=o[3*l+1],c[4*l+2]=o[3*l+2],c[4*l+3]=255;o=new ImageData(c,a,n)}else{if(o.length!==4*h)throw Error("Unsupported channel count: "+o.length/h);o=new ImageData(new Uint8ClampedArray(o.buffer,o.byteOffset,o.length),a,n)}else if(!(o instanceof WebGLTexture))throw Error(`Unsupported format: ${o.constructor.name}`);a=new X([o],!1,!1,this.g.i.canvas,this.P,a,n),this.s=r=r?a.clone():a,this.h&&this.h(r),f(this,i)}),this.g.attachEmptyPacketListener("stylized_image",n=>{this.s=null,this.h&&this.h(null),f(this,n)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};De.prototype.stylize=De.prototype.Ka,De.prototype.setOptions=De.prototype.o,De.createFromModelPath=function(e,t){return E(De,e,{baseOptions:{modelAssetPath:t}})},De.createFromModelBuffer=function(e,t){return E(De,e,{baseOptions:{modelAssetBuffer:t}})},De.createFromOptions=function(e,t){return E(De,e,t)};var cr=Me([0,1],[1,2],[2,3],[3,4],[0,5],[5,6],[6,7],[7,8],[5,9],[9,10],[10,11],[11,12],[9,13],[13,14],[14,15],[15,16],[13,17],[0,17],[17,18],[18,19],[19,20]);function fo(e){e.gestures=[],e.landmarks=[],e.worldLandmarks=[],e.handedness=[]}function po(e){return e.gestures.length===0?{gestures:[],landmarks:[],worldLandmarks:[],handedness:[],handednesses:[]}:{gestures:e.gestures,landmarks:e.landmarks,worldLandmarks:e.worldLandmarks,handedness:e.handedness,handednesses:e.handedness}}function mo(e,t=!0){const s=[];for(const i of e){var n=rn(i);e=[];for(const r of n.g())n=t&&Ee(r,1)!=null?Ee(r,1)??0:-1,e.push({score:V(r,2)??0,index:n,categoryName:Ae(r,3)??""??"",displayName:Ae(r,4)??""??""});s.push(e)}return s}var ae=class extends re{constructor(e,t){super(new Se(e,t),"image_in","norm_rect",!1),this.gestures=[],this.landmarks=[],this.worldLandmarks=[],this.handedness=[],v(e=this.j=new r2,0,1,t=new R),this.s=new $i,v(this.j,0,2,this.s),this.C=new Ki,v(this.s,0,3,this.C),this.v=new i2,v(this.s,0,2,this.v),this.h=new kh,v(this.j,0,3,this.h),g(this.v,2,.5),g(this.s,4,.5),g(this.C,2,.5)}get baseOptions(){return S(this.j,R,1)}set baseOptions(e){v(this.j,0,1,e)}o(e){var i,r,o,a;if(Ne(this.v,3,e.numHands??1),"minHandDetectionConfidence"in e&&g(this.v,2,e.minHandDetectionConfidence??.5),"minTrackingConfidence"in e&&g(this.s,4,e.minTrackingConfidence??.5),"minHandPresenceConfidence"in e&&g(this.C,2,e.minHandPresenceConfidence??.5),e.cannedGesturesClassifierOptions){var t=new vt,s=t,n=Qn(e.cannedGesturesClassifierOptions,(i=S(this.h,vt,3))==null?void 0:i.h());v(s,0,2,n),v(this.h,0,3,t)}else e.cannedGesturesClassifierOptions===void 0&&((r=S(this.h,vt,3))==null||r.g());return e.customGesturesClassifierOptions?(v(s=t=new vt,0,2,n=Qn(e.customGesturesClassifierOptions,(o=S(this.h,vt,4))==null?void 0:o.h())),v(this.h,0,4,t)):e.customGesturesClassifierOptions===void 0&&((a=S(this.h,vt,4))==null||a.g()),this.l(e)}Fa(e,t){return fo(this),ke(this,e,t),po(this)}Ga(e,t,s){return fo(this),Ue(this,e,s,t),po(this)}m(){var e=new oe;P(e,"image_in"),P(e,"norm_rect"),k(e,"hand_gestures"),k(e,"hand_landmarks"),k(e,"world_hand_landmarks"),k(e,"handedness");const t=new pe;Fe(t,Th,this.j);const s=new Q;ge(s,"mediapipe.tasks.vision.gesture_recognizer.GestureRecognizerGraph"),C(s,"IMAGE:image_in"),C(s,"NORM_RECT:norm_rect"),A(s,"HAND_GESTURES:hand_gestures"),A(s,"LANDMARKS:hand_landmarks"),A(s,"WORLD_LANDMARKS:world_hand_landmarks"),A(s,"HANDEDNESS:handedness"),s.o(t),ye(e,s),this.g.attachProtoVectorListener("hand_landmarks",(n,i)=>{for(const r of n){n=ds(r);const o=[];for(const a of Ke(n,Xa,1))o.push({x:V(a,1)??0,y:V(a,2)??0,z:V(a,3)??0,visibility:V(a,4)??0});this.landmarks.push(o)}f(this,i)}),this.g.attachEmptyPacketListener("hand_landmarks",n=>{f(this,n)}),this.g.attachProtoVectorListener("world_hand_landmarks",(n,i)=>{for(const r of n){n=Ft(r);const o=[];for(const a of Ke(n,$a,1))o.push({x:V(a,1)??0,y:V(a,2)??0,z:V(a,3)??0,visibility:V(a,4)??0});this.worldLandmarks.push(o)}f(this,i)}),this.g.attachEmptyPacketListener("world_hand_landmarks",n=>{f(this,n)}),this.g.attachProtoVectorListener("hand_gestures",(n,i)=>{this.gestures.push(...mo(n,!1)),f(this,i)}),this.g.attachEmptyPacketListener("hand_gestures",n=>{f(this,n)}),this.g.attachProtoVectorListener("handedness",(n,i)=>{this.handedness.push(...mo(n)),f(this,i)}),this.g.attachEmptyPacketListener("handedness",n=>{f(this,n)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};function go(e){return{landmarks:e.landmarks,worldLandmarks:e.worldLandmarks,handednesses:e.handedness,handedness:e.handedness}}ae.prototype.recognizeForVideo=ae.prototype.Ga,ae.prototype.recognize=ae.prototype.Fa,ae.prototype.setOptions=ae.prototype.o,ae.createFromModelPath=function(e,t){return E(ae,e,{baseOptions:{modelAssetPath:t}})},ae.createFromModelBuffer=function(e,t){return E(ae,e,{baseOptions:{modelAssetBuffer:t}})},ae.createFromOptions=function(e,t){return E(ae,e,t)},ae.HAND_CONNECTIONS=cr;var he=class extends re{constructor(e,t){super(new Se(e,t),"image_in","norm_rect",!1),this.landmarks=[],this.worldLandmarks=[],this.handedness=[],v(e=this.h=new $i,0,1,t=new R),this.s=new Ki,v(this.h,0,3,this.s),this.j=new i2,v(this.h,0,2,this.j),Ne(this.j,3,1),g(this.j,2,.5),g(this.s,2,.5),g(this.h,4,.5)}get baseOptions(){return S(this.h,R,1)}set baseOptions(e){v(this.h,0,1,e)}o(e){return"numHands"in e&&Ne(this.j,3,e.numHands??1),"minHandDetectionConfidence"in e&&g(this.j,2,e.minHandDetectionConfidence??.5),"minTrackingConfidence"in e&&g(this.h,4,e.minTrackingConfidence??.5),"minHandPresenceConfidence"in e&&g(this.s,2,e.minHandPresenceConfidence??.5),this.l(e)}D(e,t){return this.landmarks=[],this.worldLandmarks=[],this.handedness=[],ke(this,e,t),go(this)}F(e,t,s){return this.landmarks=[],this.worldLandmarks=[],this.handedness=[],Ue(this,e,s,t),go(this)}m(){var e=new oe;P(e,"image_in"),P(e,"norm_rect"),k(e,"hand_landmarks"),k(e,"world_hand_landmarks"),k(e,"handedness");const t=new pe;Fe(t,Fh,this.h);const s=new Q;ge(s,"mediapipe.tasks.vision.hand_landmarker.HandLandmarkerGraph"),C(s,"IMAGE:image_in"),C(s,"NORM_RECT:norm_rect"),A(s,"LANDMARKS:hand_landmarks"),A(s,"WORLD_LANDMARKS:world_hand_landmarks"),A(s,"HANDEDNESS:handedness"),s.o(t),ye(e,s),this.g.attachProtoVectorListener("hand_landmarks",(n,i)=>{for(const r of n)n=ds(r),this.landmarks.push(an(n));f(this,i)}),this.g.attachEmptyPacketListener("hand_landmarks",n=>{f(this,n)}),this.g.attachProtoVectorListener("world_hand_landmarks",(n,i)=>{for(const r of n)n=Ft(r),this.worldLandmarks.push(ss(n));f(this,i)}),this.g.attachEmptyPacketListener("world_hand_landmarks",n=>{f(this,n)}),this.g.attachProtoVectorListener("handedness",(n,i)=>{var r=this.handedness,o=r.push;const a=[];for(const h of n){n=rn(h);const c=[];for(const l of n.g())c.push({score:V(l,2)??0,index:Ee(l,1)??0??-1,categoryName:Ae(l,3)??""??"",displayName:Ae(l,4)??""??""});a.push(c)}o.call(r,...a),f(this,i)}),this.g.attachEmptyPacketListener("handedness",n=>{f(this,n)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};he.prototype.detectForVideo=he.prototype.F,he.prototype.detect=he.prototype.D,he.prototype.setOptions=he.prototype.o,he.createFromModelPath=function(e,t){return E(he,e,{baseOptions:{modelAssetPath:t}})},he.createFromModelBuffer=function(e,t){return E(he,e,{baseOptions:{modelAssetBuffer:t}})},he.createFromOptions=function(e,t){return E(he,e,t)},he.HAND_CONNECTIONS=cr;var C2=Me([0,1],[1,2],[2,3],[3,7],[0,4],[4,5],[5,6],[6,8],[9,10],[11,12],[11,13],[13,15],[15,17],[15,19],[15,21],[17,19],[12,14],[14,16],[16,18],[16,20],[16,22],[18,20],[11,23],[12,24],[23,24],[23,25],[24,26],[25,27],[26,28],[27,29],[28,30],[29,31],[30,32],[27,31],[28,32]);function yo(e){e.h={faceLandmarks:[],faceBlendshapes:[],poseLandmarks:[],poseWorldLandmarks:[],poseSegmentationMasks:[],leftHandLandmarks:[],leftHandWorldLandmarks:[],rightHandLandmarks:[],rightHandWorldLandmarks:[]}}function bo(e){try{if(!e.C)return e.h;e.C(e.h)}finally{cn(e)}}function ws(e,t){e=ds(e),t.push(an(e))}var I=class extends re{constructor(e,t){super(new Se(e,t),"input_frames_image",null,!1),this.h={faceLandmarks:[],faceBlendshapes:[],poseLandmarks:[],poseWorldLandmarks:[],poseSegmentationMasks:[],leftHandLandmarks:[],leftHandWorldLandmarks:[],rightHandLandmarks:[],rightHandWorldLandmarks:[]},this.outputPoseSegmentationMasks=this.outputFaceBlendshapes=!1,v(e=this.j=new l2,0,1,t=new R),this.K=new Ki,v(this.j,0,2,this.K),this.Y=new xh,v(this.j,0,3,this.Y),this.s=new on,v(this.j,0,4,this.s),this.H=new Qa,v(this.j,0,5,this.H),this.v=new h2,v(this.j,0,6,this.v),this.L=new c2,v(this.j,0,7,this.L),g(this.s,2,.5),g(this.s,3,.3),g(this.H,2,.5),g(this.v,2,.5),g(this.v,3,.3),g(this.L,2,.5),g(this.K,2,.5)}get baseOptions(){return S(this.j,R,1)}set baseOptions(e){v(this.j,0,1,e)}o(e){return"minFaceDetectionConfidence"in e&&g(this.s,2,e.minFaceDetectionConfidence??.5),"minFaceSuppressionThreshold"in e&&g(this.s,3,e.minFaceSuppressionThreshold??.3),"minFacePresenceConfidence"in e&&g(this.H,2,e.minFacePresenceConfidence??.5),"outputFaceBlendshapes"in e&&(this.outputFaceBlendshapes=!!e.outputFaceBlendshapes),"minPoseDetectionConfidence"in e&&g(this.v,2,e.minPoseDetectionConfidence??.5),"minPoseSuppressionThreshold"in e&&g(this.v,3,e.minPoseSuppressionThreshold??.3),"minPosePresenceConfidence"in e&&g(this.L,2,e.minPosePresenceConfidence??.5),"outputPoseSegmentationMasks"in e&&(this.outputPoseSegmentationMasks=!!e.outputPoseSegmentationMasks),"minHandLandmarksConfidence"in e&&g(this.K,2,e.minHandLandmarksConfidence??.5),this.l(e)}D(e,t,s){const n=typeof t!="function"?t:{};return this.C=typeof t=="function"?t:s,yo(this),ke(this,e,n),bo(this)}F(e,t,s,n){const i=typeof s!="function"?s:{};return this.C=typeof s=="function"?s:n,yo(this),Ue(this,e,i,t),bo(this)}m(){var e=new oe;P(e,"input_frames_image"),k(e,"pose_landmarks"),k(e,"pose_world_landmarks"),k(e,"face_landmarks"),k(e,"left_hand_landmarks"),k(e,"left_hand_world_landmarks"),k(e,"right_hand_landmarks"),k(e,"right_hand_world_landmarks");const t=new pe,s=new Gr;$n(s,1,jt("type.googleapis.com/mediapipe.tasks.vision.holistic_landmarker.proto.HolisticLandmarkerGraphOptions"),""),function(i,r){if(r!=null)if(Array.isArray(r))M(i,2,zs(r,_i,void 0,void 0,!1));else{if(!(typeof r=="string"||r instanceof He||mt(r)))throw Error("invalid value in Any.value field: "+r+" expected a ByteString, a base64 encoded string, a Uint8Array or a jspb array");$n(i,2,fi(r,!1),gt())}}(s,this.j.g());const n=new Q;ge(n,"mediapipe.tasks.vision.holistic_landmarker.HolisticLandmarkerGraph"),Ms(n,8,Gr,s),C(n,"IMAGE:input_frames_image"),A(n,"POSE_LANDMARKS:pose_landmarks"),A(n,"POSE_WORLD_LANDMARKS:pose_world_landmarks"),A(n,"FACE_LANDMARKS:face_landmarks"),A(n,"LEFT_HAND_LANDMARKS:left_hand_landmarks"),A(n,"LEFT_HAND_WORLD_LANDMARKS:left_hand_world_landmarks"),A(n,"RIGHT_HAND_LANDMARKS:right_hand_landmarks"),A(n,"RIGHT_HAND_WORLD_LANDMARKS:right_hand_world_landmarks"),n.o(t),ye(e,n),hn(this,e),this.g.attachProtoListener("pose_landmarks",(i,r)=>{ws(i,this.h.poseLandmarks),f(this,r)}),this.g.attachEmptyPacketListener("pose_landmarks",i=>{f(this,i)}),this.g.attachProtoListener("pose_world_landmarks",(i,r)=>{var o=this.h.poseWorldLandmarks;i=Ft(i),o.push(ss(i)),f(this,r)}),this.g.attachEmptyPacketListener("pose_world_landmarks",i=>{f(this,i)}),this.outputPoseSegmentationMasks&&(A(n,"POSE_SEGMENTATION_MASK:pose_segmentation_mask"),Rt(this,"pose_segmentation_mask"),this.g.V("pose_segmentation_mask",(i,r)=>{this.h.poseSegmentationMasks=[Nt(this,i,!0,!this.C)],f(this,r)}),this.g.attachEmptyPacketListener("pose_segmentation_mask",i=>{this.h.poseSegmentationMasks=[],f(this,i)})),this.g.attachProtoListener("face_landmarks",(i,r)=>{ws(i,this.h.faceLandmarks),f(this,r)}),this.g.attachEmptyPacketListener("face_landmarks",i=>{f(this,i)}),this.outputFaceBlendshapes&&(k(e,"extra_blendshapes"),A(n,"FACE_BLENDSHAPES:extra_blendshapes"),this.g.attachProtoListener("extra_blendshapes",(i,r)=>{var o=this.h.faceBlendshapes;this.outputFaceBlendshapes&&(i=rn(i),o.push(Ji(i.g()??[]))),f(this,r)}),this.g.attachEmptyPacketListener("extra_blendshapes",i=>{f(this,i)})),this.g.attachProtoListener("left_hand_landmarks",(i,r)=>{ws(i,this.h.leftHandLandmarks),f(this,r)}),this.g.attachEmptyPacketListener("left_hand_landmarks",i=>{f(this,i)}),this.g.attachProtoListener("left_hand_world_landmarks",(i,r)=>{var o=this.h.leftHandWorldLandmarks;i=Ft(i),o.push(ss(i)),f(this,r)}),this.g.attachEmptyPacketListener("left_hand_world_landmarks",i=>{f(this,i)}),this.g.attachProtoListener("right_hand_landmarks",(i,r)=>{ws(i,this.h.rightHandLandmarks),f(this,r)}),this.g.attachEmptyPacketListener("right_hand_landmarks",i=>{f(this,i)}),this.g.attachProtoListener("right_hand_world_landmarks",(i,r)=>{var o=this.h.rightHandWorldLandmarks;i=Ft(i),o.push(ss(i)),f(this,r)}),this.g.attachEmptyPacketListener("right_hand_world_landmarks",i=>{f(this,i)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};I.prototype.detectForVideo=I.prototype.F,I.prototype.detect=I.prototype.D,I.prototype.setOptions=I.prototype.o,I.createFromModelPath=function(e,t){return E(I,e,{baseOptions:{modelAssetPath:t}})},I.createFromModelBuffer=function(e,t){return E(I,e,{baseOptions:{modelAssetBuffer:t}})},I.createFromOptions=function(e,t){return E(I,e,t)},I.HAND_CONNECTIONS=cr,I.POSE_CONNECTIONS=C2,I.FACE_LANDMARKS_LIPS=nr,I.FACE_LANDMARKS_LEFT_EYE=ir,I.FACE_LANDMARKS_LEFT_EYEBROW=rr,I.FACE_LANDMARKS_LEFT_IRIS=F2,I.FACE_LANDMARKS_RIGHT_EYE=or,I.FACE_LANDMARKS_RIGHT_EYEBROW=ar,I.FACE_LANDMARKS_RIGHT_IRIS=x2,I.FACE_LANDMARKS_FACE_OVAL=hr,I.FACE_LANDMARKS_CONTOURS=L2,I.FACE_LANDMARKS_TESSELATION=M2;var we=class extends re{constructor(e,t){super(new Se(e,t),"input_image","norm_rect",!0),this.j={classifications:[]},v(e=this.h=new u2,0,1,t=new R)}get baseOptions(){return S(this.h,R,1)}set baseOptions(e){v(this.h,0,1,e)}o(e){return v(this.h,0,2,Qn(e,S(this.h,Hi,2))),this.l(e)}qa(e,t){return this.j={classifications:[]},ke(this,e,t),this.j}ra(e,t,s){return this.j={classifications:[]},Ue(this,e,s,t),this.j}m(){var e=new oe;P(e,"input_image"),P(e,"norm_rect"),k(e,"classifications");const t=new pe;Fe(t,Lh,this.h);const s=new Q;ge(s,"mediapipe.tasks.vision.image_classifier.ImageClassifierGraph"),C(s,"IMAGE:input_image"),C(s,"NORM_RECT:norm_rect"),A(s,"CLASSIFICATIONS:classifications"),s.o(t),ye(e,s),this.g.attachProtoListener("classifications",(n,i)=>{this.j=function(r){const o={classifications:Ke(r,mh,1).map(a=>{var h;return Ji(((h=S(a,Wa,4))==null?void 0:h.g())??[],Ee(a,2)??0,Ae(a,3)??"")})};return Wn(It(r,2))!=null&&(o.timestampMs=Wn(It(r,2))??0),o}(gh(n)),f(this,i)}),this.g.attachEmptyPacketListener("classifications",n=>{f(this,n)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};we.prototype.classifyForVideo=we.prototype.ra,we.prototype.classify=we.prototype.qa,we.prototype.setOptions=we.prototype.o,we.createFromModelPath=function(e,t){return E(we,e,{baseOptions:{modelAssetPath:t}})},we.createFromModelBuffer=function(e,t){return E(we,e,{baseOptions:{modelAssetBuffer:t}})},we.createFromOptions=function(e,t){return E(we,e,t)};var ce=class extends re{constructor(e,t){super(new Se(e,t),"image_in","norm_rect",!0),this.h=new d2,this.embeddings={embeddings:[]},v(e=this.h,0,1,t=new R)}get baseOptions(){return S(this.h,R,1)}set baseOptions(e){v(this.h,0,1,e)}o(e){var t=this.h,s=S(this.h,Yr,2);return s=s?s.clone():new Yr,e.l2Normalize!==void 0?as(s,1,e.l2Normalize):"l2Normalize"in e&&M(s,1),e.quantize!==void 0?as(s,2,e.quantize):"quantize"in e&&M(s,2),v(t,0,2,s),this.l(e)}xa(e,t){return ke(this,e,t),this.embeddings}ya(e,t,s){return Ue(this,e,s,t),this.embeddings}m(){var e=new oe;P(e,"image_in"),P(e,"norm_rect"),k(e,"embeddings_out");const t=new pe;Fe(t,Mh,this.h);const s=new Q;ge(s,"mediapipe.tasks.vision.image_embedder.ImageEmbedderGraph"),C(s,"IMAGE:image_in"),C(s,"NORM_RECT:norm_rect"),A(s,"EMBEDDINGS:embeddings_out"),s.o(t),ye(e,s),this.g.attachProtoListener("embeddings_out",(n,i)=>{n=wh(n),this.embeddings=function(r){return{embeddings:Ke(r,bh,1).map(o=>{var h,c;const a={headIndex:Ee(o,3)??0??-1,headName:Ae(o,4)??""??""};if(la(o,Xr,Ln(o,1))!==void 0)o=ft(o=S(o,Xr,Ln(o,1)),1,ht,dt()),a.floatEmbedding=o.slice();else{const l=new Uint8Array(0);a.quantizedEmbedding=((c=(h=S(o,yh,Ln(o,2)))==null?void 0:h.ma())==null?void 0:c.h())??l}return a}),timestampMs:Wn(It(r,2))??0}}(n),f(this,i)}),this.g.attachEmptyPacketListener("embeddings_out",n=>{f(this,n)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};ce.cosineSimilarity=function(e,t){if(e.floatEmbedding&&t.floatEmbedding)e=eo(e.floatEmbedding,t.floatEmbedding);else{if(!e.quantizedEmbedding||!t.quantizedEmbedding)throw Error("Cannot compute cosine similarity between quantized and float embeddings.");e=eo(Qr(e.quantizedEmbedding),Qr(t.quantizedEmbedding))}return e},ce.prototype.embedForVideo=ce.prototype.ya,ce.prototype.embed=ce.prototype.xa,ce.prototype.setOptions=ce.prototype.o,ce.createFromModelPath=function(e,t){return E(ce,e,{baseOptions:{modelAssetPath:t}})},ce.createFromModelBuffer=function(e,t){return E(ce,e,{baseOptions:{modelAssetBuffer:t}})},ce.createFromOptions=function(e,t){return E(ce,e,t)};var ni=class{constructor(e,t,s){this.confidenceMasks=e,this.categoryMask=t,this.qualityScores=s}close(){var e,t;(e=this.confidenceMasks)==null||e.forEach(s=>{s.close()}),(t=this.categoryMask)==null||t.close()}};function wo(e){e.categoryMask=void 0,e.confidenceMasks=void 0,e.qualityScores=void 0}function vo(e){try{const t=new ni(e.confidenceMasks,e.categoryMask,e.qualityScores);if(!e.j)return t;e.j(t)}finally{cn(e)}}ni.prototype.close=ni.prototype.close;var se=class extends re{constructor(e,t){super(new Se(e,t),"image_in","norm_rect",!1),this.s=[],this.outputCategoryMask=!1,this.outputConfidenceMasks=!0,this.h=new qi,this.v=new f2,v(this.h,0,3,this.v),v(e=this.h,0,1,t=new R)}get baseOptions(){return S(this.h,R,1)}set baseOptions(e){v(this.h,0,1,e)}o(e){return e.displayNamesLocale!==void 0?M(this.h,2,jt(e.displayNamesLocale)):"displayNamesLocale"in e&&M(this.h,2),"outputCategoryMask"in e&&(this.outputCategoryMask=e.outputCategoryMask??!1),"outputConfidenceMasks"in e&&(this.outputConfidenceMasks=e.outputConfidenceMasks??!0),super.l(e)}J(){(function(e){var s,n;const t=Ke(e.ca(),Q,1).filter(i=>(Ae(i,1)??"").includes("mediapipe.tasks.TensorsToSegmentationCalculator"));if(e.s=[],t.length>1)throw Error("The graph has more than one mediapipe.tasks.TensorsToSegmentationCalculator.");t.length===1&&(((n=(s=S(t[0],pe,7))==null?void 0:s.l())==null?void 0:n.g())??new Map).forEach((i,r)=>{e.s[Number(r)]=Ae(i,1)??""})})(this)}segment(e,t,s){const n=typeof t!="function"?t:{};return this.j=typeof t=="function"?t:s,wo(this),ke(this,e,n),vo(this)}Ia(e,t,s,n){const i=typeof s!="function"?s:{};return this.j=typeof s=="function"?s:n,wo(this),Ue(this,e,i,t),vo(this)}Ba(){return this.s}m(){var e=new oe;P(e,"image_in"),P(e,"norm_rect");const t=new pe;Fe(t,m2,this.h);const s=new Q;ge(s,"mediapipe.tasks.vision.image_segmenter.ImageSegmenterGraph"),C(s,"IMAGE:image_in"),C(s,"NORM_RECT:norm_rect"),s.o(t),ye(e,s),hn(this,e),this.outputConfidenceMasks&&(k(e,"confidence_masks"),A(s,"CONFIDENCE_MASKS:confidence_masks"),Rt(this,"confidence_masks"),this.g.ba("confidence_masks",(n,i)=>{this.confidenceMasks=n.map(r=>Nt(this,r,!0,!this.j)),f(this,i)}),this.g.attachEmptyPacketListener("confidence_masks",n=>{this.confidenceMasks=[],f(this,n)})),this.outputCategoryMask&&(k(e,"category_mask"),A(s,"CATEGORY_MASK:category_mask"),Rt(this,"category_mask"),this.g.V("category_mask",(n,i)=>{this.categoryMask=Nt(this,n,!1,!this.j),f(this,i)}),this.g.attachEmptyPacketListener("category_mask",n=>{this.categoryMask=void 0,f(this,n)})),k(e,"quality_scores"),A(s,"QUALITY_SCORES:quality_scores"),this.g.attachFloatVectorListener("quality_scores",(n,i)=>{this.qualityScores=n,f(this,i)}),this.g.attachEmptyPacketListener("quality_scores",n=>{this.categoryMask=void 0,f(this,n)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};se.prototype.getLabels=se.prototype.Ba,se.prototype.segmentForVideo=se.prototype.Ia,se.prototype.segment=se.prototype.segment,se.prototype.setOptions=se.prototype.o,se.createFromModelPath=function(e,t){return E(se,e,{baseOptions:{modelAssetPath:t}})},se.createFromModelBuffer=function(e,t){return E(se,e,{baseOptions:{modelAssetBuffer:t}})},se.createFromOptions=function(e,t){return E(se,e,t)};var ii=class{constructor(e,t,s){this.confidenceMasks=e,this.categoryMask=t,this.qualityScores=s}close(){var e,t;(e=this.confidenceMasks)==null||e.forEach(s=>{s.close()}),(t=this.categoryMask)==null||t.close()}};ii.prototype.close=ii.prototype.close;var Nh=class extends m{constructor(e){super(e)}},_t=[0,U,-2],Ds=[0,Ge,-3,D,Ge,-1],_o=[0,Ds],Eo=[0,Ds,U,-1],Rn=class extends m{constructor(e){super(e)}},Ao=[0,Ge,-1,D],Uh=class extends m{constructor(e){super(e)}},So=class extends m{constructor(e){super(e)}},ri=[1,2,3,4,5,6,7,8,9,10,14,15],P2=class extends m{constructor(e){super(e)}};P2.prototype.g=nn([0,K,[0,ri,T,Ds,T,[0,Ds,_t],T,_o,T,[0,_o,_t],T,Ao,T,[0,Ge,-3,D,fe],T,[0,Ge,-3,D],T,[0,F,Ge,-2,D,U,D,-1,2,Ge,_t],T,Eo,T,[0,Eo,_t],Ge,_t,F,T,[0,Ge,-3,D,_t,-1],T,[0,K,Ao]],F,[0,F,U,-1,D]]);var Re=class extends re{constructor(e,t){super(new Se(e,t),"image_in","norm_rect_in",!1),this.outputCategoryMask=!1,this.outputConfidenceMasks=!0,this.h=new qi,this.s=new f2,v(this.h,0,3,this.s),v(e=this.h,0,1,t=new R)}get baseOptions(){return S(this.h,R,1)}set baseOptions(e){v(this.h,0,1,e)}o(e){return"outputCategoryMask"in e&&(this.outputCategoryMask=e.outputCategoryMask??!1),"outputConfidenceMasks"in e&&(this.outputConfidenceMasks=e.outputConfidenceMasks??!0),super.l(e)}segment(e,t,s,n){const i=typeof s!="function"?s:{};this.j=typeof s=="function"?s:n,this.qualityScores=this.categoryMask=this.confidenceMasks=void 0,s=this.B+1,n=new P2;const r=new So;var o=new Nh;if(Ne(o,1,255),v(r,0,12,o),t.keypoint&&t.scribble)throw Error("Cannot provide both keypoint and scribble.");if(t.keypoint){var a=new Rn;as(a,3,!0),g(a,1,t.keypoint.x),g(a,2,t.keypoint.y),es(r,5,ri,a)}else{if(!t.scribble)throw Error("Must provide either a keypoint or a scribble.");for(a of(o=new Uh,t.scribble))as(t=new Rn,3,!0),g(t,1,a.x),g(t,2,a.y),Ms(o,1,Rn,t);es(r,15,ri,o)}Ms(n,1,So,r),this.g.addProtoToStream(n.g(),"drishti.RenderData","roi_in",s),ke(this,e,i);e:{try{const c=new ii(this.confidenceMasks,this.categoryMask,this.qualityScores);if(!this.j){var h=c;break e}this.j(c)}finally{cn(this)}h=void 0}return h}m(){var e=new oe;P(e,"image_in"),P(e,"roi_in"),P(e,"norm_rect_in");const t=new pe;Fe(t,m2,this.h);const s=new Q;ge(s,"mediapipe.tasks.vision.interactive_segmenter.InteractiveSegmenterGraph"),C(s,"IMAGE:image_in"),C(s,"ROI:roi_in"),C(s,"NORM_RECT:norm_rect_in"),s.o(t),ye(e,s),hn(this,e),this.outputConfidenceMasks&&(k(e,"confidence_masks"),A(s,"CONFIDENCE_MASKS:confidence_masks"),Rt(this,"confidence_masks"),this.g.ba("confidence_masks",(n,i)=>{this.confidenceMasks=n.map(r=>Nt(this,r,!0,!this.j)),f(this,i)}),this.g.attachEmptyPacketListener("confidence_masks",n=>{this.confidenceMasks=[],f(this,n)})),this.outputCategoryMask&&(k(e,"category_mask"),A(s,"CATEGORY_MASK:category_mask"),Rt(this,"category_mask"),this.g.V("category_mask",(n,i)=>{this.categoryMask=Nt(this,n,!1,!this.j),f(this,i)}),this.g.attachEmptyPacketListener("category_mask",n=>{this.categoryMask=void 0,f(this,n)})),k(e,"quality_scores"),A(s,"QUALITY_SCORES:quality_scores"),this.g.attachFloatVectorListener("quality_scores",(n,i)=>{this.qualityScores=n,f(this,i)}),this.g.attachEmptyPacketListener("quality_scores",n=>{this.categoryMask=void 0,f(this,n)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};Re.prototype.segment=Re.prototype.segment,Re.prototype.setOptions=Re.prototype.o,Re.createFromModelPath=function(e,t){return E(Re,e,{baseOptions:{modelAssetPath:t}})},Re.createFromModelBuffer=function(e,t){return E(Re,e,{baseOptions:{modelAssetBuffer:t}})},Re.createFromOptions=function(e,t){return E(Re,e,t)};var ve=class extends re{constructor(e,t){super(new Se(e,t),"input_frame_gpu","norm_rect",!1),this.j={detections:[]},v(e=this.h=new g2,0,1,t=new R)}get baseOptions(){return S(this.h,R,1)}set baseOptions(e){v(this.h,0,1,e)}o(e){return e.displayNamesLocale!==void 0?M(this.h,2,jt(e.displayNamesLocale)):"displayNamesLocale"in e&&M(this.h,2),e.maxResults!==void 0?Ne(this.h,3,e.maxResults):"maxResults"in e&&M(this.h,3),e.scoreThreshold!==void 0?g(this.h,4,e.scoreThreshold):"scoreThreshold"in e&&M(this.h,4),e.categoryAllowlist!==void 0?Cs(this.h,5,e.categoryAllowlist):"categoryAllowlist"in e&&M(this.h,5),e.categoryDenylist!==void 0?Cs(this.h,6,e.categoryDenylist):"categoryDenylist"in e&&M(this.h,6),this.l(e)}D(e,t){return this.j={detections:[]},ke(this,e,t),this.j}F(e,t,s){return this.j={detections:[]},Ue(this,e,s,t),this.j}m(){var e=new oe;P(e,"input_frame_gpu"),P(e,"norm_rect"),k(e,"detections");const t=new pe;Fe(t,Ph,this.h);const s=new Q;ge(s,"mediapipe.tasks.vision.ObjectDetectorGraph"),C(s,"IMAGE:input_frame_gpu"),C(s,"NORM_RECT:norm_rect"),A(s,"DETECTIONS:detections"),s.o(t),ye(e,s),this.g.attachProtoVectorListener("detections",(n,i)=>{for(const r of n)n=Ka(r),this.j.detections.push(b2(n));f(this,i)}),this.g.attachEmptyPacketListener("detections",n=>{f(this,n)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};ve.prototype.detectForVideo=ve.prototype.F,ve.prototype.detect=ve.prototype.D,ve.prototype.setOptions=ve.prototype.o,ve.createFromModelPath=async function(e,t){return E(ve,e,{baseOptions:{modelAssetPath:t}})},ve.createFromModelBuffer=function(e,t){return E(ve,e,{baseOptions:{modelAssetBuffer:t}})},ve.createFromOptions=function(e,t){return E(ve,e,t)};var oi=class{constructor(e,t,s){this.landmarks=e,this.worldLandmarks=t,this.segmentationMasks=s}close(){var e;(e=this.segmentationMasks)==null||e.forEach(t=>{t.close()})}};function ko(e){e.landmarks=[],e.worldLandmarks=[],e.segmentationMasks=void 0}function To(e){try{const t=new oi(e.landmarks,e.worldLandmarks,e.segmentationMasks);if(!e.s)return t;e.s(t)}finally{cn(e)}}oi.prototype.close=oi.prototype.close;var ne=class extends re{constructor(e,t){super(new Se(e,t),"image_in","norm_rect",!1),this.landmarks=[],this.worldLandmarks=[],this.outputSegmentationMasks=!1,v(e=this.h=new y2,0,1,t=new R),this.v=new c2,v(this.h,0,3,this.v),this.j=new h2,v(this.h,0,2,this.j),Ne(this.j,4,1),g(this.j,2,.5),g(this.v,2,.5),g(this.h,4,.5)}get baseOptions(){return S(this.h,R,1)}set baseOptions(e){v(this.h,0,1,e)}o(e){return"numPoses"in e&&Ne(this.j,4,e.numPoses??1),"minPoseDetectionConfidence"in e&&g(this.j,2,e.minPoseDetectionConfidence??.5),"minTrackingConfidence"in e&&g(this.h,4,e.minTrackingConfidence??.5),"minPosePresenceConfidence"in e&&g(this.v,2,e.minPosePresenceConfidence??.5),"outputSegmentationMasks"in e&&(this.outputSegmentationMasks=e.outputSegmentationMasks??!1),this.l(e)}D(e,t,s){const n=typeof t!="function"?t:{};return this.s=typeof t=="function"?t:s,ko(this),ke(this,e,n),To(this)}F(e,t,s,n){const i=typeof s!="function"?s:{};return this.s=typeof s=="function"?s:n,ko(this),Ue(this,e,i,t),To(this)}m(){var e=new oe;P(e,"image_in"),P(e,"norm_rect"),k(e,"normalized_landmarks"),k(e,"world_landmarks"),k(e,"segmentation_masks");const t=new pe;Fe(t,Ih,this.h);const s=new Q;ge(s,"mediapipe.tasks.vision.pose_landmarker.PoseLandmarkerGraph"),C(s,"IMAGE:image_in"),C(s,"NORM_RECT:norm_rect"),A(s,"NORM_LANDMARKS:normalized_landmarks"),A(s,"WORLD_LANDMARKS:world_landmarks"),s.o(t),ye(e,s),hn(this,e),this.g.attachProtoVectorListener("normalized_landmarks",(n,i)=>{this.landmarks=[];for(const r of n)n=ds(r),this.landmarks.push(an(n));f(this,i)}),this.g.attachEmptyPacketListener("normalized_landmarks",n=>{this.landmarks=[],f(this,n)}),this.g.attachProtoVectorListener("world_landmarks",(n,i)=>{this.worldLandmarks=[];for(const r of n)n=Ft(r),this.worldLandmarks.push(ss(n));f(this,i)}),this.g.attachEmptyPacketListener("world_landmarks",n=>{this.worldLandmarks=[],f(this,n)}),this.outputSegmentationMasks&&(A(s,"SEGMENTATION_MASK:segmentation_masks"),Rt(this,"segmentation_masks"),this.g.ba("segmentation_masks",(n,i)=>{this.segmentationMasks=n.map(r=>Nt(this,r,!0,!this.s)),f(this,i)}),this.g.attachEmptyPacketListener("segmentation_masks",n=>{this.segmentationMasks=[],f(this,n)})),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};ne.prototype.detectForVideo=ne.prototype.F,ne.prototype.detect=ne.prototype.D,ne.prototype.setOptions=ne.prototype.o,ne.createFromModelPath=function(e,t){return E(ne,e,{baseOptions:{modelAssetPath:t}})},ne.createFromModelBuffer=function(e,t){return E(ne,e,{baseOptions:{modelAssetBuffer:t}})},ne.createFromOptions=function(e,t){return E(ne,e,t)},ne.POSE_CONNECTIONS=C2;const Fo=(e,t)=>{const s=e.replace(/\/+$/,""),n=t.endsWith("/"),i=t.replace(/^\/+/,"").replace(/\/+$/,""),r=`${s}/${i}`;return n?`${r}/`:r},xo=(e,t=2)=>Math.floor(e).toString().padStart(t,"0"),Gh=1/15,On=2,Vh=.35,jh=1.5,Hh=[11,12,23,24,15,16],Lo=[{id:"head",indices:[0,1,2,3,4],radiusScale:1.15},{id:"torso",indices:[11,12,23,24],radiusScale:1.45},{id:"leftShoulder",indices:[11],radiusScale:1},{id:"rightShoulder",indices:[12],radiusScale:1},{id:"leftElbow",indices:[13],radiusScale:.95},{id:"rightElbow",indices:[14],radiusScale:.95},{id:"leftWrist",indices:[15],radiusScale:.95},{id:"rightWrist",indices:[16],radiusScale:.95},{id:"leftHip",indices:[23],radiusScale:1.1},{id:"rightHip",indices:[24],radiusScale:1.1},{id:"leftKnee",indices:[25],radiusScale:1},{id:"rightKnee",indices:[26],radiusScale:1},{id:"leftAnkle",indices:[27],radiusScale:.9},{id:"rightAnkle",indices:[28],radiusScale:.9}],Wh=()=>window.matchMedia("(max-width: 768px)").matches?36:28,vs=(e,t)=>{let s=0,n=0,i=0,r=0;for(const h of e){const c=t[h];if(!c)continue;const l=de(c.visibility??0,0,1);l<=0||(s+=c.x*l,n+=c.y*l,i+=l,r+=l)}if(i<=0)return null;const o=e.length||1,a=de(r/o,0,1);return{position:ue(s/i,n/i),confidence:a}},zh=e=>{var n;let t=0,s=0;for(const i of Hh){const r=((n=e[i])==null?void 0:n.visibility)??0;t+=r,s+=1}return s>0?de(t/s,0,1):0};class Kh{constructor(t,s=!0){p(this,"landmarker",null);p(this,"stream",null);p(this,"detectionTimer",0);p(this,"pendingDetection",!1);p(this,"tracks");p(this,"stableTimer",0);p(this,"lastPlayerCount",0);p(this,"initialized",!1);p(this,"radius",Wh());this.video=t,this.mirror=s,this.tracks=Array.from({length:On},()=>this.createEmptyTrack())}createEmptyTrack(){const t=Lo.reduce((s,n)=>(s[n.id]={id:n.id,position:ue(.5,.5),radius:this.radius*n.radiusScale,confidence:0},s),{});return{position:ue(.5,.5),confidence:0,visible:!1,lastSeen:0,colliders:t}}async initialize(){if(this.initialized)return;this.stream=await navigator.mediaDevices.getUserMedia({video:{facingMode:"user",width:960,height:540},audio:!1}),this.video.srcObject=this.stream,await this.video.play(),this.video.classList.add("is-visible");const t=await ut.forVisionTasks(Fo("/dev-sandbox/tools/DVD/","mediapipe/wasm"));this.landmarker=await ne.createFromOptions(t,{baseOptions:{modelAssetPath:Fo("/dev-sandbox/tools/DVD/","mediapipe/pose_landmarker_lite.task")},runningMode:"VIDEO",numPoses:On}),this.initialized=!0}dispose(){var t;(t=this.landmarker)==null||t.close(),this.landmarker=null,this.stream&&(this.stream.getTracks().forEach(s=>s.stop()),this.stream=null),this.video.srcObject=null,this.video.classList.remove("is-visible")}update(t,s,n){this.detectionTimer-=t;for(const r of this.tracks)if(r.lastSeen+=t,r.lastSeen>.4){r.visible=!1,r.confidence=Math.max(0,r.confidence-t*2);for(const o of Object.values(r.colliders))o.confidence=Math.max(0,o.confidence-t*2)}if(!this.initialized||!this.landmarker||!this.video||this.video.readyState<HTMLMediaElement.HAVE_ENOUGH_DATA){this.stableTimer=0,this.lastPlayerCount=0;return}this.detectionTimer<=0&&!this.pendingDetection&&(this.detectionTimer=Gh,this.pendingDetection=!0,this.detect(s,n));const i=this.tracks.filter(r=>r.visible&&r.confidence>=Vh&&Object.values(r.colliders).some(o=>o.confidence>=.25));i.length>0?this.stableTimer+=t:this.stableTimer=Math.max(0,this.stableTimer-t*2),this.lastPlayerCount=i.length}getPlayers(){return this.tracks.map((t,s)=>({id:s,position:ue(t.position.x,t.position.y),radius:this.radius,confidence:t.confidence,visible:t.visible,colliders:Object.values(t.colliders).filter(n=>n.confidence>=.2).map(n=>({id:n.id,position:ue(n.position.x,n.position.y),radius:n.radius,confidence:n.confidence}))})).filter(t=>t.visible&&t.colliders.length>0)}getPlayerCount(){return this.lastPlayerCount}isStable(t=1){return this.stableTimer>=jh&&this.lastPlayerCount>=t}isInitialized(){return this.initialized}async detect(t,s){var n;try{const i=await((n=this.landmarker)==null?void 0:n.detectForVideo(this.video,performance.now()));if(!i)return;this.applyDetection(i,t,s)}catch(i){console.error("[DVD] Pose detection failed",i)}finally{this.pendingDetection=!1}}applyDetection(t,s,n){const r=(t.landmarks??[]).map(a=>{const h=vs([11,12,23,24],a),c=vs([15,16],a),l=vs([0,1,2,3,4],a),u=h??c??l;if(!u)return null;const d=zh(a);if(d<.1)return null;const y=this.mirror?1-u.position.x:u.position.x,_=u.position.y;return{x:de(y,0,1),y:de(_,0,1),confidence:d,colliders:this.buildColliderTargets(a,s,n)}}).filter(a=>a!==null).slice(0,On).sort((a,h)=>a.x-h.x),o=.45;if(r.forEach((a,h)=>{const c=this.tracks[h],l=a.x*s,u=a.y*n;c.position.x=le(c.position.x,l,o),c.position.y=le(c.position.y,u,o),c.confidence=le(c.confidence,a.confidence,.4),c.visible=a.confidence>=.15,c.lastSeen=0;const d=new Set;a.colliders.forEach(y=>{d.add(y.id);const _=c.colliders[y.id];_?(_.position.x=le(_.position.x,y.position.x,o),_.position.y=le(_.position.y,y.position.y,o),_.radius=le(_.radius,y.radius,.35),_.confidence=le(_.confidence,y.confidence,.5)):c.colliders[y.id]={id:y.id,position:ue(y.position.x,y.position.y),radius:y.radius,confidence:y.confidence}}),Object.entries(c.colliders).forEach(([y,_])=>{d.has(y)||(_.confidence=Math.max(0,_.confidence-.1))})}),r.length===0)for(const a of this.tracks)a.visible=!1}buildColliderTargets(t,s,n){const i=[];for(const r of Lo){const o=vs(r.indices,t);if(!o)continue;const a=this.mirror?1-o.position.x:o.position.x,h=de(a,0,1),c=de(o.position.y,0,1);i.push({id:r.id,position:ue(h*s,c*n),radius:this.radius*r.radiusScale,confidence:o.confidence})}return i}}const $h={bounce:[440,660],coin:[820,1020],hit:[180,120,90],countdown:[480]};class Xh{constructor(){p(this,"context");p(this,"muted",!1);const t=window,s=window.AudioContext??t.webkitAudioContext;if(!s)throw new Error("Web Audio API is not supported in this browser.");this.context=new s,this.context.suspend().catch(()=>{})}setMuted(t){this.muted=t,!t&&this.context.state==="suspended"&&this.context.resume()}toggle(){return this.setMuted(!this.muted),this.muted}async resume(){this.context.state==="suspended"&&await this.context.resume()}async play(t,s={}){if(this.muted)return;await this.resume();const n=this.context.currentTime,i=$h[t]??[440],r=s.duration??.16,o=s.volume??.35;i.forEach((a,h)=>{const c=this.context.createOscillator(),l=this.context.createGain();c.type="triangle",c.frequency.value=a;const u=n+h*.025,d=u+r;l.gain.setValueAtTime(0,u),l.gain.linearRampToValueAtTime(o,u+.02),l.gain.exponentialRampToValueAtTime(1e-4,d),c.connect(l).connect(this.context.destination),c.start(u),c.stop(d+.02)})}}const Mo="dvd-dodge-best-score",Yh=300,Y=ue(140,70),Et=26,Co=3.5,Bn=1.2,Nn=2,qh=1.05,Jh=1.03,Zh=3,Qh=30,_s=.3,Po=.4,Es=["3","2","1","GO!"],L=24,ec=[["head","torso"],["torso","leftShoulder"],["torso","rightShoulder"],["leftShoulder","rightShoulder"],["torso","leftHip"],["torso","rightHip"],["leftHip","rightHip"],["leftShoulder","leftElbow"],["leftElbow","leftWrist"],["rightShoulder","rightElbow"],["rightElbow","rightWrist"],["leftHip","leftKnee"],["leftKnee","leftAnkle"],["rightHip","rightKnee"],["rightKnee","rightAnkle"]],Je=(e,t)=>Math.random()*(t-e)+e;class tc extends z2{constructor(s){super();p(this,"phase","splash");p(this,"phaseTimer",0);p(this,"countdownIndex",0);p(this,"countdownTimer",0);p(this,"countdownDuration",.9);p(this,"tracker");p(this,"sfx",new Xh);p(this,"dvd",{position:ue(410,220),direction:ue(fs.randFloatSpread(1),fs.randFloatSpread(1)),speedMultiplier:1,hue:210/360,glow:0});p(this,"coins",[]);p(this,"nextCoinId",1);p(this,"coinTimer",Je(Bn,Nn));p(this,"bursts",[]);p(this,"score",0);p(this,"bestScore",0);p(this,"elapsedPlayTime",0);p(this,"timeSinceAcceleration",0);p(this,"slowMotionTimer",0);p(this,"timeScale",1);p(this,"hitFlash",0);p(this,"players",[]);p(this,"playerCount",0);p(this,"calibrating",!1);p(this,"calibrationError",null);p(this,"restartReady",!1);p(this,"removeInputListener",null);p(this,"backgroundColor",new xs("#08152C"));this.video=s,this.tracker=new Kh(s);const n=Math.hypot(this.dvd.direction.x,this.dvd.direction.y)||1;this.dvd.direction.x/=n,this.dvd.direction.y/=n}onEnter(s){this.bestScore=Number.parseInt(localStorage.getItem(Mo)??"0",10)||0,this.phase="splash",this.phaseTimer=0,this.score=0,this.restartReady=!1,this.registerInput(s),s.renderer.canvas.focus()}onExit(){var s;(s=this.removeInputListener)==null||s.call(this),this.removeInputListener=null,this.tracker.dispose()}update(s,n){const r=n.renderer.canvas;switch(this.phaseTimer+=s,this.phase){case"splash":this.timeScale=0;break;case"calibrate":this.updateCalibration(s,r.width,r.height);break;case"countdown":this.updateCalibration(s,r.width,r.height),this.updateCountdown(s);break;case"play":this.updateCalibration(s,r.width,r.height),this.updatePlay(s,r.width,r.height);break;case"game-over":this.updateCalibration(s,r.width,r.height),this.updateGameOver(s,r.width,r.height);break}}render(s){const n=s.renderer,i=n.context,r=n.canvas;this.renderBackground(i,r.width,r.height),this.renderCoins(i),this.renderBursts(i),this.renderDvd(i),this.renderPlayers(i),this.renderHud(i,r.width),this.renderPhaseOverlay(i,r.width,r.height),this.renderFlash(i,r.width,r.height)}registerInput(s){var i;const n=s.input;(i=this.removeInputListener)==null||i.call(this),this.removeInputListener=n.onInput(r=>{if(r.type==="keydown"){const o=r;this.handleKey(o.key.toLowerCase())}else r.type==="pointerdown"&&this.handlePointer()})}handleKey(s){if(s==="m"){this.sfx.toggle();return}s!==" "&&s!=="enter"||this.handlePrimaryAction()}handlePointer(){this.handlePrimaryAction()}handlePrimaryAction(){if(this.phase==="splash"){this.beginCalibration();return}if(this.phase==="game-over"&&this.restartReady){this.startCountdown();return}}async beginCalibration(){if(!this.calibrating){this.calibrating=!0,this.calibrationError=null,this.phase="calibrate",this.phaseTimer=0;try{await this.tracker.initialize(),this.sfx.setMuted(!1)}catch(s){console.error("[DVD] Failed to initialize tracker",s),this.calibrationError="",this.phase="splash"}finally{this.calibrating=!1}}}updateCalibration(s,n,i){this.tracker.update(s,n,i),this.players=this.tracker.getPlayers(),this.playerCount=this.tracker.getPlayerCount(),this.phase==="calibrate"&&this.tracker.isInitialized()&&this.tracker.isStable(1)&&this.startCountdown()}startCountdown(){this.phase="countdown",this.countdownIndex=0,this.countdownTimer=0,this.phaseTimer=0,this.timeScale=0,this.players=this.tracker.getPlayers(),this.sfx.play("countdown",{volume:.3})}updateCountdown(s){this.countdownTimer+=s,this.countdownTimer>=this.countdownDuration&&(this.countdownTimer=0,this.countdownIndex+=1,this.countdownIndex<Es.length&&this.sfx.play("countdown",{volume:.32}),this.countdownIndex>=Es.length&&this.startPlay())}startPlay(){this.phase="play",this.phaseTimer=0,this.score=0,this.elapsedPlayTime=0,this.timeSinceAcceleration=0,this.coinTimer=Je(Bn,Nn),this.coins=[],this.bursts=[],this.restartReady=!1,this.timeScale=1,this.slowMotionTimer=0,this.hitFlash=0,this.players=this.tracker.getPlayers(),this.playerCount=this.tracker.getPlayerCount(),this.dvd.position.x=Je(220,720),this.dvd.position.y=Je(160,360),this.dvd.direction=ue(fs.randFloatSpread(1),fs.randFloatSpread(1));const s=Math.hypot(this.dvd.direction.x,this.dvd.direction.y)||1;this.dvd.direction.x/=s,this.dvd.direction.y/=s,this.dvd.speedMultiplier=1}updatePlay(s,n,i){this.elapsedPlayTime+=s,this.timeSinceAcceleration+=s,this.players=this.tracker.getPlayers(),this.playerCount=this.tracker.getPlayerCount(),this.timeSinceAcceleration>=Qh&&(this.timeSinceAcceleration=0,this.increaseDvdSpeed(Jh));const r=s*this.timeScale;if(this.updateDvd(r,n,i),this.updateCoins(r,n,i),this.updateBursts(s),this.detectCoinCollection(),this.checkCollisionWithPlayers()&&this.triggerGameOver(),this.slowMotionTimer>0){this.slowMotionTimer=Math.max(0,this.slowMotionTimer-s);const o=de(1-this.slowMotionTimer/_s,0,1);this.timeScale=le(.2,1,o*o)}else this.timeScale=le(this.timeScale,1,s*3);this.dvd.glow=Math.max(0,this.dvd.glow-s*2),this.hitFlash=Math.max(0,this.hitFlash-s/Po)}updateGameOver(s,n,i){if(this.players=this.tracker.getPlayers(),this.playerCount=this.tracker.getPlayerCount(),this.updateBursts(s),this.slowMotionTimer>0){this.slowMotionTimer=Math.max(0,this.slowMotionTimer-s);const r=de(this.slowMotionTimer/_s,0,1);this.timeScale=le(.05,.35,r),this.updateDvd(s*this.timeScale,n,i)}else this.timeScale=le(this.timeScale,0,s*5);this.dvd.glow=Math.max(0,this.dvd.glow-s),this.hitFlash=Math.max(0,this.hitFlash-s/Po),!this.restartReady&&this.phaseTimer>=.8&&(this.restartReady=!0)}updateDvd(s,n,i){if(s<=0)return;const r=Yh*this.dvd.speedMultiplier;this.dvd.position.x+=this.dvd.direction.x*r*s,this.dvd.position.y+=this.dvd.direction.y*r*s;let o=!1;if(this.dvd.position.x<=L?(this.dvd.position.x=L,this.dvd.direction.x=Math.abs(this.dvd.direction.x),o=!0):this.dvd.position.x+Y.x>=n-L&&(this.dvd.position.x=n-L-Y.x,this.dvd.direction.x=-Math.abs(this.dvd.direction.x),o=!0),this.dvd.position.y<=L*.5?(this.dvd.position.y=L*.5,this.dvd.direction.y=Math.abs(this.dvd.direction.y),o=!0):this.dvd.position.y+Y.y>=i-L*.5&&(this.dvd.position.y=i-L*.5-Y.y,this.dvd.direction.y=-Math.abs(this.dvd.direction.y),o=!0),o){const a=Je(.03,.08);this.dvd.hue=(this.dvd.hue+a)%1,this.dvd.glow=1,this.sfx.play("bounce",{volume:.22,duration:.12})}}updateCoins(s,n,i){this.coinTimer-=s,this.coinTimer<=0&&(this.spawnCoin(n,i),this.coinTimer=Je(Bn,Nn)),this.coins=this.coins.filter(r=>(r.ttl-=s,r.ttl>0))}updateBursts(s){this.bursts=this.bursts.filter(n=>(n.elapsed+=s,n.elapsed<n.life))}spawnCoin(s,n){const i=L+Et*2,r=L+Et*2,o=ue(Je(i,s-i),Je(r,n-r));this.coins.push({id:this.nextCoinId++,position:o,ttl:Co})}detectCoinCollection(){if(this.coins.length===0||this.players.length===0)return;const s=new Set;for(const n of this.players)for(const i of n.colliders)for(const r of this.coins){if(s.has(r.id))continue;const o={position:i.position,radius:i.radius},a={position:r.position,radius:Et};N2(o,a)&&(s.add(r.id),this.handleCoinCollection(r))}s.size>0&&(this.coins=this.coins.filter(n=>!s.has(n.id)))}handleCoinCollection(s){this.score+=1,this.score>this.bestScore&&(this.bestScore=this.score,localStorage.setItem(Mo,this.bestScore.toString())),this.increaseDvdSpeed(qh),this.bursts.push({position:s.position,life:.5,elapsed:0}),this.slowMotionTimer=Math.min(_s,this.slowMotionTimer+.08),this.sfx.play("coin",{volume:.3,duration:.18})}increaseDvdSpeed(s){this.dvd.speedMultiplier=Math.min(Zh,this.dvd.speedMultiplier*s)}checkCollisionWithPlayers(){const s={position:this.dvd.position,size:Y};return this.players.some(n=>n.colliders.some(i=>U2(s,{position:i.position,radius:i.radius})))}triggerGameOver(){this.phase="game-over",this.phaseTimer=0,this.restartReady=!1,this.slowMotionTimer=_s,this.timeScale=.2,this.hitFlash=1,this.sfx.play("hit",{volume:.32,duration:.24})}renderBackground(s,n,i){s.clearRect(0,0,n,i)}renderDvd(s){const{position:n}=this.dvd,i=this.dvd.glow,r=this.dvd.hue;s.save(),s.translate(n.x+Y.x/2,n.y+Y.y/2);const o=new xs().setHSL(r,.7,.55),a=o.clone().offsetHSL(0,-.2,-.2),h=o.clone().offsetHSL(-.02,.1,.15);s.fillStyle=o.getStyle(),s.strokeStyle=a.getStyle(),s.lineWidth=4;const c=()=>{if(typeof s.roundRect=="function")s.roundRect(-Y.x/2,-Y.y/2,Y.x,Y.y,18);else{const d=Y.x,y=Y.y,_=Math.min(18,Math.abs(d/2),Math.abs(y/2));s.moveTo(-d/2+_,-y/2),s.arcTo(d/2,-y/2,d/2,y/2,_),s.arcTo(d/2,y/2,-d/2,y/2,_),s.arcTo(-d/2,y/2,-d/2,-y/2,_),s.arcTo(-d/2,-y/2,d/2,-y/2,_),s.closePath()}};s.beginPath(),c(),s.fill(),s.stroke();const l=s.createLinearGradient(-Y.x/2,-Y.y/2,Y.x/2,Y.y/2);l.addColorStop(0,`${h.getStyle()}`),l.addColorStop(1,"transparent"),s.globalAlpha=de(i*.6+.35,.35,.9),s.fillStyle=l,s.beginPath(),c(),s.fill(),s.globalAlpha=1,s.fillStyle="#0c1020",s.font='bold 38px "Futura PT", "Noto Sans JP", sans-serif',s.textAlign="center",s.textBaseline="middle",s.fillText("DVD",0,4),s.restore()}renderCoins(s){this.coins.forEach(n=>{const i=de(n.ttl/Co,0,1),r=le(.9,1.2,1-i);s.save(),s.translate(n.position.x,n.position.y),s.scale(r,r);const o=s.createRadialGradient(0,-6,6,0,0,Et);o.addColorStop(0,"#fff9c4"),o.addColorStop(.7,"#ffd54f"),o.addColorStop(1,"#fbc02d"),s.fillStyle=o,s.beginPath(),s.arc(0,0,Et,0,Math.PI*2),s.fill(),s.strokeStyle="rgba(255, 255, 255, 0.65)",s.lineWidth=2,s.beginPath(),s.arc(0,0,Et-5,0,Math.PI*2),s.stroke(),s.fillStyle="#6d4c41",s.font='bold 20px "Noto Sans JP", sans-serif',s.textAlign="center",s.textBaseline="middle",s.fillText("",0,0),s.restore()})}renderBursts(s){this.bursts.forEach(n=>{const i=de(n.elapsed/n.life,0,1),r=1-i,o=le(8,48,i);s.save(),s.globalAlpha=r*.6,s.fillStyle="rgba(255, 244, 168, 0.8)",s.beginPath(),s.arc(n.position.x,n.position.y,o,0,Math.PI*2),s.fill(),s.restore()})}renderPlayers(s){const n=performance.now();this.players.forEach((i,r)=>{if(i.colliders.length===0)return;const o=new Map(i.colliders.map(l=>[l.id,l]));s.save(),s.strokeStyle="rgba(129, 212, 250, 0.55)",s.lineWidth=6,s.shadowColor="rgba(129, 212, 250, 0.4)",s.shadowBlur=18;for(const[l,u]of ec){const d=o.get(l),y=o.get(u);!d||!y||(s.beginPath(),s.moveTo(d.position.x,d.position.y),s.lineTo(y.position.x,y.position.y),s.stroke())}s.restore(),i.colliders.forEach(l=>{const u=1+Math.sin(n/320+r*.6)*.05,d=l.radius*u;s.save();const y=s.createRadialGradient(l.position.x,l.position.y,d*.25,l.position.x,l.position.y,d);y.addColorStop(0,"rgba(255, 153, 255, 0.95)"),y.addColorStop(1,"rgba(233, 30, 99, 0.35)"),s.fillStyle=y,s.beginPath(),s.arc(l.position.x,l.position.y,d,0,Math.PI*2),s.fill(),s.lineWidth=2,s.strokeStyle="rgba(255, 255, 255, 0.65)",s.beginPath(),s.arc(l.position.x,l.position.y,d*.6,0,Math.PI*2),s.stroke(),s.restore()});const a=o.get("torso"),h=o.get("head"),c=a??h??i.colliders[0];c&&(s.save(),s.font='16px "Noto Sans JP", sans-serif',s.fillStyle="#e1f5fe",s.textAlign="center",s.fillText(`P${r+1}`,c.position.x,c.position.y-c.radius-18),s.restore())})}renderHud(s,n){s.save(),s.fillStyle="rgba(4, 8, 24, 0.55)",s.fillRect(L/2,L/2,200,64),s.fillRect(n/2-100,L/2,200,48),s.fillRect(n-L/2-200,L/2,200,72),s.fillStyle="#8bd5ff",s.font='14px "Noto Sans JP", sans-serif',s.textBaseline="top",s.fillText("",L/2+16,L/2+10),s.font='bold 32px "Noto Sans JP", sans-serif',s.fillStyle="#e1f5fe",s.fillText(xo(this.score,3),L/2+16,L/2+24),s.textAlign="center",s.font='bold 20px "Noto Sans JP", sans-serif',s.fillStyle="#ffe082",s.fillText(` ${xo(this.bestScore,3)}`,n/2,L/2+12),s.textAlign="right",s.fillStyle="#b3e5fc",s.font='14px "Noto Sans JP", sans-serif',s.fillText(`Players: ${this.playerCount}`,n-L/2-16,L/2+10),s.fillText(` x${this.dvd.speedMultiplier.toFixed(2)}`,n-L/2-16,L/2+30),s.fillText(` ${Math.floor(this.elapsedPlayTime)}s`,n-L/2-16,L/2+50),s.restore()}renderPhaseOverlay(s,n,i){if(s.save(),s.textAlign="center",s.textBaseline="middle",this.phase==="splash")s.fillStyle="rgba(4, 8, 20, 0.65)",s.fillRect(0,0,n,i),s.fillStyle="#d1f4ff",s.font='bold 64px "Noto Sans JP", sans-serif',s.fillText("DVD Dodge",n/2,i/2-32),s.font='24px "Noto Sans JP", sans-serif',s.fillText(" / ",n/2,i/2+32);else if(this.phase==="calibrate"){s.fillStyle="rgba(2, 6, 18, 0.5)",s.fillRect(0,0,n,i),s.fillStyle="#b3e5fc",s.font='bold 40px "Noto Sans JP", sans-serif',s.fillText("...",n/2,i/2-32),s.font='20px "Noto Sans JP", sans-serif';const r=this.calibrationError?this.calibrationError:"";s.fillText(r,n/2,i/2+24)}else if(this.phase==="countdown"){const r=Es[Math.min(this.countdownIndex,Es.length-1)];s.fillStyle="rgba(2, 6, 18, 0.35)",s.fillRect(0,0,n,i),s.fillStyle="#fff59d",s.shadowColor="rgba(255, 245, 157, 0.8)",s.shadowBlur=24,s.font='bold 96px "Noto Sans JP", sans-serif',s.fillText(r,n/2,i/2)}else this.phase==="game-over"&&(s.fillStyle="rgba(8, 0, 12, 0.55)",s.fillRect(0,0,n,i),s.fillStyle="#ff8a80",s.font='bold 56px "Noto Sans JP", sans-serif',s.fillText("HIT!",n/2,i/2-48),s.fillStyle="#fce4ec",s.font='24px "Noto Sans JP", sans-serif',s.fillText(`: ${this.score} / : ${this.bestScore}`,n/2,i/2+8),this.restartReady?(s.fillStyle="#b3e5fc",s.fillText(" / ",n/2,i/2+48)):(s.fillStyle="#90caf9",s.fillText("...",n/2,i/2+48)));s.restore()}renderFlash(s,n,i){this.hitFlash<=0||(s.save(),s.globalAlpha=this.hitFlash*.6,s.fillStyle="#ffffff",s.fillRect(0,0,n,i),s.restore())}}const Rs=document.getElementById("game-canvas"),I2=document.getElementById("camera-stream");if(!Rs||!I2)throw new Error("");const lr=new W2(Rs,{background:"rgba(0, 0, 0, 0)"}),D2=()=>{const e=window.innerWidth,t=window.innerHeight;Rs.width=e,Rs.height=t,lr.renderer.resize(ue(e,t))};D2();window.addEventListener("resize",D2);const sc=new tc(I2);lr.setScene(sc);lr.start();
