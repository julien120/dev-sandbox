# DVD Dodge

**企画・仕様ドキュメント**

---

## 概要

本企画は、ウェブカメラを用いた体感型ブラウザゲーム **「DVD Dodge」** のクローン制作を目的とする。  
プレイヤーはカメラに映った自身の身体や手を操作キャラクターとして使用し、  
画面内で跳ね回る DVD ロゴを避けながらコインを集める。  
本ドキュメントは、ゲーム構造、演出、技術的仕様を包括的に定義する。

---

## 1. ゲームコンセプト

- **タイトル**：DVD Dodge Clone
- **ジャンル**：体感型カメラアクション（1〜2人協力プレイ対応）
- **操作方法**：Webカメラによる身体／手のトラッキング
- **目的**：DVDロゴを避けつつ、出現するコインを集めてスコアを競う
- **プレイ時間**：1プレイ約60〜120秒
- **対応環境**：PCブラウザ（Chrome / Edge / Safari 最新版）
- **技術スタック**：Vite + TypeScript + three.js + MediaPipe Tasks Vision

---

## 2. ゲームサイクル（シーケンス）

| フェーズ      | 内容                           | 時間    | 備考                           |
| ------------- | ------------------------------ | ------- | ------------------------------ |
| **Splash**    | タイトルロゴ、Startボタン表示  | 約1.2秒 | チュートリアルアイコン併設     |
| **Calibrate** | カメラ起動・プレイヤー位置調整 | 約5秒   | ランドマーク安定検出で自動遷移 |
| **Countdown** | 「3→2→1→GO!」演出              | 約2秒   | GOと同時にDVDロゴ始動          |
| **Play**      | ロゴ回避＆コイン収集フェーズ   | 無制限  | ロゴ速度上昇・コイン出現       |
| **GameOver**  | 被弾時の演出後に終了           | 約1秒   | SlowMotion→停止→スコア表示     |
| **Retry**     | 短縮カウントダウン再挑戦       | 約1秒   | 省略版カウントダウン（設定可） |

---

## 3. コアゲームメカニクス

### 3.1 プレイヤー

- Webカメラで認識した手または体幹中心をキャラクター化。
- 半透明円形アイコンで画面内に表示。
- 当たり判定は円形（半径：デスクトップ28px／モバイル36px）。

### 3.2 DVDロゴ

- 画面内で常時バウンドする。
- 壁接触時は完全反射。
- 初速：300px/s
  - コイン取得ごとに速度×1.05（上限3.0倍）
  - 経過30秒ごとに速度×1.03（自然加速）

### 3.3 コイン

- 出現間隔：1.2〜2.0秒（ランダム）
- 存在時間：3.5秒
- 取得時：
  - スコア +1
  - DVD速度上昇
  - コイン消滅・パーティクル演出
  - 短いサウンド再生

### 3.4 ゲームオーバー条件

- プレイヤー円がDVDロゴと接触。
- 2人プレイ時はいずれかが接触した時点で終了。

---

## 4. スコアシステム

| 要素             | 内容                                        |
| ---------------- | ------------------------------------------- |
| **スコア**       | コイン取得1枚あたり +1                      |
| **ベストスコア** | LocalStorage に保存                         |
| **難易度上昇**   | コイン取得・経過時間によりロゴ速度増加      |
| **最終結果画面** | 今回スコア / ベストスコア / Retryボタン表示 |

---

## 5. プレイヤー人数モード

- **1人プレイ**：単独でロゴを避け、スコアを競う。
- **2人プレイ**：
  - 同一カメラ内に2人検出時に自動切替。
  - 両者の当たり判定が有効。
  - どちらかが被弾でゲームオーバー。
  - 「Players: 2」表示をHUDに追加。

---

## 6. ビジュアル・演出仕様

| 種別               | 内容                                                 |
| ------------------ | ---------------------------------------------------- |
| **背景**           | 単色 or グラデーション（白～青）                     |
| **ロゴ**           | DVD文字入りスプライト画像、角で反射時に輝く          |
| **コイン**         | 金色円形スプライト（パーティクル生成時にバースト）   |
| **ヒット演出**     | フラッシュ（白→透明）、画面シェイク、SlowMotion300ms |
| **取得演出**       | 小型スパーク・コイン消滅・効果音                     |
| **カウントダウン** | 3→2→1→GO! の文字アニメーション                       |
| **BGM/SFX**        | スタート音、反射音、取得音、被弾音（Web Audio）      |

---

## 7. UI / UX 構成

| 画面                   | UI構成                                                                    |
| ---------------------- | ------------------------------------------------------------------------- |
| **タイトル**           | ロゴ、Startボタン、カメラ許可説明                                         |
| **キャリブレーション** | カメラプレビュー、ミラー切替、明るさガイド                                |
| **プレイ中**           | スコア（左上）／ベストスコア（中央上）／FPS（右下）／プレイヤー数（右上） |
| **ゲームオーバー**     | スコア結果、Retryボタン、操作ヒント                                       |
| **設定項目**           | 鏡像切替／音量／短縮カウントダウン／軽量描画モード                        |

---

## 8. 開発構成・責務分割

| モジュール           | 主な責務                             |
| -------------------- | ------------------------------------ |
| **GameManager**      | 状態遷移管理（Splash→Play→GameOver） |
| **PlayerTracker**    | MediaPipeによる位置取得と平滑化      |
| **EntitySystem**     | ロゴ・コイン・プレイヤーの位置更新   |
| **PhysicsEngine**    | 壁反射、衝突判定                     |
| **UIController**     | スコアHUD、メニュー、リトライ        |
| **EffectController** | フラッシュ・シェイク・スロー演出     |
| **AudioController**  | SFX再生・音量管理                    |
| **StorageManager**   | ベストスコアの永続化                 |

---

## 9. 難易度設計（数値チューニング）

| 要素       | 初期値     | 変動要因              | 上限値  |
| ---------- | ---------- | --------------------- | ------- |
| ロゴ速度   | 300px/s    | コイン取得 / 時間経過 | 900px/s |
| コイン出現 | 1.2〜2.0秒 | 固定                  | —       |
| コイン寿命 | 3.5秒      | 固定                  | —       |
| SlowMotion | 0.2倍速    | 被弾時                | 300ms   |
| 難易度加速 | +3%/30秒   | 時間経過              | —       |

---
